(function(){const a=document.createElement("link").relList;if(a&&a.supports&&a.supports("modulepreload"))return;for(const d of document.querySelectorAll('link[rel="modulepreload"]'))u(d);new MutationObserver(d=>{for(const f of d)if(f.type==="childList")for(const h of f.addedNodes)h.tagName==="LINK"&&h.rel==="modulepreload"&&u(h)}).observe(document,{childList:!0,subtree:!0});function l(d){const f={};return d.integrity&&(f.integrity=d.integrity),d.referrerPolicy&&(f.referrerPolicy=d.referrerPolicy),d.crossOrigin==="use-credentials"?f.credentials="include":d.crossOrigin==="anonymous"?f.credentials="omit":f.credentials="same-origin",f}function u(d){if(d.ep)return;d.ep=!0;const f=l(d);fetch(d.href,f)}})();function qu(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}var oi={exports:{}},Kr={},li={exports:{}},be={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var uu;function Uf(){if(uu)return be;uu=1;var r=Symbol.for("react.element"),a=Symbol.for("react.portal"),l=Symbol.for("react.fragment"),u=Symbol.for("react.strict_mode"),d=Symbol.for("react.profiler"),f=Symbol.for("react.provider"),h=Symbol.for("react.context"),x=Symbol.for("react.forward_ref"),m=Symbol.for("react.suspense"),v=Symbol.for("react.memo"),g=Symbol.for("react.lazy"),w=Symbol.iterator;function k(P){return P===null||typeof P!="object"?null:(P=w&&P[w]||P["@@iterator"],typeof P=="function"?P:null)}var M={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},y=Object.assign,j={};function N(P,q,xe){this.props=P,this.context=q,this.refs=j,this.updater=xe||M}N.prototype.isReactComponent={},N.prototype.setState=function(P,q){if(typeof P!="object"&&typeof P!="function"&&P!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,P,q,"setState")},N.prototype.forceUpdate=function(P){this.updater.enqueueForceUpdate(this,P,"forceUpdate")};function _(){}_.prototype=N.prototype;function R(P,q,xe){this.props=P,this.context=q,this.refs=j,this.updater=xe||M}var X=R.prototype=new _;X.constructor=R,y(X,N.prototype),X.isPureReactComponent=!0;var J=Array.isArray,V=Object.prototype.hasOwnProperty,E={current:null},A={key:!0,ref:!0,__self:!0,__source:!0};function z(P,q,xe){var ge,ke={},ue=null,Se=null;if(q!=null)for(ge in q.ref!==void 0&&(Se=q.ref),q.key!==void 0&&(ue=""+q.key),q)V.call(q,ge)&&!A.hasOwnProperty(ge)&&(ke[ge]=q[ge]);var Me=arguments.length-2;if(Me===1)ke.children=xe;else if(1<Me){for(var Pe=Array(Me),ae=0;ae<Me;ae++)Pe[ae]=arguments[ae+2];ke.children=Pe}if(P&&P.defaultProps)for(ge in Me=P.defaultProps,Me)ke[ge]===void 0&&(ke[ge]=Me[ge]);return{$$typeof:r,type:P,key:ue,ref:Se,props:ke,_owner:E.current}}function $(P,q){return{$$typeof:r,type:P.type,key:q,ref:P.ref,props:P.props,_owner:P._owner}}function pe(P){return typeof P=="object"&&P!==null&&P.$$typeof===r}function Ce(P){var q={"=":"=0",":":"=2"};return"$"+P.replace(/[=:]/g,function(xe){return q[xe]})}var he=/\/+/g;function te(P,q){return typeof P=="object"&&P!==null&&P.key!=null?Ce(""+P.key):q.toString(36)}function ce(P,q,xe,ge,ke){var ue=typeof P;(ue==="undefined"||ue==="boolean")&&(P=null);var Se=!1;if(P===null)Se=!0;else switch(ue){case"string":case"number":Se=!0;break;case"object":switch(P.$$typeof){case r:case a:Se=!0}}if(Se)return Se=P,ke=ke(Se),P=ge===""?"."+te(Se,0):ge,J(ke)?(xe="",P!=null&&(xe=P.replace(he,"$&/")+"/"),ce(ke,q,xe,"",function(ae){return ae})):ke!=null&&(pe(ke)&&(ke=$(ke,xe+(!ke.key||Se&&Se.key===ke.key?"":(""+ke.key).replace(he,"$&/")+"/")+P)),q.push(ke)),1;if(Se=0,ge=ge===""?".":ge+":",J(P))for(var Me=0;Me<P.length;Me++){ue=P[Me];var Pe=ge+te(ue,Me);Se+=ce(ue,q,xe,Pe,ke)}else if(Pe=k(P),typeof Pe=="function")for(P=Pe.call(P),Me=0;!(ue=P.next()).done;)ue=ue.value,Pe=ge+te(ue,Me++),Se+=ce(ue,q,xe,Pe,ke);else if(ue==="object")throw q=String(P),Error("Objects are not valid as a React child (found: "+(q==="[object Object]"?"object with keys {"+Object.keys(P).join(", ")+"}":q)+"). If you meant to render a collection of children, use an array instead.");return Se}function Z(P,q,xe){if(P==null)return P;var ge=[],ke=0;return ce(P,ge,"","",function(ue){return q.call(xe,ue,ke++)}),ge}function B(P){if(P._status===-1){var q=P._result;q=q(),q.then(function(xe){(P._status===0||P._status===-1)&&(P._status=1,P._result=xe)},function(xe){(P._status===0||P._status===-1)&&(P._status=2,P._result=xe)}),P._status===-1&&(P._status=0,P._result=q)}if(P._status===1)return P._result.default;throw P._result}var D={current:null},F={transition:null},U={ReactCurrentDispatcher:D,ReactCurrentBatchConfig:F,ReactCurrentOwner:E};function G(){throw Error("act(...) is not supported in production builds of React.")}return be.Children={map:Z,forEach:function(P,q,xe){Z(P,function(){q.apply(this,arguments)},xe)},count:function(P){var q=0;return Z(P,function(){q++}),q},toArray:function(P){return Z(P,function(q){return q})||[]},only:function(P){if(!pe(P))throw Error("React.Children.only expected to receive a single React element child.");return P}},be.Component=N,be.Fragment=l,be.Profiler=d,be.PureComponent=R,be.StrictMode=u,be.Suspense=m,be.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=U,be.act=G,be.cloneElement=function(P,q,xe){if(P==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+P+".");var ge=y({},P.props),ke=P.key,ue=P.ref,Se=P._owner;if(q!=null){if(q.ref!==void 0&&(ue=q.ref,Se=E.current),q.key!==void 0&&(ke=""+q.key),P.type&&P.type.defaultProps)var Me=P.type.defaultProps;for(Pe in q)V.call(q,Pe)&&!A.hasOwnProperty(Pe)&&(ge[Pe]=q[Pe]===void 0&&Me!==void 0?Me[Pe]:q[Pe])}var Pe=arguments.length-2;if(Pe===1)ge.children=xe;else if(1<Pe){Me=Array(Pe);for(var ae=0;ae<Pe;ae++)Me[ae]=arguments[ae+2];ge.children=Me}return{$$typeof:r,type:P.type,key:ke,ref:ue,props:ge,_owner:Se}},be.createContext=function(P){return P={$$typeof:h,_currentValue:P,_currentValue2:P,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},P.Provider={$$typeof:f,_context:P},P.Consumer=P},be.createElement=z,be.createFactory=function(P){var q=z.bind(null,P);return q.type=P,q},be.createRef=function(){return{current:null}},be.forwardRef=function(P){return{$$typeof:x,render:P}},be.isValidElement=pe,be.lazy=function(P){return{$$typeof:g,_payload:{_status:-1,_result:P},_init:B}},be.memo=function(P,q){return{$$typeof:v,type:P,compare:q===void 0?null:q}},be.startTransition=function(P){var q=F.transition;F.transition={};try{P()}finally{F.transition=q}},be.unstable_act=G,be.useCallback=function(P,q){return D.current.useCallback(P,q)},be.useContext=function(P){return D.current.useContext(P)},be.useDebugValue=function(){},be.useDeferredValue=function(P){return D.current.useDeferredValue(P)},be.useEffect=function(P,q){return D.current.useEffect(P,q)},be.useId=function(){return D.current.useId()},be.useImperativeHandle=function(P,q,xe){return D.current.useImperativeHandle(P,q,xe)},be.useInsertionEffect=function(P,q){return D.current.useInsertionEffect(P,q)},be.useLayoutEffect=function(P,q){return D.current.useLayoutEffect(P,q)},be.useMemo=function(P,q){return D.current.useMemo(P,q)},be.useReducer=function(P,q,xe){return D.current.useReducer(P,q,xe)},be.useRef=function(P){return D.current.useRef(P)},be.useState=function(P){return D.current.useState(P)},be.useSyncExternalStore=function(P,q,xe){return D.current.useSyncExternalStore(P,q,xe)},be.useTransition=function(){return D.current.useTransition()},be.version="18.3.1",be}var du;function es(){return du||(du=1,li.exports=Uf()),li.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var fu;function Hf(){if(fu)return Kr;fu=1;var r=es(),a=Symbol.for("react.element"),l=Symbol.for("react.fragment"),u=Object.prototype.hasOwnProperty,d=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,f={key:!0,ref:!0,__self:!0,__source:!0};function h(x,m,v){var g,w={},k=null,M=null;v!==void 0&&(k=""+v),m.key!==void 0&&(k=""+m.key),m.ref!==void 0&&(M=m.ref);for(g in m)u.call(m,g)&&!f.hasOwnProperty(g)&&(w[g]=m[g]);if(x&&x.defaultProps)for(g in m=x.defaultProps,m)w[g]===void 0&&(w[g]=m[g]);return{$$typeof:a,type:x,key:k,ref:M,props:w,_owner:d.current}}return Kr.Fragment=l,Kr.jsx=h,Kr.jsxs=h,Kr}var pu;function Vf(){return pu||(pu=1,oi.exports=Hf()),oi.exports}var i=Vf(),ao={},ii={exports:{}},St={},ai={exports:{}},ci={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hu;function Wf(){return hu||(hu=1,(function(r){function a(F,U){var G=F.length;F.push(U);e:for(;0<G;){var P=G-1>>>1,q=F[P];if(0<d(q,U))F[P]=U,F[G]=q,G=P;else break e}}function l(F){return F.length===0?null:F[0]}function u(F){if(F.length===0)return null;var U=F[0],G=F.pop();if(G!==U){F[0]=G;e:for(var P=0,q=F.length,xe=q>>>1;P<xe;){var ge=2*(P+1)-1,ke=F[ge],ue=ge+1,Se=F[ue];if(0>d(ke,G))ue<q&&0>d(Se,ke)?(F[P]=Se,F[ue]=G,P=ue):(F[P]=ke,F[ge]=G,P=ge);else if(ue<q&&0>d(Se,G))F[P]=Se,F[ue]=G,P=ue;else break e}}return U}function d(F,U){var G=F.sortIndex-U.sortIndex;return G!==0?G:F.id-U.id}if(typeof performance=="object"&&typeof performance.now=="function"){var f=performance;r.unstable_now=function(){return f.now()}}else{var h=Date,x=h.now();r.unstable_now=function(){return h.now()-x}}var m=[],v=[],g=1,w=null,k=3,M=!1,y=!1,j=!1,N=typeof setTimeout=="function"?setTimeout:null,_=typeof clearTimeout=="function"?clearTimeout:null,R=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function X(F){for(var U=l(v);U!==null;){if(U.callback===null)u(v);else if(U.startTime<=F)u(v),U.sortIndex=U.expirationTime,a(m,U);else break;U=l(v)}}function J(F){if(j=!1,X(F),!y)if(l(m)!==null)y=!0,B(V);else{var U=l(v);U!==null&&D(J,U.startTime-F)}}function V(F,U){y=!1,j&&(j=!1,_(z),z=-1),M=!0;var G=k;try{for(X(U),w=l(m);w!==null&&(!(w.expirationTime>U)||F&&!Ce());){var P=w.callback;if(typeof P=="function"){w.callback=null,k=w.priorityLevel;var q=P(w.expirationTime<=U);U=r.unstable_now(),typeof q=="function"?w.callback=q:w===l(m)&&u(m),X(U)}else u(m);w=l(m)}if(w!==null)var xe=!0;else{var ge=l(v);ge!==null&&D(J,ge.startTime-U),xe=!1}return xe}finally{w=null,k=G,M=!1}}var E=!1,A=null,z=-1,$=5,pe=-1;function Ce(){return!(r.unstable_now()-pe<$)}function he(){if(A!==null){var F=r.unstable_now();pe=F;var U=!0;try{U=A(!0,F)}finally{U?te():(E=!1,A=null)}}else E=!1}var te;if(typeof R=="function")te=function(){R(he)};else if(typeof MessageChannel<"u"){var ce=new MessageChannel,Z=ce.port2;ce.port1.onmessage=he,te=function(){Z.postMessage(null)}}else te=function(){N(he,0)};function B(F){A=F,E||(E=!0,te())}function D(F,U){z=N(function(){F(r.unstable_now())},U)}r.unstable_IdlePriority=5,r.unstable_ImmediatePriority=1,r.unstable_LowPriority=4,r.unstable_NormalPriority=3,r.unstable_Profiling=null,r.unstable_UserBlockingPriority=2,r.unstable_cancelCallback=function(F){F.callback=null},r.unstable_continueExecution=function(){y||M||(y=!0,B(V))},r.unstable_forceFrameRate=function(F){0>F||125<F?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):$=0<F?Math.floor(1e3/F):5},r.unstable_getCurrentPriorityLevel=function(){return k},r.unstable_getFirstCallbackNode=function(){return l(m)},r.unstable_next=function(F){switch(k){case 1:case 2:case 3:var U=3;break;default:U=k}var G=k;k=U;try{return F()}finally{k=G}},r.unstable_pauseExecution=function(){},r.unstable_requestPaint=function(){},r.unstable_runWithPriority=function(F,U){switch(F){case 1:case 2:case 3:case 4:case 5:break;default:F=3}var G=k;k=F;try{return U()}finally{k=G}},r.unstable_scheduleCallback=function(F,U,G){var P=r.unstable_now();switch(typeof G=="object"&&G!==null?(G=G.delay,G=typeof G=="number"&&0<G?P+G:P):G=P,F){case 1:var q=-1;break;case 2:q=250;break;case 5:q=1073741823;break;case 4:q=1e4;break;default:q=5e3}return q=G+q,F={id:g++,callback:U,priorityLevel:F,startTime:G,expirationTime:q,sortIndex:-1},G>P?(F.sortIndex=G,a(v,F),l(m)===null&&F===l(v)&&(j?(_(z),z=-1):j=!0,D(J,G-P))):(F.sortIndex=q,a(m,F),y||M||(y=!0,B(V))),F},r.unstable_shouldYield=Ce,r.unstable_wrapCallback=function(F){var U=k;return function(){var G=k;k=U;try{return F.apply(this,arguments)}finally{k=G}}}})(ci)),ci}var mu;function $f(){return mu||(mu=1,ai.exports=Wf()),ai.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var vu;function Gf(){if(vu)return St;vu=1;var r=es(),a=$f();function l(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var u=new Set,d={};function f(e,t){h(e,t),h(e+"Capture",t)}function h(e,t){for(d[e]=t,e=0;e<t.length;e++)u.add(t[e])}var x=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),m=Object.prototype.hasOwnProperty,v=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,g={},w={};function k(e){return m.call(w,e)?!0:m.call(g,e)?!1:v.test(e)?w[e]=!0:(g[e]=!0,!1)}function M(e,t,n,s){if(n!==null&&n.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return s?!1:n!==null?!n.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function y(e,t,n,s){if(t===null||typeof t>"u"||M(e,t,n,s))return!0;if(s)return!1;if(n!==null)switch(n.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function j(e,t,n,s,o,c,p){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=s,this.attributeNamespace=o,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=c,this.removeEmptyString=p}var N={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){N[e]=new j(e,0,!1,e,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];N[t]=new j(t,1,!1,e[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(e){N[e]=new j(e,2,!1,e.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){N[e]=new j(e,2,!1,e,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){N[e]=new j(e,3,!1,e.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(e){N[e]=new j(e,3,!0,e,null,!1,!1)}),["capture","download"].forEach(function(e){N[e]=new j(e,4,!1,e,null,!1,!1)}),["cols","rows","size","span"].forEach(function(e){N[e]=new j(e,6,!1,e,null,!1,!1)}),["rowSpan","start"].forEach(function(e){N[e]=new j(e,5,!1,e.toLowerCase(),null,!1,!1)});var _=/[\-:]([a-z])/g;function R(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(_,R);N[t]=new j(t,1,!1,e,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(_,R);N[t]=new j(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(_,R);N[t]=new j(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(e){N[e]=new j(e,1,!1,e.toLowerCase(),null,!1,!1)}),N.xlinkHref=new j("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(e){N[e]=new j(e,1,!1,e.toLowerCase(),null,!0,!0)});function X(e,t,n,s){var o=N.hasOwnProperty(t)?N[t]:null;(o!==null?o.type!==0:s||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(y(t,n,o,s)&&(n=null),s||o===null?k(t)&&(n===null?e.removeAttribute(t):e.setAttribute(t,""+n)):o.mustUseProperty?e[o.propertyName]=n===null?o.type===3?!1:"":n:(t=o.attributeName,s=o.attributeNamespace,n===null?e.removeAttribute(t):(o=o.type,n=o===3||o===4&&n===!0?"":""+n,s?e.setAttributeNS(s,t,n):e.setAttribute(t,n))))}var J=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,V=Symbol.for("react.element"),E=Symbol.for("react.portal"),A=Symbol.for("react.fragment"),z=Symbol.for("react.strict_mode"),$=Symbol.for("react.profiler"),pe=Symbol.for("react.provider"),Ce=Symbol.for("react.context"),he=Symbol.for("react.forward_ref"),te=Symbol.for("react.suspense"),ce=Symbol.for("react.suspense_list"),Z=Symbol.for("react.memo"),B=Symbol.for("react.lazy"),D=Symbol.for("react.offscreen"),F=Symbol.iterator;function U(e){return e===null||typeof e!="object"?null:(e=F&&e[F]||e["@@iterator"],typeof e=="function"?e:null)}var G=Object.assign,P;function q(e){if(P===void 0)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);P=t&&t[1]||""}return`
`+P+e}var xe=!1;function ge(e,t){if(!e||xe)return"";xe=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(O){var s=O}Reflect.construct(e,[],t)}else{try{t.call()}catch(O){s=O}e.call(t.prototype)}else{try{throw Error()}catch(O){s=O}e()}}catch(O){if(O&&s&&typeof O.stack=="string"){for(var o=O.stack.split(`
`),c=s.stack.split(`
`),p=o.length-1,S=c.length-1;1<=p&&0<=S&&o[p]!==c[S];)S--;for(;1<=p&&0<=S;p--,S--)if(o[p]!==c[S]){if(p!==1||S!==1)do if(p--,S--,0>S||o[p]!==c[S]){var b=`
`+o[p].replace(" at new "," at ");return e.displayName&&b.includes("<anonymous>")&&(b=b.replace("<anonymous>",e.displayName)),b}while(1<=p&&0<=S);break}}}finally{xe=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?q(e):""}function ke(e){switch(e.tag){case 5:return q(e.type);case 16:return q("Lazy");case 13:return q("Suspense");case 19:return q("SuspenseList");case 0:case 2:case 15:return e=ge(e.type,!1),e;case 11:return e=ge(e.type.render,!1),e;case 1:return e=ge(e.type,!0),e;default:return""}}function ue(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case A:return"Fragment";case E:return"Portal";case $:return"Profiler";case z:return"StrictMode";case te:return"Suspense";case ce:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case Ce:return(e.displayName||"Context")+".Consumer";case pe:return(e._context.displayName||"Context")+".Provider";case he:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case Z:return t=e.displayName||null,t!==null?t:ue(e.type)||"Memo";case B:t=e._payload,e=e._init;try{return ue(e(t))}catch{}}return null}function Se(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return ue(t);case 8:return t===z?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function Me(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function Pe(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function ae(e){var t=Pe(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),s=""+e[t];if(!e.hasOwnProperty(t)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var o=n.get,c=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return o.call(this)},set:function(p){s=""+p,c.call(this,p)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return s},setValue:function(p){s=""+p},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function Be(e){e._valueTracker||(e._valueTracker=ae(e))}function We(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),s="";return e&&(s=Pe(e)?e.checked?"true":"false":e.value),e=s,e!==n?(t.setValue(e),!0):!1}function Xe(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function dt(e,t){var n=t.checked;return G({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??e._wrapperState.initialChecked})}function At(e,t){var n=t.defaultValue==null?"":t.defaultValue,s=t.checked!=null?t.checked:t.defaultChecked;n=Me(t.value!=null?t.value:n),e._wrapperState={initialChecked:s,initialValue:n,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function K(e,t){t=t.checked,t!=null&&X(e,"checked",t,!1)}function me(e,t){K(e,t);var n=Me(t.value),s=t.type;if(n!=null)s==="number"?(n===0&&e.value===""||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if(s==="submit"||s==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?ye(e,t.type,n):t.hasOwnProperty("defaultValue")&&ye(e,t.type,Me(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function je(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var s=t.type;if(!(s!=="submit"&&s!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}n=e.name,n!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,n!==""&&(e.name=n)}function ye(e,t,n){(t!=="number"||Xe(e.ownerDocument)!==e)&&(n==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var Ne=Array.isArray;function _e(e,t,n,s){if(e=e.options,t){t={};for(var o=0;o<n.length;o++)t["$"+n[o]]=!0;for(n=0;n<e.length;n++)o=t.hasOwnProperty("$"+e[n].value),e[n].selected!==o&&(e[n].selected=o),o&&s&&(e[n].defaultSelected=!0)}else{for(n=""+Me(n),t=null,o=0;o<e.length;o++){if(e[o].value===n){e[o].selected=!0,s&&(e[o].defaultSelected=!0);return}t!==null||e[o].disabled||(t=e[o])}t!==null&&(t.selected=!0)}}function mt(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(l(91));return G({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function Yt(e,t){var n=t.value;if(n==null){if(n=t.children,t=t.defaultValue,n!=null){if(t!=null)throw Error(l(92));if(Ne(n)){if(1<n.length)throw Error(l(93));n=n[0]}t=n}t==null&&(t=""),n=t}e._wrapperState={initialValue:Me(n)}}function Ee(e,t){var n=Me(t.value),s=Me(t.defaultValue);n!=null&&(n=""+n,n!==e.value&&(e.value=n),t.defaultValue==null&&e.defaultValue!==n&&(e.defaultValue=n)),s!=null&&(e.defaultValue=""+s)}function Ft(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function Ct(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Ie(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?Ct(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var rt,En=(function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,n,s,o){MSApp.execUnsafeLocalFunction(function(){return e(t,n,s,o)})}:e})(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(rt=rt||document.createElement("div"),rt.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=rt.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function dr(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&n.nodeType===3){n.nodeValue=t;return}}e.textContent=t}var fr={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Wu=["Webkit","ms","Moz","O"];Object.keys(fr).forEach(function(e){Wu.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),fr[t]=fr[e]})});function bi(e,t,n){return t==null||typeof t=="boolean"||t===""?"":n||typeof t!="number"||t===0||fr.hasOwnProperty(e)&&fr[e]?(""+t).trim():t+"px"}function Ei(e,t){e=e.style;for(var n in t)if(t.hasOwnProperty(n)){var s=n.indexOf("--")===0,o=bi(n,t[n],s);n==="float"&&(n="cssFloat"),s?e.setProperty(n,o):e[n]=o}}var $u=G({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function go(e,t){if(t){if($u[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(l(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(l(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(l(61))}if(t.style!=null&&typeof t.style!="object")throw Error(l(62))}}function yo(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var xo=null;function wo(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var So=null,qn=null,Bn=null;function Ci(e){if(e=Rr(e)){if(typeof So!="function")throw Error(l(280));var t=e.stateNode;t&&(t=js(t),So(e.stateNode,e.type,t))}}function Ni(e){qn?Bn?Bn.push(e):Bn=[e]:qn=e}function Pi(){if(qn){var e=qn,t=Bn;if(Bn=qn=null,Ci(e),t)for(e=0;e<t.length;e++)Ci(t[e])}}function Ti(e,t){return e(t)}function _i(){}var ko=!1;function Li(e,t,n){if(ko)return e(t,n);ko=!0;try{return Ti(e,t,n)}finally{ko=!1,(qn!==null||Bn!==null)&&(_i(),Pi())}}function pr(e,t){var n=e.stateNode;if(n===null)return null;var s=js(n);if(s===null)return null;n=s[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(s=!s.disabled)||(e=e.type,s=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!s;break e;default:e=!1}if(e)return null;if(n&&typeof n!="function")throw Error(l(231,t,typeof n));return n}var jo=!1;if(x)try{var hr={};Object.defineProperty(hr,"passive",{get:function(){jo=!0}}),window.addEventListener("test",hr,hr),window.removeEventListener("test",hr,hr)}catch{jo=!1}function Gu(e,t,n,s,o,c,p,S,b){var O=Array.prototype.slice.call(arguments,3);try{t.apply(n,O)}catch(W){this.onError(W)}}var mr=!1,ts=null,ns=!1,Mo=null,Qu={onError:function(e){mr=!0,ts=e}};function Ku(e,t,n,s,o,c,p,S,b){mr=!1,ts=null,Gu.apply(Qu,arguments)}function Xu(e,t,n,s,o,c,p,S,b){if(Ku.apply(this,arguments),mr){if(mr){var O=ts;mr=!1,ts=null}else throw Error(l(198));ns||(ns=!0,Mo=O)}}function Cn(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,(t.flags&4098)!==0&&(n=t.return),e=t.return;while(e)}return t.tag===3?n:null}function Oi(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function Ri(e){if(Cn(e)!==e)throw Error(l(188))}function Yu(e){var t=e.alternate;if(!t){if(t=Cn(e),t===null)throw Error(l(188));return t!==e?null:e}for(var n=e,s=t;;){var o=n.return;if(o===null)break;var c=o.alternate;if(c===null){if(s=o.return,s!==null){n=s;continue}break}if(o.child===c.child){for(c=o.child;c;){if(c===n)return Ri(o),e;if(c===s)return Ri(o),t;c=c.sibling}throw Error(l(188))}if(n.return!==s.return)n=o,s=c;else{for(var p=!1,S=o.child;S;){if(S===n){p=!0,n=o,s=c;break}if(S===s){p=!0,s=o,n=c;break}S=S.sibling}if(!p){for(S=c.child;S;){if(S===n){p=!0,n=c,s=o;break}if(S===s){p=!0,s=c,n=o;break}S=S.sibling}if(!p)throw Error(l(189))}}if(n.alternate!==s)throw Error(l(190))}if(n.tag!==3)throw Error(l(188));return n.stateNode.current===n?e:t}function Ii(e){return e=Yu(e),e!==null?Ai(e):null}function Ai(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=Ai(e);if(t!==null)return t;e=e.sibling}return null}var Fi=a.unstable_scheduleCallback,zi=a.unstable_cancelCallback,Ju=a.unstable_shouldYield,Zu=a.unstable_requestPaint,$e=a.unstable_now,ed=a.unstable_getCurrentPriorityLevel,bo=a.unstable_ImmediatePriority,Di=a.unstable_UserBlockingPriority,rs=a.unstable_NormalPriority,td=a.unstable_LowPriority,qi=a.unstable_IdlePriority,ss=null,$t=null;function nd(e){if($t&&typeof $t.onCommitFiberRoot=="function")try{$t.onCommitFiberRoot(ss,e,void 0,(e.current.flags&128)===128)}catch{}}var zt=Math.clz32?Math.clz32:od,rd=Math.log,sd=Math.LN2;function od(e){return e>>>=0,e===0?32:31-(rd(e)/sd|0)|0}var os=64,ls=4194304;function vr(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function is(e,t){var n=e.pendingLanes;if(n===0)return 0;var s=0,o=e.suspendedLanes,c=e.pingedLanes,p=n&268435455;if(p!==0){var S=p&~o;S!==0?s=vr(S):(c&=p,c!==0&&(s=vr(c)))}else p=n&~o,p!==0?s=vr(p):c!==0&&(s=vr(c));if(s===0)return 0;if(t!==0&&t!==s&&(t&o)===0&&(o=s&-s,c=t&-t,o>=c||o===16&&(c&4194240)!==0))return t;if((s&4)!==0&&(s|=n&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=s;0<t;)n=31-zt(t),o=1<<n,s|=e[n],t&=~o;return s}function ld(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function id(e,t){for(var n=e.suspendedLanes,s=e.pingedLanes,o=e.expirationTimes,c=e.pendingLanes;0<c;){var p=31-zt(c),S=1<<p,b=o[p];b===-1?((S&n)===0||(S&s)!==0)&&(o[p]=ld(S,t)):b<=t&&(e.expiredLanes|=S),c&=~S}}function Eo(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function Bi(){var e=os;return os<<=1,(os&4194240)===0&&(os=64),e}function Co(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function gr(e,t,n){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-zt(t),e[t]=n}function ad(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var s=e.eventTimes;for(e=e.expirationTimes;0<n;){var o=31-zt(n),c=1<<o;t[o]=0,s[o]=-1,e[o]=-1,n&=~c}}function No(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var s=31-zt(n),o=1<<s;o&t|e[s]&t&&(e[s]|=t),n&=~o}}var Re=0;function Ui(e){return e&=-e,1<e?4<e?(e&268435455)!==0?16:536870912:4:1}var Hi,Po,Vi,Wi,$i,To=!1,as=[],ln=null,an=null,cn=null,yr=new Map,xr=new Map,un=[],cd="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Gi(e,t){switch(e){case"focusin":case"focusout":ln=null;break;case"dragenter":case"dragleave":an=null;break;case"mouseover":case"mouseout":cn=null;break;case"pointerover":case"pointerout":yr.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":xr.delete(t.pointerId)}}function wr(e,t,n,s,o,c){return e===null||e.nativeEvent!==c?(e={blockedOn:t,domEventName:n,eventSystemFlags:s,nativeEvent:c,targetContainers:[o]},t!==null&&(t=Rr(t),t!==null&&Po(t)),e):(e.eventSystemFlags|=s,t=e.targetContainers,o!==null&&t.indexOf(o)===-1&&t.push(o),e)}function ud(e,t,n,s,o){switch(t){case"focusin":return ln=wr(ln,e,t,n,s,o),!0;case"dragenter":return an=wr(an,e,t,n,s,o),!0;case"mouseover":return cn=wr(cn,e,t,n,s,o),!0;case"pointerover":var c=o.pointerId;return yr.set(c,wr(yr.get(c)||null,e,t,n,s,o)),!0;case"gotpointercapture":return c=o.pointerId,xr.set(c,wr(xr.get(c)||null,e,t,n,s,o)),!0}return!1}function Qi(e){var t=Nn(e.target);if(t!==null){var n=Cn(t);if(n!==null){if(t=n.tag,t===13){if(t=Oi(n),t!==null){e.blockedOn=t,$i(e.priority,function(){Vi(n)});return}}else if(t===3&&n.stateNode.current.memoizedState.isDehydrated){e.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}e.blockedOn=null}function cs(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var n=Lo(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(n===null){n=e.nativeEvent;var s=new n.constructor(n.type,n);xo=s,n.target.dispatchEvent(s),xo=null}else return t=Rr(n),t!==null&&Po(t),e.blockedOn=n,!1;t.shift()}return!0}function Ki(e,t,n){cs(e)&&n.delete(t)}function dd(){To=!1,ln!==null&&cs(ln)&&(ln=null),an!==null&&cs(an)&&(an=null),cn!==null&&cs(cn)&&(cn=null),yr.forEach(Ki),xr.forEach(Ki)}function Sr(e,t){e.blockedOn===t&&(e.blockedOn=null,To||(To=!0,a.unstable_scheduleCallback(a.unstable_NormalPriority,dd)))}function kr(e){function t(o){return Sr(o,e)}if(0<as.length){Sr(as[0],e);for(var n=1;n<as.length;n++){var s=as[n];s.blockedOn===e&&(s.blockedOn=null)}}for(ln!==null&&Sr(ln,e),an!==null&&Sr(an,e),cn!==null&&Sr(cn,e),yr.forEach(t),xr.forEach(t),n=0;n<un.length;n++)s=un[n],s.blockedOn===e&&(s.blockedOn=null);for(;0<un.length&&(n=un[0],n.blockedOn===null);)Qi(n),n.blockedOn===null&&un.shift()}var Un=J.ReactCurrentBatchConfig,us=!0;function fd(e,t,n,s){var o=Re,c=Un.transition;Un.transition=null;try{Re=1,_o(e,t,n,s)}finally{Re=o,Un.transition=c}}function pd(e,t,n,s){var o=Re,c=Un.transition;Un.transition=null;try{Re=4,_o(e,t,n,s)}finally{Re=o,Un.transition=c}}function _o(e,t,n,s){if(us){var o=Lo(e,t,n,s);if(o===null)Ko(e,t,s,ds,n),Gi(e,s);else if(ud(o,e,t,n,s))s.stopPropagation();else if(Gi(e,s),t&4&&-1<cd.indexOf(e)){for(;o!==null;){var c=Rr(o);if(c!==null&&Hi(c),c=Lo(e,t,n,s),c===null&&Ko(e,t,s,ds,n),c===o)break;o=c}o!==null&&s.stopPropagation()}else Ko(e,t,s,null,n)}}var ds=null;function Lo(e,t,n,s){if(ds=null,e=wo(s),e=Nn(e),e!==null)if(t=Cn(e),t===null)e=null;else if(n=t.tag,n===13){if(e=Oi(t),e!==null)return e;e=null}else if(n===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return ds=e,null}function Xi(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(ed()){case bo:return 1;case Di:return 4;case rs:case td:return 16;case qi:return 536870912;default:return 16}default:return 16}}var dn=null,Oo=null,fs=null;function Yi(){if(fs)return fs;var e,t=Oo,n=t.length,s,o="value"in dn?dn.value:dn.textContent,c=o.length;for(e=0;e<n&&t[e]===o[e];e++);var p=n-e;for(s=1;s<=p&&t[n-s]===o[c-s];s++);return fs=o.slice(e,1<s?1-s:void 0)}function ps(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function hs(){return!0}function Ji(){return!1}function jt(e){function t(n,s,o,c,p){this._reactName=n,this._targetInst=o,this.type=s,this.nativeEvent=c,this.target=p,this.currentTarget=null;for(var S in e)e.hasOwnProperty(S)&&(n=e[S],this[S]=n?n(c):c[S]);return this.isDefaultPrevented=(c.defaultPrevented!=null?c.defaultPrevented:c.returnValue===!1)?hs:Ji,this.isPropagationStopped=Ji,this}return G(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=hs)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=hs)},persist:function(){},isPersistent:hs}),t}var Hn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Ro=jt(Hn),jr=G({},Hn,{view:0,detail:0}),hd=jt(jr),Io,Ao,Mr,ms=G({},jr,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:zo,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Mr&&(Mr&&e.type==="mousemove"?(Io=e.screenX-Mr.screenX,Ao=e.screenY-Mr.screenY):Ao=Io=0,Mr=e),Io)},movementY:function(e){return"movementY"in e?e.movementY:Ao}}),Zi=jt(ms),md=G({},ms,{dataTransfer:0}),vd=jt(md),gd=G({},jr,{relatedTarget:0}),Fo=jt(gd),yd=G({},Hn,{animationName:0,elapsedTime:0,pseudoElement:0}),xd=jt(yd),wd=G({},Hn,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),Sd=jt(wd),kd=G({},Hn,{data:0}),ea=jt(kd),jd={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Md={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},bd={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Ed(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=bd[e])?!!t[e]:!1}function zo(){return Ed}var Cd=G({},jr,{key:function(e){if(e.key){var t=jd[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=ps(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?Md[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:zo,charCode:function(e){return e.type==="keypress"?ps(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?ps(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),Nd=jt(Cd),Pd=G({},ms,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),ta=jt(Pd),Td=G({},jr,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:zo}),_d=jt(Td),Ld=G({},Hn,{propertyName:0,elapsedTime:0,pseudoElement:0}),Od=jt(Ld),Rd=G({},ms,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Id=jt(Rd),Ad=[9,13,27,32],Do=x&&"CompositionEvent"in window,br=null;x&&"documentMode"in document&&(br=document.documentMode);var Fd=x&&"TextEvent"in window&&!br,na=x&&(!Do||br&&8<br&&11>=br),ra=" ",sa=!1;function oa(e,t){switch(e){case"keyup":return Ad.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function la(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Vn=!1;function zd(e,t){switch(e){case"compositionend":return la(t);case"keypress":return t.which!==32?null:(sa=!0,ra);case"textInput":return e=t.data,e===ra&&sa?null:e;default:return null}}function Dd(e,t){if(Vn)return e==="compositionend"||!Do&&oa(e,t)?(e=Yi(),fs=Oo=dn=null,Vn=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return na&&t.locale!=="ko"?null:t.data;default:return null}}var qd={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function ia(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!qd[e.type]:t==="textarea"}function aa(e,t,n,s){Ni(s),t=ws(t,"onChange"),0<t.length&&(n=new Ro("onChange","change",null,n,s),e.push({event:n,listeners:t}))}var Er=null,Cr=null;function Bd(e){Ea(e,0)}function vs(e){var t=Kn(e);if(We(t))return e}function Ud(e,t){if(e==="change")return t}var ca=!1;if(x){var qo;if(x){var Bo="oninput"in document;if(!Bo){var ua=document.createElement("div");ua.setAttribute("oninput","return;"),Bo=typeof ua.oninput=="function"}qo=Bo}else qo=!1;ca=qo&&(!document.documentMode||9<document.documentMode)}function da(){Er&&(Er.detachEvent("onpropertychange",fa),Cr=Er=null)}function fa(e){if(e.propertyName==="value"&&vs(Cr)){var t=[];aa(t,Cr,e,wo(e)),Li(Bd,t)}}function Hd(e,t,n){e==="focusin"?(da(),Er=t,Cr=n,Er.attachEvent("onpropertychange",fa)):e==="focusout"&&da()}function Vd(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return vs(Cr)}function Wd(e,t){if(e==="click")return vs(t)}function $d(e,t){if(e==="input"||e==="change")return vs(t)}function Gd(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Dt=typeof Object.is=="function"?Object.is:Gd;function Nr(e,t){if(Dt(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var n=Object.keys(e),s=Object.keys(t);if(n.length!==s.length)return!1;for(s=0;s<n.length;s++){var o=n[s];if(!m.call(t,o)||!Dt(e[o],t[o]))return!1}return!0}function pa(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function ha(e,t){var n=pa(e);e=0;for(var s;n;){if(n.nodeType===3){if(s=e+n.textContent.length,e<=t&&s>=t)return{node:n,offset:t-e};e=s}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=pa(n)}}function ma(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?ma(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function va(){for(var e=window,t=Xe();t instanceof e.HTMLIFrameElement;){try{var n=typeof t.contentWindow.location.href=="string"}catch{n=!1}if(n)e=t.contentWindow;else break;t=Xe(e.document)}return t}function Uo(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function Qd(e){var t=va(),n=e.focusedElem,s=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&ma(n.ownerDocument.documentElement,n)){if(s!==null&&Uo(n)){if(t=s.start,e=s.end,e===void 0&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if(e=(t=n.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var o=n.textContent.length,c=Math.min(s.start,o);s=s.end===void 0?c:Math.min(s.end,o),!e.extend&&c>s&&(o=s,s=c,c=o),o=ha(n,c);var p=ha(n,s);o&&p&&(e.rangeCount!==1||e.anchorNode!==o.node||e.anchorOffset!==o.offset||e.focusNode!==p.node||e.focusOffset!==p.offset)&&(t=t.createRange(),t.setStart(o.node,o.offset),e.removeAllRanges(),c>s?(e.addRange(t),e.extend(p.node,p.offset)):(t.setEnd(p.node,p.offset),e.addRange(t)))}}for(t=[],e=n;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<t.length;n++)e=t[n],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var Kd=x&&"documentMode"in document&&11>=document.documentMode,Wn=null,Ho=null,Pr=null,Vo=!1;function ga(e,t,n){var s=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;Vo||Wn==null||Wn!==Xe(s)||(s=Wn,"selectionStart"in s&&Uo(s)?s={start:s.selectionStart,end:s.selectionEnd}:(s=(s.ownerDocument&&s.ownerDocument.defaultView||window).getSelection(),s={anchorNode:s.anchorNode,anchorOffset:s.anchorOffset,focusNode:s.focusNode,focusOffset:s.focusOffset}),Pr&&Nr(Pr,s)||(Pr=s,s=ws(Ho,"onSelect"),0<s.length&&(t=new Ro("onSelect","select",null,t,n),e.push({event:t,listeners:s}),t.target=Wn)))}function gs(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var $n={animationend:gs("Animation","AnimationEnd"),animationiteration:gs("Animation","AnimationIteration"),animationstart:gs("Animation","AnimationStart"),transitionend:gs("Transition","TransitionEnd")},Wo={},ya={};x&&(ya=document.createElement("div").style,"AnimationEvent"in window||(delete $n.animationend.animation,delete $n.animationiteration.animation,delete $n.animationstart.animation),"TransitionEvent"in window||delete $n.transitionend.transition);function ys(e){if(Wo[e])return Wo[e];if(!$n[e])return e;var t=$n[e],n;for(n in t)if(t.hasOwnProperty(n)&&n in ya)return Wo[e]=t[n];return e}var xa=ys("animationend"),wa=ys("animationiteration"),Sa=ys("animationstart"),ka=ys("transitionend"),ja=new Map,Ma="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function fn(e,t){ja.set(e,t),f(t,[e])}for(var $o=0;$o<Ma.length;$o++){var Go=Ma[$o],Xd=Go.toLowerCase(),Yd=Go[0].toUpperCase()+Go.slice(1);fn(Xd,"on"+Yd)}fn(xa,"onAnimationEnd"),fn(wa,"onAnimationIteration"),fn(Sa,"onAnimationStart"),fn("dblclick","onDoubleClick"),fn("focusin","onFocus"),fn("focusout","onBlur"),fn(ka,"onTransitionEnd"),h("onMouseEnter",["mouseout","mouseover"]),h("onMouseLeave",["mouseout","mouseover"]),h("onPointerEnter",["pointerout","pointerover"]),h("onPointerLeave",["pointerout","pointerover"]),f("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),f("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),f("onBeforeInput",["compositionend","keypress","textInput","paste"]),f("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),f("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),f("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Tr="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Jd=new Set("cancel close invalid load scroll toggle".split(" ").concat(Tr));function ba(e,t,n){var s=e.type||"unknown-event";e.currentTarget=n,Xu(s,t,void 0,e),e.currentTarget=null}function Ea(e,t){t=(t&4)!==0;for(var n=0;n<e.length;n++){var s=e[n],o=s.event;s=s.listeners;e:{var c=void 0;if(t)for(var p=s.length-1;0<=p;p--){var S=s[p],b=S.instance,O=S.currentTarget;if(S=S.listener,b!==c&&o.isPropagationStopped())break e;ba(o,S,O),c=b}else for(p=0;p<s.length;p++){if(S=s[p],b=S.instance,O=S.currentTarget,S=S.listener,b!==c&&o.isPropagationStopped())break e;ba(o,S,O),c=b}}}if(ns)throw e=Mo,ns=!1,Mo=null,e}function Fe(e,t){var n=t[tl];n===void 0&&(n=t[tl]=new Set);var s=e+"__bubble";n.has(s)||(Ca(t,e,2,!1),n.add(s))}function Qo(e,t,n){var s=0;t&&(s|=4),Ca(n,e,s,t)}var xs="_reactListening"+Math.random().toString(36).slice(2);function _r(e){if(!e[xs]){e[xs]=!0,u.forEach(function(n){n!=="selectionchange"&&(Jd.has(n)||Qo(n,!1,e),Qo(n,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[xs]||(t[xs]=!0,Qo("selectionchange",!1,t))}}function Ca(e,t,n,s){switch(Xi(t)){case 1:var o=fd;break;case 4:o=pd;break;default:o=_o}n=o.bind(null,t,n,e),o=void 0,!jo||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(o=!0),s?o!==void 0?e.addEventListener(t,n,{capture:!0,passive:o}):e.addEventListener(t,n,!0):o!==void 0?e.addEventListener(t,n,{passive:o}):e.addEventListener(t,n,!1)}function Ko(e,t,n,s,o){var c=s;if((t&1)===0&&(t&2)===0&&s!==null)e:for(;;){if(s===null)return;var p=s.tag;if(p===3||p===4){var S=s.stateNode.containerInfo;if(S===o||S.nodeType===8&&S.parentNode===o)break;if(p===4)for(p=s.return;p!==null;){var b=p.tag;if((b===3||b===4)&&(b=p.stateNode.containerInfo,b===o||b.nodeType===8&&b.parentNode===o))return;p=p.return}for(;S!==null;){if(p=Nn(S),p===null)return;if(b=p.tag,b===5||b===6){s=c=p;continue e}S=S.parentNode}}s=s.return}Li(function(){var O=c,W=wo(n),Y=[];e:{var H=ja.get(e);if(H!==void 0){var re=Ro,oe=e;switch(e){case"keypress":if(ps(n)===0)break e;case"keydown":case"keyup":re=Nd;break;case"focusin":oe="focus",re=Fo;break;case"focusout":oe="blur",re=Fo;break;case"beforeblur":case"afterblur":re=Fo;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":re=Zi;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":re=vd;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":re=_d;break;case xa:case wa:case Sa:re=xd;break;case ka:re=Od;break;case"scroll":re=hd;break;case"wheel":re=Id;break;case"copy":case"cut":case"paste":re=Sd;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":re=ta}var le=(t&4)!==0,Ge=!le&&e==="scroll",T=le?H!==null?H+"Capture":null:H;le=[];for(var C=O,L;C!==null;){L=C;var ee=L.stateNode;if(L.tag===5&&ee!==null&&(L=ee,T!==null&&(ee=pr(C,T),ee!=null&&le.push(Lr(C,ee,L)))),Ge)break;C=C.return}0<le.length&&(H=new re(H,oe,null,n,W),Y.push({event:H,listeners:le}))}}if((t&7)===0){e:{if(H=e==="mouseover"||e==="pointerover",re=e==="mouseout"||e==="pointerout",H&&n!==xo&&(oe=n.relatedTarget||n.fromElement)&&(Nn(oe)||oe[Jt]))break e;if((re||H)&&(H=W.window===W?W:(H=W.ownerDocument)?H.defaultView||H.parentWindow:window,re?(oe=n.relatedTarget||n.toElement,re=O,oe=oe?Nn(oe):null,oe!==null&&(Ge=Cn(oe),oe!==Ge||oe.tag!==5&&oe.tag!==6)&&(oe=null)):(re=null,oe=O),re!==oe)){if(le=Zi,ee="onMouseLeave",T="onMouseEnter",C="mouse",(e==="pointerout"||e==="pointerover")&&(le=ta,ee="onPointerLeave",T="onPointerEnter",C="pointer"),Ge=re==null?H:Kn(re),L=oe==null?H:Kn(oe),H=new le(ee,C+"leave",re,n,W),H.target=Ge,H.relatedTarget=L,ee=null,Nn(W)===O&&(le=new le(T,C+"enter",oe,n,W),le.target=L,le.relatedTarget=Ge,ee=le),Ge=ee,re&&oe)t:{for(le=re,T=oe,C=0,L=le;L;L=Gn(L))C++;for(L=0,ee=T;ee;ee=Gn(ee))L++;for(;0<C-L;)le=Gn(le),C--;for(;0<L-C;)T=Gn(T),L--;for(;C--;){if(le===T||T!==null&&le===T.alternate)break t;le=Gn(le),T=Gn(T)}le=null}else le=null;re!==null&&Na(Y,H,re,le,!1),oe!==null&&Ge!==null&&Na(Y,Ge,oe,le,!0)}}e:{if(H=O?Kn(O):window,re=H.nodeName&&H.nodeName.toLowerCase(),re==="select"||re==="input"&&H.type==="file")var ie=Ud;else if(ia(H))if(ca)ie=$d;else{ie=Vd;var de=Hd}else(re=H.nodeName)&&re.toLowerCase()==="input"&&(H.type==="checkbox"||H.type==="radio")&&(ie=Wd);if(ie&&(ie=ie(e,O))){aa(Y,ie,n,W);break e}de&&de(e,H,O),e==="focusout"&&(de=H._wrapperState)&&de.controlled&&H.type==="number"&&ye(H,"number",H.value)}switch(de=O?Kn(O):window,e){case"focusin":(ia(de)||de.contentEditable==="true")&&(Wn=de,Ho=O,Pr=null);break;case"focusout":Pr=Ho=Wn=null;break;case"mousedown":Vo=!0;break;case"contextmenu":case"mouseup":case"dragend":Vo=!1,ga(Y,n,W);break;case"selectionchange":if(Kd)break;case"keydown":case"keyup":ga(Y,n,W)}var fe;if(Do)e:{switch(e){case"compositionstart":var ve="onCompositionStart";break e;case"compositionend":ve="onCompositionEnd";break e;case"compositionupdate":ve="onCompositionUpdate";break e}ve=void 0}else Vn?oa(e,n)&&(ve="onCompositionEnd"):e==="keydown"&&n.keyCode===229&&(ve="onCompositionStart");ve&&(na&&n.locale!=="ko"&&(Vn||ve!=="onCompositionStart"?ve==="onCompositionEnd"&&Vn&&(fe=Yi()):(dn=W,Oo="value"in dn?dn.value:dn.textContent,Vn=!0)),de=ws(O,ve),0<de.length&&(ve=new ea(ve,e,null,n,W),Y.push({event:ve,listeners:de}),fe?ve.data=fe:(fe=la(n),fe!==null&&(ve.data=fe)))),(fe=Fd?zd(e,n):Dd(e,n))&&(O=ws(O,"onBeforeInput"),0<O.length&&(W=new ea("onBeforeInput","beforeinput",null,n,W),Y.push({event:W,listeners:O}),W.data=fe))}Ea(Y,t)})}function Lr(e,t,n){return{instance:e,listener:t,currentTarget:n}}function ws(e,t){for(var n=t+"Capture",s=[];e!==null;){var o=e,c=o.stateNode;o.tag===5&&c!==null&&(o=c,c=pr(e,n),c!=null&&s.unshift(Lr(e,c,o)),c=pr(e,t),c!=null&&s.push(Lr(e,c,o))),e=e.return}return s}function Gn(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function Na(e,t,n,s,o){for(var c=t._reactName,p=[];n!==null&&n!==s;){var S=n,b=S.alternate,O=S.stateNode;if(b!==null&&b===s)break;S.tag===5&&O!==null&&(S=O,o?(b=pr(n,c),b!=null&&p.unshift(Lr(n,b,S))):o||(b=pr(n,c),b!=null&&p.push(Lr(n,b,S)))),n=n.return}p.length!==0&&e.push({event:t,listeners:p})}var Zd=/\r\n?/g,ef=/\u0000|\uFFFD/g;function Pa(e){return(typeof e=="string"?e:""+e).replace(Zd,`
`).replace(ef,"")}function Ss(e,t,n){if(t=Pa(t),Pa(e)!==t&&n)throw Error(l(425))}function ks(){}var Xo=null,Yo=null;function Jo(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var Zo=typeof setTimeout=="function"?setTimeout:void 0,tf=typeof clearTimeout=="function"?clearTimeout:void 0,Ta=typeof Promise=="function"?Promise:void 0,nf=typeof queueMicrotask=="function"?queueMicrotask:typeof Ta<"u"?function(e){return Ta.resolve(null).then(e).catch(rf)}:Zo;function rf(e){setTimeout(function(){throw e})}function el(e,t){var n=t,s=0;do{var o=n.nextSibling;if(e.removeChild(n),o&&o.nodeType===8)if(n=o.data,n==="/$"){if(s===0){e.removeChild(o),kr(t);return}s--}else n!=="$"&&n!=="$?"&&n!=="$!"||s++;n=o}while(n);kr(t)}function pn(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function _a(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="$"||n==="$!"||n==="$?"){if(t===0)return e;t--}else n==="/$"&&t++}e=e.previousSibling}return null}var Qn=Math.random().toString(36).slice(2),Gt="__reactFiber$"+Qn,Or="__reactProps$"+Qn,Jt="__reactContainer$"+Qn,tl="__reactEvents$"+Qn,sf="__reactListeners$"+Qn,of="__reactHandles$"+Qn;function Nn(e){var t=e[Gt];if(t)return t;for(var n=e.parentNode;n;){if(t=n[Jt]||n[Gt]){if(n=t.alternate,t.child!==null||n!==null&&n.child!==null)for(e=_a(e);e!==null;){if(n=e[Gt])return n;e=_a(e)}return t}e=n,n=e.parentNode}return null}function Rr(e){return e=e[Gt]||e[Jt],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function Kn(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(l(33))}function js(e){return e[Or]||null}var nl=[],Xn=-1;function hn(e){return{current:e}}function ze(e){0>Xn||(e.current=nl[Xn],nl[Xn]=null,Xn--)}function Ae(e,t){Xn++,nl[Xn]=e.current,e.current=t}var mn={},it=hn(mn),vt=hn(!1),Pn=mn;function Yn(e,t){var n=e.type.contextTypes;if(!n)return mn;var s=e.stateNode;if(s&&s.__reactInternalMemoizedUnmaskedChildContext===t)return s.__reactInternalMemoizedMaskedChildContext;var o={},c;for(c in n)o[c]=t[c];return s&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=o),o}function gt(e){return e=e.childContextTypes,e!=null}function Ms(){ze(vt),ze(it)}function La(e,t,n){if(it.current!==mn)throw Error(l(168));Ae(it,t),Ae(vt,n)}function Oa(e,t,n){var s=e.stateNode;if(t=t.childContextTypes,typeof s.getChildContext!="function")return n;s=s.getChildContext();for(var o in s)if(!(o in t))throw Error(l(108,Se(e)||"Unknown",o));return G({},n,s)}function bs(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||mn,Pn=it.current,Ae(it,e),Ae(vt,vt.current),!0}function Ra(e,t,n){var s=e.stateNode;if(!s)throw Error(l(169));n?(e=Oa(e,t,Pn),s.__reactInternalMemoizedMergedChildContext=e,ze(vt),ze(it),Ae(it,e)):ze(vt),Ae(vt,n)}var Zt=null,Es=!1,rl=!1;function Ia(e){Zt===null?Zt=[e]:Zt.push(e)}function lf(e){Es=!0,Ia(e)}function vn(){if(!rl&&Zt!==null){rl=!0;var e=0,t=Re;try{var n=Zt;for(Re=1;e<n.length;e++){var s=n[e];do s=s(!0);while(s!==null)}Zt=null,Es=!1}catch(o){throw Zt!==null&&(Zt=Zt.slice(e+1)),Fi(bo,vn),o}finally{Re=t,rl=!1}}return null}var Jn=[],Zn=0,Cs=null,Ns=0,Nt=[],Pt=0,Tn=null,en=1,tn="";function _n(e,t){Jn[Zn++]=Ns,Jn[Zn++]=Cs,Cs=e,Ns=t}function Aa(e,t,n){Nt[Pt++]=en,Nt[Pt++]=tn,Nt[Pt++]=Tn,Tn=e;var s=en;e=tn;var o=32-zt(s)-1;s&=~(1<<o),n+=1;var c=32-zt(t)+o;if(30<c){var p=o-o%5;c=(s&(1<<p)-1).toString(32),s>>=p,o-=p,en=1<<32-zt(t)+o|n<<o|s,tn=c+e}else en=1<<c|n<<o|s,tn=e}function sl(e){e.return!==null&&(_n(e,1),Aa(e,1,0))}function ol(e){for(;e===Cs;)Cs=Jn[--Zn],Jn[Zn]=null,Ns=Jn[--Zn],Jn[Zn]=null;for(;e===Tn;)Tn=Nt[--Pt],Nt[Pt]=null,tn=Nt[--Pt],Nt[Pt]=null,en=Nt[--Pt],Nt[Pt]=null}var Mt=null,bt=null,De=!1,qt=null;function Fa(e,t){var n=Ot(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,t=e.deletions,t===null?(e.deletions=[n],e.flags|=16):t.push(n)}function za(e,t){switch(e.tag){case 5:var n=e.type;return t=t.nodeType!==1||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,Mt=e,bt=pn(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,Mt=e,bt=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(n=Tn!==null?{id:en,overflow:tn}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},n=Ot(18,null,null,0),n.stateNode=t,n.return=e,e.child=n,Mt=e,bt=null,!0):!1;default:return!1}}function ll(e){return(e.mode&1)!==0&&(e.flags&128)===0}function il(e){if(De){var t=bt;if(t){var n=t;if(!za(e,t)){if(ll(e))throw Error(l(418));t=pn(n.nextSibling);var s=Mt;t&&za(e,t)?Fa(s,n):(e.flags=e.flags&-4097|2,De=!1,Mt=e)}}else{if(ll(e))throw Error(l(418));e.flags=e.flags&-4097|2,De=!1,Mt=e}}}function Da(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;Mt=e}function Ps(e){if(e!==Mt)return!1;if(!De)return Da(e),De=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!Jo(e.type,e.memoizedProps)),t&&(t=bt)){if(ll(e))throw qa(),Error(l(418));for(;t;)Fa(e,t),t=pn(t.nextSibling)}if(Da(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(l(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="/$"){if(t===0){bt=pn(e.nextSibling);break e}t--}else n!=="$"&&n!=="$!"&&n!=="$?"||t++}e=e.nextSibling}bt=null}}else bt=Mt?pn(e.stateNode.nextSibling):null;return!0}function qa(){for(var e=bt;e;)e=pn(e.nextSibling)}function er(){bt=Mt=null,De=!1}function al(e){qt===null?qt=[e]:qt.push(e)}var af=J.ReactCurrentBatchConfig;function Ir(e,t,n){if(e=n.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(l(309));var s=n.stateNode}if(!s)throw Error(l(147,e));var o=s,c=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===c?t.ref:(t=function(p){var S=o.refs;p===null?delete S[c]:S[c]=p},t._stringRef=c,t)}if(typeof e!="string")throw Error(l(284));if(!n._owner)throw Error(l(290,e))}return e}function Ts(e,t){throw e=Object.prototype.toString.call(t),Error(l(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function Ba(e){var t=e._init;return t(e._payload)}function Ua(e){function t(T,C){if(e){var L=T.deletions;L===null?(T.deletions=[C],T.flags|=16):L.push(C)}}function n(T,C){if(!e)return null;for(;C!==null;)t(T,C),C=C.sibling;return null}function s(T,C){for(T=new Map;C!==null;)C.key!==null?T.set(C.key,C):T.set(C.index,C),C=C.sibling;return T}function o(T,C){return T=Mn(T,C),T.index=0,T.sibling=null,T}function c(T,C,L){return T.index=L,e?(L=T.alternate,L!==null?(L=L.index,L<C?(T.flags|=2,C):L):(T.flags|=2,C)):(T.flags|=1048576,C)}function p(T){return e&&T.alternate===null&&(T.flags|=2),T}function S(T,C,L,ee){return C===null||C.tag!==6?(C=Zl(L,T.mode,ee),C.return=T,C):(C=o(C,L),C.return=T,C)}function b(T,C,L,ee){var ie=L.type;return ie===A?W(T,C,L.props.children,ee,L.key):C!==null&&(C.elementType===ie||typeof ie=="object"&&ie!==null&&ie.$$typeof===B&&Ba(ie)===C.type)?(ee=o(C,L.props),ee.ref=Ir(T,C,L),ee.return=T,ee):(ee=eo(L.type,L.key,L.props,null,T.mode,ee),ee.ref=Ir(T,C,L),ee.return=T,ee)}function O(T,C,L,ee){return C===null||C.tag!==4||C.stateNode.containerInfo!==L.containerInfo||C.stateNode.implementation!==L.implementation?(C=ei(L,T.mode,ee),C.return=T,C):(C=o(C,L.children||[]),C.return=T,C)}function W(T,C,L,ee,ie){return C===null||C.tag!==7?(C=Dn(L,T.mode,ee,ie),C.return=T,C):(C=o(C,L),C.return=T,C)}function Y(T,C,L){if(typeof C=="string"&&C!==""||typeof C=="number")return C=Zl(""+C,T.mode,L),C.return=T,C;if(typeof C=="object"&&C!==null){switch(C.$$typeof){case V:return L=eo(C.type,C.key,C.props,null,T.mode,L),L.ref=Ir(T,null,C),L.return=T,L;case E:return C=ei(C,T.mode,L),C.return=T,C;case B:var ee=C._init;return Y(T,ee(C._payload),L)}if(Ne(C)||U(C))return C=Dn(C,T.mode,L,null),C.return=T,C;Ts(T,C)}return null}function H(T,C,L,ee){var ie=C!==null?C.key:null;if(typeof L=="string"&&L!==""||typeof L=="number")return ie!==null?null:S(T,C,""+L,ee);if(typeof L=="object"&&L!==null){switch(L.$$typeof){case V:return L.key===ie?b(T,C,L,ee):null;case E:return L.key===ie?O(T,C,L,ee):null;case B:return ie=L._init,H(T,C,ie(L._payload),ee)}if(Ne(L)||U(L))return ie!==null?null:W(T,C,L,ee,null);Ts(T,L)}return null}function re(T,C,L,ee,ie){if(typeof ee=="string"&&ee!==""||typeof ee=="number")return T=T.get(L)||null,S(C,T,""+ee,ie);if(typeof ee=="object"&&ee!==null){switch(ee.$$typeof){case V:return T=T.get(ee.key===null?L:ee.key)||null,b(C,T,ee,ie);case E:return T=T.get(ee.key===null?L:ee.key)||null,O(C,T,ee,ie);case B:var de=ee._init;return re(T,C,L,de(ee._payload),ie)}if(Ne(ee)||U(ee))return T=T.get(L)||null,W(C,T,ee,ie,null);Ts(C,ee)}return null}function oe(T,C,L,ee){for(var ie=null,de=null,fe=C,ve=C=0,nt=null;fe!==null&&ve<L.length;ve++){fe.index>ve?(nt=fe,fe=null):nt=fe.sibling;var Oe=H(T,fe,L[ve],ee);if(Oe===null){fe===null&&(fe=nt);break}e&&fe&&Oe.alternate===null&&t(T,fe),C=c(Oe,C,ve),de===null?ie=Oe:de.sibling=Oe,de=Oe,fe=nt}if(ve===L.length)return n(T,fe),De&&_n(T,ve),ie;if(fe===null){for(;ve<L.length;ve++)fe=Y(T,L[ve],ee),fe!==null&&(C=c(fe,C,ve),de===null?ie=fe:de.sibling=fe,de=fe);return De&&_n(T,ve),ie}for(fe=s(T,fe);ve<L.length;ve++)nt=re(fe,T,ve,L[ve],ee),nt!==null&&(e&&nt.alternate!==null&&fe.delete(nt.key===null?ve:nt.key),C=c(nt,C,ve),de===null?ie=nt:de.sibling=nt,de=nt);return e&&fe.forEach(function(bn){return t(T,bn)}),De&&_n(T,ve),ie}function le(T,C,L,ee){var ie=U(L);if(typeof ie!="function")throw Error(l(150));if(L=ie.call(L),L==null)throw Error(l(151));for(var de=ie=null,fe=C,ve=C=0,nt=null,Oe=L.next();fe!==null&&!Oe.done;ve++,Oe=L.next()){fe.index>ve?(nt=fe,fe=null):nt=fe.sibling;var bn=H(T,fe,Oe.value,ee);if(bn===null){fe===null&&(fe=nt);break}e&&fe&&bn.alternate===null&&t(T,fe),C=c(bn,C,ve),de===null?ie=bn:de.sibling=bn,de=bn,fe=nt}if(Oe.done)return n(T,fe),De&&_n(T,ve),ie;if(fe===null){for(;!Oe.done;ve++,Oe=L.next())Oe=Y(T,Oe.value,ee),Oe!==null&&(C=c(Oe,C,ve),de===null?ie=Oe:de.sibling=Oe,de=Oe);return De&&_n(T,ve),ie}for(fe=s(T,fe);!Oe.done;ve++,Oe=L.next())Oe=re(fe,T,ve,Oe.value,ee),Oe!==null&&(e&&Oe.alternate!==null&&fe.delete(Oe.key===null?ve:Oe.key),C=c(Oe,C,ve),de===null?ie=Oe:de.sibling=Oe,de=Oe);return e&&fe.forEach(function(Bf){return t(T,Bf)}),De&&_n(T,ve),ie}function Ge(T,C,L,ee){if(typeof L=="object"&&L!==null&&L.type===A&&L.key===null&&(L=L.props.children),typeof L=="object"&&L!==null){switch(L.$$typeof){case V:e:{for(var ie=L.key,de=C;de!==null;){if(de.key===ie){if(ie=L.type,ie===A){if(de.tag===7){n(T,de.sibling),C=o(de,L.props.children),C.return=T,T=C;break e}}else if(de.elementType===ie||typeof ie=="object"&&ie!==null&&ie.$$typeof===B&&Ba(ie)===de.type){n(T,de.sibling),C=o(de,L.props),C.ref=Ir(T,de,L),C.return=T,T=C;break e}n(T,de);break}else t(T,de);de=de.sibling}L.type===A?(C=Dn(L.props.children,T.mode,ee,L.key),C.return=T,T=C):(ee=eo(L.type,L.key,L.props,null,T.mode,ee),ee.ref=Ir(T,C,L),ee.return=T,T=ee)}return p(T);case E:e:{for(de=L.key;C!==null;){if(C.key===de)if(C.tag===4&&C.stateNode.containerInfo===L.containerInfo&&C.stateNode.implementation===L.implementation){n(T,C.sibling),C=o(C,L.children||[]),C.return=T,T=C;break e}else{n(T,C);break}else t(T,C);C=C.sibling}C=ei(L,T.mode,ee),C.return=T,T=C}return p(T);case B:return de=L._init,Ge(T,C,de(L._payload),ee)}if(Ne(L))return oe(T,C,L,ee);if(U(L))return le(T,C,L,ee);Ts(T,L)}return typeof L=="string"&&L!==""||typeof L=="number"?(L=""+L,C!==null&&C.tag===6?(n(T,C.sibling),C=o(C,L),C.return=T,T=C):(n(T,C),C=Zl(L,T.mode,ee),C.return=T,T=C),p(T)):n(T,C)}return Ge}var tr=Ua(!0),Ha=Ua(!1),_s=hn(null),Ls=null,nr=null,cl=null;function ul(){cl=nr=Ls=null}function dl(e){var t=_s.current;ze(_s),e._currentValue=t}function fl(e,t,n){for(;e!==null;){var s=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,s!==null&&(s.childLanes|=t)):s!==null&&(s.childLanes&t)!==t&&(s.childLanes|=t),e===n)break;e=e.return}}function rr(e,t){Ls=e,cl=nr=null,e=e.dependencies,e!==null&&e.firstContext!==null&&((e.lanes&t)!==0&&(yt=!0),e.firstContext=null)}function Tt(e){var t=e._currentValue;if(cl!==e)if(e={context:e,memoizedValue:t,next:null},nr===null){if(Ls===null)throw Error(l(308));nr=e,Ls.dependencies={lanes:0,firstContext:e}}else nr=nr.next=e;return t}var Ln=null;function pl(e){Ln===null?Ln=[e]:Ln.push(e)}function Va(e,t,n,s){var o=t.interleaved;return o===null?(n.next=n,pl(t)):(n.next=o.next,o.next=n),t.interleaved=n,nn(e,s)}function nn(e,t){e.lanes|=t;var n=e.alternate;for(n!==null&&(n.lanes|=t),n=e,e=e.return;e!==null;)e.childLanes|=t,n=e.alternate,n!==null&&(n.childLanes|=t),n=e,e=e.return;return n.tag===3?n.stateNode:null}var gn=!1;function hl(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Wa(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function rn(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function yn(e,t,n){var s=e.updateQueue;if(s===null)return null;if(s=s.shared,(Le&2)!==0){var o=s.pending;return o===null?t.next=t:(t.next=o.next,o.next=t),s.pending=t,nn(e,n)}return o=s.interleaved,o===null?(t.next=t,pl(s)):(t.next=o.next,o.next=t),s.interleaved=t,nn(e,n)}function Os(e,t,n){if(t=t.updateQueue,t!==null&&(t=t.shared,(n&4194240)!==0)){var s=t.lanes;s&=e.pendingLanes,n|=s,t.lanes=n,No(e,n)}}function $a(e,t){var n=e.updateQueue,s=e.alternate;if(s!==null&&(s=s.updateQueue,n===s)){var o=null,c=null;if(n=n.firstBaseUpdate,n!==null){do{var p={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};c===null?o=c=p:c=c.next=p,n=n.next}while(n!==null);c===null?o=c=t:c=c.next=t}else o=c=t;n={baseState:s.baseState,firstBaseUpdate:o,lastBaseUpdate:c,shared:s.shared,effects:s.effects},e.updateQueue=n;return}e=n.lastBaseUpdate,e===null?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function Rs(e,t,n,s){var o=e.updateQueue;gn=!1;var c=o.firstBaseUpdate,p=o.lastBaseUpdate,S=o.shared.pending;if(S!==null){o.shared.pending=null;var b=S,O=b.next;b.next=null,p===null?c=O:p.next=O,p=b;var W=e.alternate;W!==null&&(W=W.updateQueue,S=W.lastBaseUpdate,S!==p&&(S===null?W.firstBaseUpdate=O:S.next=O,W.lastBaseUpdate=b))}if(c!==null){var Y=o.baseState;p=0,W=O=b=null,S=c;do{var H=S.lane,re=S.eventTime;if((s&H)===H){W!==null&&(W=W.next={eventTime:re,lane:0,tag:S.tag,payload:S.payload,callback:S.callback,next:null});e:{var oe=e,le=S;switch(H=t,re=n,le.tag){case 1:if(oe=le.payload,typeof oe=="function"){Y=oe.call(re,Y,H);break e}Y=oe;break e;case 3:oe.flags=oe.flags&-65537|128;case 0:if(oe=le.payload,H=typeof oe=="function"?oe.call(re,Y,H):oe,H==null)break e;Y=G({},Y,H);break e;case 2:gn=!0}}S.callback!==null&&S.lane!==0&&(e.flags|=64,H=o.effects,H===null?o.effects=[S]:H.push(S))}else re={eventTime:re,lane:H,tag:S.tag,payload:S.payload,callback:S.callback,next:null},W===null?(O=W=re,b=Y):W=W.next=re,p|=H;if(S=S.next,S===null){if(S=o.shared.pending,S===null)break;H=S,S=H.next,H.next=null,o.lastBaseUpdate=H,o.shared.pending=null}}while(!0);if(W===null&&(b=Y),o.baseState=b,o.firstBaseUpdate=O,o.lastBaseUpdate=W,t=o.shared.interleaved,t!==null){o=t;do p|=o.lane,o=o.next;while(o!==t)}else c===null&&(o.shared.lanes=0);In|=p,e.lanes=p,e.memoizedState=Y}}function Ga(e,t,n){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var s=e[t],o=s.callback;if(o!==null){if(s.callback=null,s=n,typeof o!="function")throw Error(l(191,o));o.call(s)}}}var Ar={},Qt=hn(Ar),Fr=hn(Ar),zr=hn(Ar);function On(e){if(e===Ar)throw Error(l(174));return e}function ml(e,t){switch(Ae(zr,t),Ae(Fr,e),Ae(Qt,Ar),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:Ie(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=Ie(t,e)}ze(Qt),Ae(Qt,t)}function sr(){ze(Qt),ze(Fr),ze(zr)}function Qa(e){On(zr.current);var t=On(Qt.current),n=Ie(t,e.type);t!==n&&(Ae(Fr,e),Ae(Qt,n))}function vl(e){Fr.current===e&&(ze(Qt),ze(Fr))}var Ue=hn(0);function Is(e){for(var t=e;t!==null;){if(t.tag===13){var n=t.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if((t.flags&128)!==0)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var gl=[];function yl(){for(var e=0;e<gl.length;e++)gl[e]._workInProgressVersionPrimary=null;gl.length=0}var As=J.ReactCurrentDispatcher,xl=J.ReactCurrentBatchConfig,Rn=0,He=null,Ye=null,et=null,Fs=!1,Dr=!1,qr=0,cf=0;function at(){throw Error(l(321))}function wl(e,t){if(t===null)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!Dt(e[n],t[n]))return!1;return!0}function Sl(e,t,n,s,o,c){if(Rn=c,He=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,As.current=e===null||e.memoizedState===null?pf:hf,e=n(s,o),Dr){c=0;do{if(Dr=!1,qr=0,25<=c)throw Error(l(301));c+=1,et=Ye=null,t.updateQueue=null,As.current=mf,e=n(s,o)}while(Dr)}if(As.current=qs,t=Ye!==null&&Ye.next!==null,Rn=0,et=Ye=He=null,Fs=!1,t)throw Error(l(300));return e}function kl(){var e=qr!==0;return qr=0,e}function Kt(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return et===null?He.memoizedState=et=e:et=et.next=e,et}function _t(){if(Ye===null){var e=He.alternate;e=e!==null?e.memoizedState:null}else e=Ye.next;var t=et===null?He.memoizedState:et.next;if(t!==null)et=t,Ye=e;else{if(e===null)throw Error(l(310));Ye=e,e={memoizedState:Ye.memoizedState,baseState:Ye.baseState,baseQueue:Ye.baseQueue,queue:Ye.queue,next:null},et===null?He.memoizedState=et=e:et=et.next=e}return et}function Br(e,t){return typeof t=="function"?t(e):t}function jl(e){var t=_t(),n=t.queue;if(n===null)throw Error(l(311));n.lastRenderedReducer=e;var s=Ye,o=s.baseQueue,c=n.pending;if(c!==null){if(o!==null){var p=o.next;o.next=c.next,c.next=p}s.baseQueue=o=c,n.pending=null}if(o!==null){c=o.next,s=s.baseState;var S=p=null,b=null,O=c;do{var W=O.lane;if((Rn&W)===W)b!==null&&(b=b.next={lane:0,action:O.action,hasEagerState:O.hasEagerState,eagerState:O.eagerState,next:null}),s=O.hasEagerState?O.eagerState:e(s,O.action);else{var Y={lane:W,action:O.action,hasEagerState:O.hasEagerState,eagerState:O.eagerState,next:null};b===null?(S=b=Y,p=s):b=b.next=Y,He.lanes|=W,In|=W}O=O.next}while(O!==null&&O!==c);b===null?p=s:b.next=S,Dt(s,t.memoizedState)||(yt=!0),t.memoizedState=s,t.baseState=p,t.baseQueue=b,n.lastRenderedState=s}if(e=n.interleaved,e!==null){o=e;do c=o.lane,He.lanes|=c,In|=c,o=o.next;while(o!==e)}else o===null&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function Ml(e){var t=_t(),n=t.queue;if(n===null)throw Error(l(311));n.lastRenderedReducer=e;var s=n.dispatch,o=n.pending,c=t.memoizedState;if(o!==null){n.pending=null;var p=o=o.next;do c=e(c,p.action),p=p.next;while(p!==o);Dt(c,t.memoizedState)||(yt=!0),t.memoizedState=c,t.baseQueue===null&&(t.baseState=c),n.lastRenderedState=c}return[c,s]}function Ka(){}function Xa(e,t){var n=He,s=_t(),o=t(),c=!Dt(s.memoizedState,o);if(c&&(s.memoizedState=o,yt=!0),s=s.queue,bl(Za.bind(null,n,s,e),[e]),s.getSnapshot!==t||c||et!==null&&et.memoizedState.tag&1){if(n.flags|=2048,Ur(9,Ja.bind(null,n,s,o,t),void 0,null),tt===null)throw Error(l(349));(Rn&30)!==0||Ya(n,t,o)}return o}function Ya(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},t=He.updateQueue,t===null?(t={lastEffect:null,stores:null},He.updateQueue=t,t.stores=[e]):(n=t.stores,n===null?t.stores=[e]:n.push(e))}function Ja(e,t,n,s){t.value=n,t.getSnapshot=s,ec(t)&&tc(e)}function Za(e,t,n){return n(function(){ec(t)&&tc(e)})}function ec(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!Dt(e,n)}catch{return!0}}function tc(e){var t=nn(e,1);t!==null&&Vt(t,e,1,-1)}function nc(e){var t=Kt();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Br,lastRenderedState:e},t.queue=e,e=e.dispatch=ff.bind(null,He,e),[t.memoizedState,e]}function Ur(e,t,n,s){return e={tag:e,create:t,destroy:n,deps:s,next:null},t=He.updateQueue,t===null?(t={lastEffect:null,stores:null},He.updateQueue=t,t.lastEffect=e.next=e):(n=t.lastEffect,n===null?t.lastEffect=e.next=e:(s=n.next,n.next=e,e.next=s,t.lastEffect=e)),e}function rc(){return _t().memoizedState}function zs(e,t,n,s){var o=Kt();He.flags|=e,o.memoizedState=Ur(1|t,n,void 0,s===void 0?null:s)}function Ds(e,t,n,s){var o=_t();s=s===void 0?null:s;var c=void 0;if(Ye!==null){var p=Ye.memoizedState;if(c=p.destroy,s!==null&&wl(s,p.deps)){o.memoizedState=Ur(t,n,c,s);return}}He.flags|=e,o.memoizedState=Ur(1|t,n,c,s)}function sc(e,t){return zs(8390656,8,e,t)}function bl(e,t){return Ds(2048,8,e,t)}function oc(e,t){return Ds(4,2,e,t)}function lc(e,t){return Ds(4,4,e,t)}function ic(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function ac(e,t,n){return n=n!=null?n.concat([e]):null,Ds(4,4,ic.bind(null,t,e),n)}function El(){}function cc(e,t){var n=_t();t=t===void 0?null:t;var s=n.memoizedState;return s!==null&&t!==null&&wl(t,s[1])?s[0]:(n.memoizedState=[e,t],e)}function uc(e,t){var n=_t();t=t===void 0?null:t;var s=n.memoizedState;return s!==null&&t!==null&&wl(t,s[1])?s[0]:(e=e(),n.memoizedState=[e,t],e)}function dc(e,t,n){return(Rn&21)===0?(e.baseState&&(e.baseState=!1,yt=!0),e.memoizedState=n):(Dt(n,t)||(n=Bi(),He.lanes|=n,In|=n,e.baseState=!0),t)}function uf(e,t){var n=Re;Re=n!==0&&4>n?n:4,e(!0);var s=xl.transition;xl.transition={};try{e(!1),t()}finally{Re=n,xl.transition=s}}function fc(){return _t().memoizedState}function df(e,t,n){var s=kn(e);if(n={lane:s,action:n,hasEagerState:!1,eagerState:null,next:null},pc(e))hc(t,n);else if(n=Va(e,t,n,s),n!==null){var o=pt();Vt(n,e,s,o),mc(n,t,s)}}function ff(e,t,n){var s=kn(e),o={lane:s,action:n,hasEagerState:!1,eagerState:null,next:null};if(pc(e))hc(t,o);else{var c=e.alternate;if(e.lanes===0&&(c===null||c.lanes===0)&&(c=t.lastRenderedReducer,c!==null))try{var p=t.lastRenderedState,S=c(p,n);if(o.hasEagerState=!0,o.eagerState=S,Dt(S,p)){var b=t.interleaved;b===null?(o.next=o,pl(t)):(o.next=b.next,b.next=o),t.interleaved=o;return}}catch{}finally{}n=Va(e,t,o,s),n!==null&&(o=pt(),Vt(n,e,s,o),mc(n,t,s))}}function pc(e){var t=e.alternate;return e===He||t!==null&&t===He}function hc(e,t){Dr=Fs=!0;var n=e.pending;n===null?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function mc(e,t,n){if((n&4194240)!==0){var s=t.lanes;s&=e.pendingLanes,n|=s,t.lanes=n,No(e,n)}}var qs={readContext:Tt,useCallback:at,useContext:at,useEffect:at,useImperativeHandle:at,useInsertionEffect:at,useLayoutEffect:at,useMemo:at,useReducer:at,useRef:at,useState:at,useDebugValue:at,useDeferredValue:at,useTransition:at,useMutableSource:at,useSyncExternalStore:at,useId:at,unstable_isNewReconciler:!1},pf={readContext:Tt,useCallback:function(e,t){return Kt().memoizedState=[e,t===void 0?null:t],e},useContext:Tt,useEffect:sc,useImperativeHandle:function(e,t,n){return n=n!=null?n.concat([e]):null,zs(4194308,4,ic.bind(null,t,e),n)},useLayoutEffect:function(e,t){return zs(4194308,4,e,t)},useInsertionEffect:function(e,t){return zs(4,2,e,t)},useMemo:function(e,t){var n=Kt();return t=t===void 0?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var s=Kt();return t=n!==void 0?n(t):t,s.memoizedState=s.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},s.queue=e,e=e.dispatch=df.bind(null,He,e),[s.memoizedState,e]},useRef:function(e){var t=Kt();return e={current:e},t.memoizedState=e},useState:nc,useDebugValue:El,useDeferredValue:function(e){return Kt().memoizedState=e},useTransition:function(){var e=nc(!1),t=e[0];return e=uf.bind(null,e[1]),Kt().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var s=He,o=Kt();if(De){if(n===void 0)throw Error(l(407));n=n()}else{if(n=t(),tt===null)throw Error(l(349));(Rn&30)!==0||Ya(s,t,n)}o.memoizedState=n;var c={value:n,getSnapshot:t};return o.queue=c,sc(Za.bind(null,s,c,e),[e]),s.flags|=2048,Ur(9,Ja.bind(null,s,c,n,t),void 0,null),n},useId:function(){var e=Kt(),t=tt.identifierPrefix;if(De){var n=tn,s=en;n=(s&~(1<<32-zt(s)-1)).toString(32)+n,t=":"+t+"R"+n,n=qr++,0<n&&(t+="H"+n.toString(32)),t+=":"}else n=cf++,t=":"+t+"r"+n.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},hf={readContext:Tt,useCallback:cc,useContext:Tt,useEffect:bl,useImperativeHandle:ac,useInsertionEffect:oc,useLayoutEffect:lc,useMemo:uc,useReducer:jl,useRef:rc,useState:function(){return jl(Br)},useDebugValue:El,useDeferredValue:function(e){var t=_t();return dc(t,Ye.memoizedState,e)},useTransition:function(){var e=jl(Br)[0],t=_t().memoizedState;return[e,t]},useMutableSource:Ka,useSyncExternalStore:Xa,useId:fc,unstable_isNewReconciler:!1},mf={readContext:Tt,useCallback:cc,useContext:Tt,useEffect:bl,useImperativeHandle:ac,useInsertionEffect:oc,useLayoutEffect:lc,useMemo:uc,useReducer:Ml,useRef:rc,useState:function(){return Ml(Br)},useDebugValue:El,useDeferredValue:function(e){var t=_t();return Ye===null?t.memoizedState=e:dc(t,Ye.memoizedState,e)},useTransition:function(){var e=Ml(Br)[0],t=_t().memoizedState;return[e,t]},useMutableSource:Ka,useSyncExternalStore:Xa,useId:fc,unstable_isNewReconciler:!1};function Bt(e,t){if(e&&e.defaultProps){t=G({},t),e=e.defaultProps;for(var n in e)t[n]===void 0&&(t[n]=e[n]);return t}return t}function Cl(e,t,n,s){t=e.memoizedState,n=n(s,t),n=n==null?t:G({},t,n),e.memoizedState=n,e.lanes===0&&(e.updateQueue.baseState=n)}var Bs={isMounted:function(e){return(e=e._reactInternals)?Cn(e)===e:!1},enqueueSetState:function(e,t,n){e=e._reactInternals;var s=pt(),o=kn(e),c=rn(s,o);c.payload=t,n!=null&&(c.callback=n),t=yn(e,c,o),t!==null&&(Vt(t,e,o,s),Os(t,e,o))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var s=pt(),o=kn(e),c=rn(s,o);c.tag=1,c.payload=t,n!=null&&(c.callback=n),t=yn(e,c,o),t!==null&&(Vt(t,e,o,s),Os(t,e,o))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=pt(),s=kn(e),o=rn(n,s);o.tag=2,t!=null&&(o.callback=t),t=yn(e,o,s),t!==null&&(Vt(t,e,s,n),Os(t,e,s))}};function vc(e,t,n,s,o,c,p){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(s,c,p):t.prototype&&t.prototype.isPureReactComponent?!Nr(n,s)||!Nr(o,c):!0}function gc(e,t,n){var s=!1,o=mn,c=t.contextType;return typeof c=="object"&&c!==null?c=Tt(c):(o=gt(t)?Pn:it.current,s=t.contextTypes,c=(s=s!=null)?Yn(e,o):mn),t=new t(n,c),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=Bs,e.stateNode=t,t._reactInternals=e,s&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=o,e.__reactInternalMemoizedMaskedChildContext=c),t}function yc(e,t,n,s){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(n,s),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(n,s),t.state!==e&&Bs.enqueueReplaceState(t,t.state,null)}function Nl(e,t,n,s){var o=e.stateNode;o.props=n,o.state=e.memoizedState,o.refs={},hl(e);var c=t.contextType;typeof c=="object"&&c!==null?o.context=Tt(c):(c=gt(t)?Pn:it.current,o.context=Yn(e,c)),o.state=e.memoizedState,c=t.getDerivedStateFromProps,typeof c=="function"&&(Cl(e,t,c,n),o.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof o.getSnapshotBeforeUpdate=="function"||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(t=o.state,typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount(),t!==o.state&&Bs.enqueueReplaceState(o,o.state,null),Rs(e,n,o,s),o.state=e.memoizedState),typeof o.componentDidMount=="function"&&(e.flags|=4194308)}function or(e,t){try{var n="",s=t;do n+=ke(s),s=s.return;while(s);var o=n}catch(c){o=`
Error generating stack: `+c.message+`
`+c.stack}return{value:e,source:t,stack:o,digest:null}}function Pl(e,t,n){return{value:e,source:null,stack:n??null,digest:t??null}}function Tl(e,t){try{console.error(t.value)}catch(n){setTimeout(function(){throw n})}}var vf=typeof WeakMap=="function"?WeakMap:Map;function xc(e,t,n){n=rn(-1,n),n.tag=3,n.payload={element:null};var s=t.value;return n.callback=function(){Qs||(Qs=!0,Wl=s),Tl(e,t)},n}function wc(e,t,n){n=rn(-1,n),n.tag=3;var s=e.type.getDerivedStateFromError;if(typeof s=="function"){var o=t.value;n.payload=function(){return s(o)},n.callback=function(){Tl(e,t)}}var c=e.stateNode;return c!==null&&typeof c.componentDidCatch=="function"&&(n.callback=function(){Tl(e,t),typeof s!="function"&&(wn===null?wn=new Set([this]):wn.add(this));var p=t.stack;this.componentDidCatch(t.value,{componentStack:p!==null?p:""})}),n}function Sc(e,t,n){var s=e.pingCache;if(s===null){s=e.pingCache=new vf;var o=new Set;s.set(t,o)}else o=s.get(t),o===void 0&&(o=new Set,s.set(t,o));o.has(n)||(o.add(n),e=Tf.bind(null,e,t,n),t.then(e,e))}function kc(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function jc(e,t,n,s,o){return(e.mode&1)===0?(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(t=rn(-1,1),t.tag=2,yn(n,t,1))),n.lanes|=1),e):(e.flags|=65536,e.lanes=o,e)}var gf=J.ReactCurrentOwner,yt=!1;function ft(e,t,n,s){t.child=e===null?Ha(t,null,n,s):tr(t,e.child,n,s)}function Mc(e,t,n,s,o){n=n.render;var c=t.ref;return rr(t,o),s=Sl(e,t,n,s,c,o),n=kl(),e!==null&&!yt?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~o,sn(e,t,o)):(De&&n&&sl(t),t.flags|=1,ft(e,t,s,o),t.child)}function bc(e,t,n,s,o){if(e===null){var c=n.type;return typeof c=="function"&&!Jl(c)&&c.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(t.tag=15,t.type=c,Ec(e,t,c,s,o)):(e=eo(n.type,null,s,t,t.mode,o),e.ref=t.ref,e.return=t,t.child=e)}if(c=e.child,(e.lanes&o)===0){var p=c.memoizedProps;if(n=n.compare,n=n!==null?n:Nr,n(p,s)&&e.ref===t.ref)return sn(e,t,o)}return t.flags|=1,e=Mn(c,s),e.ref=t.ref,e.return=t,t.child=e}function Ec(e,t,n,s,o){if(e!==null){var c=e.memoizedProps;if(Nr(c,s)&&e.ref===t.ref)if(yt=!1,t.pendingProps=s=c,(e.lanes&o)!==0)(e.flags&131072)!==0&&(yt=!0);else return t.lanes=e.lanes,sn(e,t,o)}return _l(e,t,n,s,o)}function Cc(e,t,n){var s=t.pendingProps,o=s.children,c=e!==null?e.memoizedState:null;if(s.mode==="hidden")if((t.mode&1)===0)t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ae(ir,Et),Et|=n;else{if((n&1073741824)===0)return e=c!==null?c.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Ae(ir,Et),Et|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},s=c!==null?c.baseLanes:n,Ae(ir,Et),Et|=s}else c!==null?(s=c.baseLanes|n,t.memoizedState=null):s=n,Ae(ir,Et),Et|=s;return ft(e,t,o,n),t.child}function Nc(e,t){var n=t.ref;(e===null&&n!==null||e!==null&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function _l(e,t,n,s,o){var c=gt(n)?Pn:it.current;return c=Yn(t,c),rr(t,o),n=Sl(e,t,n,s,c,o),s=kl(),e!==null&&!yt?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~o,sn(e,t,o)):(De&&s&&sl(t),t.flags|=1,ft(e,t,n,o),t.child)}function Pc(e,t,n,s,o){if(gt(n)){var c=!0;bs(t)}else c=!1;if(rr(t,o),t.stateNode===null)Hs(e,t),gc(t,n,s),Nl(t,n,s,o),s=!0;else if(e===null){var p=t.stateNode,S=t.memoizedProps;p.props=S;var b=p.context,O=n.contextType;typeof O=="object"&&O!==null?O=Tt(O):(O=gt(n)?Pn:it.current,O=Yn(t,O));var W=n.getDerivedStateFromProps,Y=typeof W=="function"||typeof p.getSnapshotBeforeUpdate=="function";Y||typeof p.UNSAFE_componentWillReceiveProps!="function"&&typeof p.componentWillReceiveProps!="function"||(S!==s||b!==O)&&yc(t,p,s,O),gn=!1;var H=t.memoizedState;p.state=H,Rs(t,s,p,o),b=t.memoizedState,S!==s||H!==b||vt.current||gn?(typeof W=="function"&&(Cl(t,n,W,s),b=t.memoizedState),(S=gn||vc(t,n,S,s,H,b,O))?(Y||typeof p.UNSAFE_componentWillMount!="function"&&typeof p.componentWillMount!="function"||(typeof p.componentWillMount=="function"&&p.componentWillMount(),typeof p.UNSAFE_componentWillMount=="function"&&p.UNSAFE_componentWillMount()),typeof p.componentDidMount=="function"&&(t.flags|=4194308)):(typeof p.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=s,t.memoizedState=b),p.props=s,p.state=b,p.context=O,s=S):(typeof p.componentDidMount=="function"&&(t.flags|=4194308),s=!1)}else{p=t.stateNode,Wa(e,t),S=t.memoizedProps,O=t.type===t.elementType?S:Bt(t.type,S),p.props=O,Y=t.pendingProps,H=p.context,b=n.contextType,typeof b=="object"&&b!==null?b=Tt(b):(b=gt(n)?Pn:it.current,b=Yn(t,b));var re=n.getDerivedStateFromProps;(W=typeof re=="function"||typeof p.getSnapshotBeforeUpdate=="function")||typeof p.UNSAFE_componentWillReceiveProps!="function"&&typeof p.componentWillReceiveProps!="function"||(S!==Y||H!==b)&&yc(t,p,s,b),gn=!1,H=t.memoizedState,p.state=H,Rs(t,s,p,o);var oe=t.memoizedState;S!==Y||H!==oe||vt.current||gn?(typeof re=="function"&&(Cl(t,n,re,s),oe=t.memoizedState),(O=gn||vc(t,n,O,s,H,oe,b)||!1)?(W||typeof p.UNSAFE_componentWillUpdate!="function"&&typeof p.componentWillUpdate!="function"||(typeof p.componentWillUpdate=="function"&&p.componentWillUpdate(s,oe,b),typeof p.UNSAFE_componentWillUpdate=="function"&&p.UNSAFE_componentWillUpdate(s,oe,b)),typeof p.componentDidUpdate=="function"&&(t.flags|=4),typeof p.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof p.componentDidUpdate!="function"||S===e.memoizedProps&&H===e.memoizedState||(t.flags|=4),typeof p.getSnapshotBeforeUpdate!="function"||S===e.memoizedProps&&H===e.memoizedState||(t.flags|=1024),t.memoizedProps=s,t.memoizedState=oe),p.props=s,p.state=oe,p.context=b,s=O):(typeof p.componentDidUpdate!="function"||S===e.memoizedProps&&H===e.memoizedState||(t.flags|=4),typeof p.getSnapshotBeforeUpdate!="function"||S===e.memoizedProps&&H===e.memoizedState||(t.flags|=1024),s=!1)}return Ll(e,t,n,s,c,o)}function Ll(e,t,n,s,o,c){Nc(e,t);var p=(t.flags&128)!==0;if(!s&&!p)return o&&Ra(t,n,!1),sn(e,t,c);s=t.stateNode,gf.current=t;var S=p&&typeof n.getDerivedStateFromError!="function"?null:s.render();return t.flags|=1,e!==null&&p?(t.child=tr(t,e.child,null,c),t.child=tr(t,null,S,c)):ft(e,t,S,c),t.memoizedState=s.state,o&&Ra(t,n,!0),t.child}function Tc(e){var t=e.stateNode;t.pendingContext?La(e,t.pendingContext,t.pendingContext!==t.context):t.context&&La(e,t.context,!1),ml(e,t.containerInfo)}function _c(e,t,n,s,o){return er(),al(o),t.flags|=256,ft(e,t,n,s),t.child}var Ol={dehydrated:null,treeContext:null,retryLane:0};function Rl(e){return{baseLanes:e,cachePool:null,transitions:null}}function Lc(e,t,n){var s=t.pendingProps,o=Ue.current,c=!1,p=(t.flags&128)!==0,S;if((S=p)||(S=e!==null&&e.memoizedState===null?!1:(o&2)!==0),S?(c=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(o|=1),Ae(Ue,o&1),e===null)return il(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?((t.mode&1)===0?t.lanes=1:e.data==="$!"?t.lanes=8:t.lanes=1073741824,null):(p=s.children,e=s.fallback,c?(s=t.mode,c=t.child,p={mode:"hidden",children:p},(s&1)===0&&c!==null?(c.childLanes=0,c.pendingProps=p):c=to(p,s,0,null),e=Dn(e,s,n,null),c.return=t,e.return=t,c.sibling=e,t.child=c,t.child.memoizedState=Rl(n),t.memoizedState=Ol,e):Il(t,p));if(o=e.memoizedState,o!==null&&(S=o.dehydrated,S!==null))return yf(e,t,p,s,S,o,n);if(c){c=s.fallback,p=t.mode,o=e.child,S=o.sibling;var b={mode:"hidden",children:s.children};return(p&1)===0&&t.child!==o?(s=t.child,s.childLanes=0,s.pendingProps=b,t.deletions=null):(s=Mn(o,b),s.subtreeFlags=o.subtreeFlags&14680064),S!==null?c=Mn(S,c):(c=Dn(c,p,n,null),c.flags|=2),c.return=t,s.return=t,s.sibling=c,t.child=s,s=c,c=t.child,p=e.child.memoizedState,p=p===null?Rl(n):{baseLanes:p.baseLanes|n,cachePool:null,transitions:p.transitions},c.memoizedState=p,c.childLanes=e.childLanes&~n,t.memoizedState=Ol,s}return c=e.child,e=c.sibling,s=Mn(c,{mode:"visible",children:s.children}),(t.mode&1)===0&&(s.lanes=n),s.return=t,s.sibling=null,e!==null&&(n=t.deletions,n===null?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=s,t.memoizedState=null,s}function Il(e,t){return t=to({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function Us(e,t,n,s){return s!==null&&al(s),tr(t,e.child,null,n),e=Il(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function yf(e,t,n,s,o,c,p){if(n)return t.flags&256?(t.flags&=-257,s=Pl(Error(l(422))),Us(e,t,p,s)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(c=s.fallback,o=t.mode,s=to({mode:"visible",children:s.children},o,0,null),c=Dn(c,o,p,null),c.flags|=2,s.return=t,c.return=t,s.sibling=c,t.child=s,(t.mode&1)!==0&&tr(t,e.child,null,p),t.child.memoizedState=Rl(p),t.memoizedState=Ol,c);if((t.mode&1)===0)return Us(e,t,p,null);if(o.data==="$!"){if(s=o.nextSibling&&o.nextSibling.dataset,s)var S=s.dgst;return s=S,c=Error(l(419)),s=Pl(c,s,void 0),Us(e,t,p,s)}if(S=(p&e.childLanes)!==0,yt||S){if(s=tt,s!==null){switch(p&-p){case 4:o=2;break;case 16:o=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:o=32;break;case 536870912:o=268435456;break;default:o=0}o=(o&(s.suspendedLanes|p))!==0?0:o,o!==0&&o!==c.retryLane&&(c.retryLane=o,nn(e,o),Vt(s,e,o,-1))}return Yl(),s=Pl(Error(l(421))),Us(e,t,p,s)}return o.data==="$?"?(t.flags|=128,t.child=e.child,t=_f.bind(null,e),o._reactRetry=t,null):(e=c.treeContext,bt=pn(o.nextSibling),Mt=t,De=!0,qt=null,e!==null&&(Nt[Pt++]=en,Nt[Pt++]=tn,Nt[Pt++]=Tn,en=e.id,tn=e.overflow,Tn=t),t=Il(t,s.children),t.flags|=4096,t)}function Oc(e,t,n){e.lanes|=t;var s=e.alternate;s!==null&&(s.lanes|=t),fl(e.return,t,n)}function Al(e,t,n,s,o){var c=e.memoizedState;c===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:s,tail:n,tailMode:o}:(c.isBackwards=t,c.rendering=null,c.renderingStartTime=0,c.last=s,c.tail=n,c.tailMode=o)}function Rc(e,t,n){var s=t.pendingProps,o=s.revealOrder,c=s.tail;if(ft(e,t,s.children,n),s=Ue.current,(s&2)!==0)s=s&1|2,t.flags|=128;else{if(e!==null&&(e.flags&128)!==0)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&Oc(e,n,t);else if(e.tag===19)Oc(e,n,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}s&=1}if(Ae(Ue,s),(t.mode&1)===0)t.memoizedState=null;else switch(o){case"forwards":for(n=t.child,o=null;n!==null;)e=n.alternate,e!==null&&Is(e)===null&&(o=n),n=n.sibling;n=o,n===null?(o=t.child,t.child=null):(o=n.sibling,n.sibling=null),Al(t,!1,o,n,c);break;case"backwards":for(n=null,o=t.child,t.child=null;o!==null;){if(e=o.alternate,e!==null&&Is(e)===null){t.child=o;break}e=o.sibling,o.sibling=n,n=o,o=e}Al(t,!0,n,null,c);break;case"together":Al(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Hs(e,t){(t.mode&1)===0&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function sn(e,t,n){if(e!==null&&(t.dependencies=e.dependencies),In|=t.lanes,(n&t.childLanes)===0)return null;if(e!==null&&t.child!==e.child)throw Error(l(153));if(t.child!==null){for(e=t.child,n=Mn(e,e.pendingProps),t.child=n,n.return=t;e.sibling!==null;)e=e.sibling,n=n.sibling=Mn(e,e.pendingProps),n.return=t;n.sibling=null}return t.child}function xf(e,t,n){switch(t.tag){case 3:Tc(t),er();break;case 5:Qa(t);break;case 1:gt(t.type)&&bs(t);break;case 4:ml(t,t.stateNode.containerInfo);break;case 10:var s=t.type._context,o=t.memoizedProps.value;Ae(_s,s._currentValue),s._currentValue=o;break;case 13:if(s=t.memoizedState,s!==null)return s.dehydrated!==null?(Ae(Ue,Ue.current&1),t.flags|=128,null):(n&t.child.childLanes)!==0?Lc(e,t,n):(Ae(Ue,Ue.current&1),e=sn(e,t,n),e!==null?e.sibling:null);Ae(Ue,Ue.current&1);break;case 19:if(s=(n&t.childLanes)!==0,(e.flags&128)!==0){if(s)return Rc(e,t,n);t.flags|=128}if(o=t.memoizedState,o!==null&&(o.rendering=null,o.tail=null,o.lastEffect=null),Ae(Ue,Ue.current),s)break;return null;case 22:case 23:return t.lanes=0,Cc(e,t,n)}return sn(e,t,n)}var Ic,Fl,Ac,Fc;Ic=function(e,t){for(var n=t.child;n!==null;){if(n.tag===5||n.tag===6)e.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===t)break;for(;n.sibling===null;){if(n.return===null||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}},Fl=function(){},Ac=function(e,t,n,s){var o=e.memoizedProps;if(o!==s){e=t.stateNode,On(Qt.current);var c=null;switch(n){case"input":o=dt(e,o),s=dt(e,s),c=[];break;case"select":o=G({},o,{value:void 0}),s=G({},s,{value:void 0}),c=[];break;case"textarea":o=mt(e,o),s=mt(e,s),c=[];break;default:typeof o.onClick!="function"&&typeof s.onClick=="function"&&(e.onclick=ks)}go(n,s);var p;n=null;for(O in o)if(!s.hasOwnProperty(O)&&o.hasOwnProperty(O)&&o[O]!=null)if(O==="style"){var S=o[O];for(p in S)S.hasOwnProperty(p)&&(n||(n={}),n[p]="")}else O!=="dangerouslySetInnerHTML"&&O!=="children"&&O!=="suppressContentEditableWarning"&&O!=="suppressHydrationWarning"&&O!=="autoFocus"&&(d.hasOwnProperty(O)?c||(c=[]):(c=c||[]).push(O,null));for(O in s){var b=s[O];if(S=o?.[O],s.hasOwnProperty(O)&&b!==S&&(b!=null||S!=null))if(O==="style")if(S){for(p in S)!S.hasOwnProperty(p)||b&&b.hasOwnProperty(p)||(n||(n={}),n[p]="");for(p in b)b.hasOwnProperty(p)&&S[p]!==b[p]&&(n||(n={}),n[p]=b[p])}else n||(c||(c=[]),c.push(O,n)),n=b;else O==="dangerouslySetInnerHTML"?(b=b?b.__html:void 0,S=S?S.__html:void 0,b!=null&&S!==b&&(c=c||[]).push(O,b)):O==="children"?typeof b!="string"&&typeof b!="number"||(c=c||[]).push(O,""+b):O!=="suppressContentEditableWarning"&&O!=="suppressHydrationWarning"&&(d.hasOwnProperty(O)?(b!=null&&O==="onScroll"&&Fe("scroll",e),c||S===b||(c=[])):(c=c||[]).push(O,b))}n&&(c=c||[]).push("style",n);var O=c;(t.updateQueue=O)&&(t.flags|=4)}},Fc=function(e,t,n,s){n!==s&&(t.flags|=4)};function Hr(e,t){if(!De)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;t!==null;)t.alternate!==null&&(n=t),t=t.sibling;n===null?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var s=null;n!==null;)n.alternate!==null&&(s=n),n=n.sibling;s===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:s.sibling=null}}function ct(e){var t=e.alternate!==null&&e.alternate.child===e.child,n=0,s=0;if(t)for(var o=e.child;o!==null;)n|=o.lanes|o.childLanes,s|=o.subtreeFlags&14680064,s|=o.flags&14680064,o.return=e,o=o.sibling;else for(o=e.child;o!==null;)n|=o.lanes|o.childLanes,s|=o.subtreeFlags,s|=o.flags,o.return=e,o=o.sibling;return e.subtreeFlags|=s,e.childLanes=n,t}function wf(e,t,n){var s=t.pendingProps;switch(ol(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return ct(t),null;case 1:return gt(t.type)&&Ms(),ct(t),null;case 3:return s=t.stateNode,sr(),ze(vt),ze(it),yl(),s.pendingContext&&(s.context=s.pendingContext,s.pendingContext=null),(e===null||e.child===null)&&(Ps(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&(t.flags&256)===0||(t.flags|=1024,qt!==null&&(Ql(qt),qt=null))),Fl(e,t),ct(t),null;case 5:vl(t);var o=On(zr.current);if(n=t.type,e!==null&&t.stateNode!=null)Ac(e,t,n,s,o),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!s){if(t.stateNode===null)throw Error(l(166));return ct(t),null}if(e=On(Qt.current),Ps(t)){s=t.stateNode,n=t.type;var c=t.memoizedProps;switch(s[Gt]=t,s[Or]=c,e=(t.mode&1)!==0,n){case"dialog":Fe("cancel",s),Fe("close",s);break;case"iframe":case"object":case"embed":Fe("load",s);break;case"video":case"audio":for(o=0;o<Tr.length;o++)Fe(Tr[o],s);break;case"source":Fe("error",s);break;case"img":case"image":case"link":Fe("error",s),Fe("load",s);break;case"details":Fe("toggle",s);break;case"input":At(s,c),Fe("invalid",s);break;case"select":s._wrapperState={wasMultiple:!!c.multiple},Fe("invalid",s);break;case"textarea":Yt(s,c),Fe("invalid",s)}go(n,c),o=null;for(var p in c)if(c.hasOwnProperty(p)){var S=c[p];p==="children"?typeof S=="string"?s.textContent!==S&&(c.suppressHydrationWarning!==!0&&Ss(s.textContent,S,e),o=["children",S]):typeof S=="number"&&s.textContent!==""+S&&(c.suppressHydrationWarning!==!0&&Ss(s.textContent,S,e),o=["children",""+S]):d.hasOwnProperty(p)&&S!=null&&p==="onScroll"&&Fe("scroll",s)}switch(n){case"input":Be(s),je(s,c,!0);break;case"textarea":Be(s),Ft(s);break;case"select":case"option":break;default:typeof c.onClick=="function"&&(s.onclick=ks)}s=o,t.updateQueue=s,s!==null&&(t.flags|=4)}else{p=o.nodeType===9?o:o.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=Ct(n)),e==="http://www.w3.org/1999/xhtml"?n==="script"?(e=p.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof s.is=="string"?e=p.createElement(n,{is:s.is}):(e=p.createElement(n),n==="select"&&(p=e,s.multiple?p.multiple=!0:s.size&&(p.size=s.size))):e=p.createElementNS(e,n),e[Gt]=t,e[Or]=s,Ic(e,t,!1,!1),t.stateNode=e;e:{switch(p=yo(n,s),n){case"dialog":Fe("cancel",e),Fe("close",e),o=s;break;case"iframe":case"object":case"embed":Fe("load",e),o=s;break;case"video":case"audio":for(o=0;o<Tr.length;o++)Fe(Tr[o],e);o=s;break;case"source":Fe("error",e),o=s;break;case"img":case"image":case"link":Fe("error",e),Fe("load",e),o=s;break;case"details":Fe("toggle",e),o=s;break;case"input":At(e,s),o=dt(e,s),Fe("invalid",e);break;case"option":o=s;break;case"select":e._wrapperState={wasMultiple:!!s.multiple},o=G({},s,{value:void 0}),Fe("invalid",e);break;case"textarea":Yt(e,s),o=mt(e,s),Fe("invalid",e);break;default:o=s}go(n,o),S=o;for(c in S)if(S.hasOwnProperty(c)){var b=S[c];c==="style"?Ei(e,b):c==="dangerouslySetInnerHTML"?(b=b?b.__html:void 0,b!=null&&En(e,b)):c==="children"?typeof b=="string"?(n!=="textarea"||b!=="")&&dr(e,b):typeof b=="number"&&dr(e,""+b):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&(d.hasOwnProperty(c)?b!=null&&c==="onScroll"&&Fe("scroll",e):b!=null&&X(e,c,b,p))}switch(n){case"input":Be(e),je(e,s,!1);break;case"textarea":Be(e),Ft(e);break;case"option":s.value!=null&&e.setAttribute("value",""+Me(s.value));break;case"select":e.multiple=!!s.multiple,c=s.value,c!=null?_e(e,!!s.multiple,c,!1):s.defaultValue!=null&&_e(e,!!s.multiple,s.defaultValue,!0);break;default:typeof o.onClick=="function"&&(e.onclick=ks)}switch(n){case"button":case"input":case"select":case"textarea":s=!!s.autoFocus;break e;case"img":s=!0;break e;default:s=!1}}s&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return ct(t),null;case 6:if(e&&t.stateNode!=null)Fc(e,t,e.memoizedProps,s);else{if(typeof s!="string"&&t.stateNode===null)throw Error(l(166));if(n=On(zr.current),On(Qt.current),Ps(t)){if(s=t.stateNode,n=t.memoizedProps,s[Gt]=t,(c=s.nodeValue!==n)&&(e=Mt,e!==null))switch(e.tag){case 3:Ss(s.nodeValue,n,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&Ss(s.nodeValue,n,(e.mode&1)!==0)}c&&(t.flags|=4)}else s=(n.nodeType===9?n:n.ownerDocument).createTextNode(s),s[Gt]=t,t.stateNode=s}return ct(t),null;case 13:if(ze(Ue),s=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(De&&bt!==null&&(t.mode&1)!==0&&(t.flags&128)===0)qa(),er(),t.flags|=98560,c=!1;else if(c=Ps(t),s!==null&&s.dehydrated!==null){if(e===null){if(!c)throw Error(l(318));if(c=t.memoizedState,c=c!==null?c.dehydrated:null,!c)throw Error(l(317));c[Gt]=t}else er(),(t.flags&128)===0&&(t.memoizedState=null),t.flags|=4;ct(t),c=!1}else qt!==null&&(Ql(qt),qt=null),c=!0;if(!c)return t.flags&65536?t:null}return(t.flags&128)!==0?(t.lanes=n,t):(s=s!==null,s!==(e!==null&&e.memoizedState!==null)&&s&&(t.child.flags|=8192,(t.mode&1)!==0&&(e===null||(Ue.current&1)!==0?Je===0&&(Je=3):Yl())),t.updateQueue!==null&&(t.flags|=4),ct(t),null);case 4:return sr(),Fl(e,t),e===null&&_r(t.stateNode.containerInfo),ct(t),null;case 10:return dl(t.type._context),ct(t),null;case 17:return gt(t.type)&&Ms(),ct(t),null;case 19:if(ze(Ue),c=t.memoizedState,c===null)return ct(t),null;if(s=(t.flags&128)!==0,p=c.rendering,p===null)if(s)Hr(c,!1);else{if(Je!==0||e!==null&&(e.flags&128)!==0)for(e=t.child;e!==null;){if(p=Is(e),p!==null){for(t.flags|=128,Hr(c,!1),s=p.updateQueue,s!==null&&(t.updateQueue=s,t.flags|=4),t.subtreeFlags=0,s=n,n=t.child;n!==null;)c=n,e=s,c.flags&=14680066,p=c.alternate,p===null?(c.childLanes=0,c.lanes=e,c.child=null,c.subtreeFlags=0,c.memoizedProps=null,c.memoizedState=null,c.updateQueue=null,c.dependencies=null,c.stateNode=null):(c.childLanes=p.childLanes,c.lanes=p.lanes,c.child=p.child,c.subtreeFlags=0,c.deletions=null,c.memoizedProps=p.memoizedProps,c.memoizedState=p.memoizedState,c.updateQueue=p.updateQueue,c.type=p.type,e=p.dependencies,c.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return Ae(Ue,Ue.current&1|2),t.child}e=e.sibling}c.tail!==null&&$e()>ar&&(t.flags|=128,s=!0,Hr(c,!1),t.lanes=4194304)}else{if(!s)if(e=Is(p),e!==null){if(t.flags|=128,s=!0,n=e.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),Hr(c,!0),c.tail===null&&c.tailMode==="hidden"&&!p.alternate&&!De)return ct(t),null}else 2*$e()-c.renderingStartTime>ar&&n!==1073741824&&(t.flags|=128,s=!0,Hr(c,!1),t.lanes=4194304);c.isBackwards?(p.sibling=t.child,t.child=p):(n=c.last,n!==null?n.sibling=p:t.child=p,c.last=p)}return c.tail!==null?(t=c.tail,c.rendering=t,c.tail=t.sibling,c.renderingStartTime=$e(),t.sibling=null,n=Ue.current,Ae(Ue,s?n&1|2:n&1),t):(ct(t),null);case 22:case 23:return Xl(),s=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==s&&(t.flags|=8192),s&&(t.mode&1)!==0?(Et&1073741824)!==0&&(ct(t),t.subtreeFlags&6&&(t.flags|=8192)):ct(t),null;case 24:return null;case 25:return null}throw Error(l(156,t.tag))}function Sf(e,t){switch(ol(t),t.tag){case 1:return gt(t.type)&&Ms(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return sr(),ze(vt),ze(it),yl(),e=t.flags,(e&65536)!==0&&(e&128)===0?(t.flags=e&-65537|128,t):null;case 5:return vl(t),null;case 13:if(ze(Ue),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(l(340));er()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return ze(Ue),null;case 4:return sr(),null;case 10:return dl(t.type._context),null;case 22:case 23:return Xl(),null;case 24:return null;default:return null}}var Vs=!1,ut=!1,kf=typeof WeakSet=="function"?WeakSet:Set,se=null;function lr(e,t){var n=e.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(s){Ve(e,t,s)}else n.current=null}function zl(e,t,n){try{n()}catch(s){Ve(e,t,s)}}var zc=!1;function jf(e,t){if(Xo=us,e=va(),Uo(e)){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{n=(n=e.ownerDocument)&&n.defaultView||window;var s=n.getSelection&&n.getSelection();if(s&&s.rangeCount!==0){n=s.anchorNode;var o=s.anchorOffset,c=s.focusNode;s=s.focusOffset;try{n.nodeType,c.nodeType}catch{n=null;break e}var p=0,S=-1,b=-1,O=0,W=0,Y=e,H=null;t:for(;;){for(var re;Y!==n||o!==0&&Y.nodeType!==3||(S=p+o),Y!==c||s!==0&&Y.nodeType!==3||(b=p+s),Y.nodeType===3&&(p+=Y.nodeValue.length),(re=Y.firstChild)!==null;)H=Y,Y=re;for(;;){if(Y===e)break t;if(H===n&&++O===o&&(S=p),H===c&&++W===s&&(b=p),(re=Y.nextSibling)!==null)break;Y=H,H=Y.parentNode}Y=re}n=S===-1||b===-1?null:{start:S,end:b}}else n=null}n=n||{start:0,end:0}}else n=null;for(Yo={focusedElem:e,selectionRange:n},us=!1,se=t;se!==null;)if(t=se,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,se=e;else for(;se!==null;){t=se;try{var oe=t.alternate;if((t.flags&1024)!==0)switch(t.tag){case 0:case 11:case 15:break;case 1:if(oe!==null){var le=oe.memoizedProps,Ge=oe.memoizedState,T=t.stateNode,C=T.getSnapshotBeforeUpdate(t.elementType===t.type?le:Bt(t.type,le),Ge);T.__reactInternalSnapshotBeforeUpdate=C}break;case 3:var L=t.stateNode.containerInfo;L.nodeType===1?L.textContent="":L.nodeType===9&&L.documentElement&&L.removeChild(L.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(l(163))}}catch(ee){Ve(t,t.return,ee)}if(e=t.sibling,e!==null){e.return=t.return,se=e;break}se=t.return}return oe=zc,zc=!1,oe}function Vr(e,t,n){var s=t.updateQueue;if(s=s!==null?s.lastEffect:null,s!==null){var o=s=s.next;do{if((o.tag&e)===e){var c=o.destroy;o.destroy=void 0,c!==void 0&&zl(t,n,c)}o=o.next}while(o!==s)}}function Ws(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var n=t=t.next;do{if((n.tag&e)===e){var s=n.create;n.destroy=s()}n=n.next}while(n!==t)}}function Dl(e){var t=e.ref;if(t!==null){var n=e.stateNode;switch(e.tag){case 5:e=n;break;default:e=n}typeof t=="function"?t(e):t.current=e}}function Dc(e){var t=e.alternate;t!==null&&(e.alternate=null,Dc(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[Gt],delete t[Or],delete t[tl],delete t[sf],delete t[of])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function qc(e){return e.tag===5||e.tag===3||e.tag===4}function Bc(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||qc(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function ql(e,t,n){var s=e.tag;if(s===5||s===6)e=e.stateNode,t?n.nodeType===8?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(n.nodeType===8?(t=n.parentNode,t.insertBefore(e,n)):(t=n,t.appendChild(e)),n=n._reactRootContainer,n!=null||t.onclick!==null||(t.onclick=ks));else if(s!==4&&(e=e.child,e!==null))for(ql(e,t,n),e=e.sibling;e!==null;)ql(e,t,n),e=e.sibling}function Bl(e,t,n){var s=e.tag;if(s===5||s===6)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(s!==4&&(e=e.child,e!==null))for(Bl(e,t,n),e=e.sibling;e!==null;)Bl(e,t,n),e=e.sibling}var st=null,Ut=!1;function xn(e,t,n){for(n=n.child;n!==null;)Uc(e,t,n),n=n.sibling}function Uc(e,t,n){if($t&&typeof $t.onCommitFiberUnmount=="function")try{$t.onCommitFiberUnmount(ss,n)}catch{}switch(n.tag){case 5:ut||lr(n,t);case 6:var s=st,o=Ut;st=null,xn(e,t,n),st=s,Ut=o,st!==null&&(Ut?(e=st,n=n.stateNode,e.nodeType===8?e.parentNode.removeChild(n):e.removeChild(n)):st.removeChild(n.stateNode));break;case 18:st!==null&&(Ut?(e=st,n=n.stateNode,e.nodeType===8?el(e.parentNode,n):e.nodeType===1&&el(e,n),kr(e)):el(st,n.stateNode));break;case 4:s=st,o=Ut,st=n.stateNode.containerInfo,Ut=!0,xn(e,t,n),st=s,Ut=o;break;case 0:case 11:case 14:case 15:if(!ut&&(s=n.updateQueue,s!==null&&(s=s.lastEffect,s!==null))){o=s=s.next;do{var c=o,p=c.destroy;c=c.tag,p!==void 0&&((c&2)!==0||(c&4)!==0)&&zl(n,t,p),o=o.next}while(o!==s)}xn(e,t,n);break;case 1:if(!ut&&(lr(n,t),s=n.stateNode,typeof s.componentWillUnmount=="function"))try{s.props=n.memoizedProps,s.state=n.memoizedState,s.componentWillUnmount()}catch(S){Ve(n,t,S)}xn(e,t,n);break;case 21:xn(e,t,n);break;case 22:n.mode&1?(ut=(s=ut)||n.memoizedState!==null,xn(e,t,n),ut=s):xn(e,t,n);break;default:xn(e,t,n)}}function Hc(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var n=e.stateNode;n===null&&(n=e.stateNode=new kf),t.forEach(function(s){var o=Lf.bind(null,e,s);n.has(s)||(n.add(s),s.then(o,o))})}}function Ht(e,t){var n=t.deletions;if(n!==null)for(var s=0;s<n.length;s++){var o=n[s];try{var c=e,p=t,S=p;e:for(;S!==null;){switch(S.tag){case 5:st=S.stateNode,Ut=!1;break e;case 3:st=S.stateNode.containerInfo,Ut=!0;break e;case 4:st=S.stateNode.containerInfo,Ut=!0;break e}S=S.return}if(st===null)throw Error(l(160));Uc(c,p,o),st=null,Ut=!1;var b=o.alternate;b!==null&&(b.return=null),o.return=null}catch(O){Ve(o,t,O)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)Vc(t,e),t=t.sibling}function Vc(e,t){var n=e.alternate,s=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(Ht(t,e),Xt(e),s&4){try{Vr(3,e,e.return),Ws(3,e)}catch(le){Ve(e,e.return,le)}try{Vr(5,e,e.return)}catch(le){Ve(e,e.return,le)}}break;case 1:Ht(t,e),Xt(e),s&512&&n!==null&&lr(n,n.return);break;case 5:if(Ht(t,e),Xt(e),s&512&&n!==null&&lr(n,n.return),e.flags&32){var o=e.stateNode;try{dr(o,"")}catch(le){Ve(e,e.return,le)}}if(s&4&&(o=e.stateNode,o!=null)){var c=e.memoizedProps,p=n!==null?n.memoizedProps:c,S=e.type,b=e.updateQueue;if(e.updateQueue=null,b!==null)try{S==="input"&&c.type==="radio"&&c.name!=null&&K(o,c),yo(S,p);var O=yo(S,c);for(p=0;p<b.length;p+=2){var W=b[p],Y=b[p+1];W==="style"?Ei(o,Y):W==="dangerouslySetInnerHTML"?En(o,Y):W==="children"?dr(o,Y):X(o,W,Y,O)}switch(S){case"input":me(o,c);break;case"textarea":Ee(o,c);break;case"select":var H=o._wrapperState.wasMultiple;o._wrapperState.wasMultiple=!!c.multiple;var re=c.value;re!=null?_e(o,!!c.multiple,re,!1):H!==!!c.multiple&&(c.defaultValue!=null?_e(o,!!c.multiple,c.defaultValue,!0):_e(o,!!c.multiple,c.multiple?[]:"",!1))}o[Or]=c}catch(le){Ve(e,e.return,le)}}break;case 6:if(Ht(t,e),Xt(e),s&4){if(e.stateNode===null)throw Error(l(162));o=e.stateNode,c=e.memoizedProps;try{o.nodeValue=c}catch(le){Ve(e,e.return,le)}}break;case 3:if(Ht(t,e),Xt(e),s&4&&n!==null&&n.memoizedState.isDehydrated)try{kr(t.containerInfo)}catch(le){Ve(e,e.return,le)}break;case 4:Ht(t,e),Xt(e);break;case 13:Ht(t,e),Xt(e),o=e.child,o.flags&8192&&(c=o.memoizedState!==null,o.stateNode.isHidden=c,!c||o.alternate!==null&&o.alternate.memoizedState!==null||(Vl=$e())),s&4&&Hc(e);break;case 22:if(W=n!==null&&n.memoizedState!==null,e.mode&1?(ut=(O=ut)||W,Ht(t,e),ut=O):Ht(t,e),Xt(e),s&8192){if(O=e.memoizedState!==null,(e.stateNode.isHidden=O)&&!W&&(e.mode&1)!==0)for(se=e,W=e.child;W!==null;){for(Y=se=W;se!==null;){switch(H=se,re=H.child,H.tag){case 0:case 11:case 14:case 15:Vr(4,H,H.return);break;case 1:lr(H,H.return);var oe=H.stateNode;if(typeof oe.componentWillUnmount=="function"){s=H,n=H.return;try{t=s,oe.props=t.memoizedProps,oe.state=t.memoizedState,oe.componentWillUnmount()}catch(le){Ve(s,n,le)}}break;case 5:lr(H,H.return);break;case 22:if(H.memoizedState!==null){Gc(Y);continue}}re!==null?(re.return=H,se=re):Gc(Y)}W=W.sibling}e:for(W=null,Y=e;;){if(Y.tag===5){if(W===null){W=Y;try{o=Y.stateNode,O?(c=o.style,typeof c.setProperty=="function"?c.setProperty("display","none","important"):c.display="none"):(S=Y.stateNode,b=Y.memoizedProps.style,p=b!=null&&b.hasOwnProperty("display")?b.display:null,S.style.display=bi("display",p))}catch(le){Ve(e,e.return,le)}}}else if(Y.tag===6){if(W===null)try{Y.stateNode.nodeValue=O?"":Y.memoizedProps}catch(le){Ve(e,e.return,le)}}else if((Y.tag!==22&&Y.tag!==23||Y.memoizedState===null||Y===e)&&Y.child!==null){Y.child.return=Y,Y=Y.child;continue}if(Y===e)break e;for(;Y.sibling===null;){if(Y.return===null||Y.return===e)break e;W===Y&&(W=null),Y=Y.return}W===Y&&(W=null),Y.sibling.return=Y.return,Y=Y.sibling}}break;case 19:Ht(t,e),Xt(e),s&4&&Hc(e);break;case 21:break;default:Ht(t,e),Xt(e)}}function Xt(e){var t=e.flags;if(t&2){try{e:{for(var n=e.return;n!==null;){if(qc(n)){var s=n;break e}n=n.return}throw Error(l(160))}switch(s.tag){case 5:var o=s.stateNode;s.flags&32&&(dr(o,""),s.flags&=-33);var c=Bc(e);Bl(e,c,o);break;case 3:case 4:var p=s.stateNode.containerInfo,S=Bc(e);ql(e,S,p);break;default:throw Error(l(161))}}catch(b){Ve(e,e.return,b)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function Mf(e,t,n){se=e,Wc(e)}function Wc(e,t,n){for(var s=(e.mode&1)!==0;se!==null;){var o=se,c=o.child;if(o.tag===22&&s){var p=o.memoizedState!==null||Vs;if(!p){var S=o.alternate,b=S!==null&&S.memoizedState!==null||ut;S=Vs;var O=ut;if(Vs=p,(ut=b)&&!O)for(se=o;se!==null;)p=se,b=p.child,p.tag===22&&p.memoizedState!==null?Qc(o):b!==null?(b.return=p,se=b):Qc(o);for(;c!==null;)se=c,Wc(c),c=c.sibling;se=o,Vs=S,ut=O}$c(e)}else(o.subtreeFlags&8772)!==0&&c!==null?(c.return=o,se=c):$c(e)}}function $c(e){for(;se!==null;){var t=se;if((t.flags&8772)!==0){var n=t.alternate;try{if((t.flags&8772)!==0)switch(t.tag){case 0:case 11:case 15:ut||Ws(5,t);break;case 1:var s=t.stateNode;if(t.flags&4&&!ut)if(n===null)s.componentDidMount();else{var o=t.elementType===t.type?n.memoizedProps:Bt(t.type,n.memoizedProps);s.componentDidUpdate(o,n.memoizedState,s.__reactInternalSnapshotBeforeUpdate)}var c=t.updateQueue;c!==null&&Ga(t,c,s);break;case 3:var p=t.updateQueue;if(p!==null){if(n=null,t.child!==null)switch(t.child.tag){case 5:n=t.child.stateNode;break;case 1:n=t.child.stateNode}Ga(t,p,n)}break;case 5:var S=t.stateNode;if(n===null&&t.flags&4){n=S;var b=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":b.autoFocus&&n.focus();break;case"img":b.src&&(n.src=b.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var O=t.alternate;if(O!==null){var W=O.memoizedState;if(W!==null){var Y=W.dehydrated;Y!==null&&kr(Y)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(l(163))}ut||t.flags&512&&Dl(t)}catch(H){Ve(t,t.return,H)}}if(t===e){se=null;break}if(n=t.sibling,n!==null){n.return=t.return,se=n;break}se=t.return}}function Gc(e){for(;se!==null;){var t=se;if(t===e){se=null;break}var n=t.sibling;if(n!==null){n.return=t.return,se=n;break}se=t.return}}function Qc(e){for(;se!==null;){var t=se;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{Ws(4,t)}catch(b){Ve(t,n,b)}break;case 1:var s=t.stateNode;if(typeof s.componentDidMount=="function"){var o=t.return;try{s.componentDidMount()}catch(b){Ve(t,o,b)}}var c=t.return;try{Dl(t)}catch(b){Ve(t,c,b)}break;case 5:var p=t.return;try{Dl(t)}catch(b){Ve(t,p,b)}}}catch(b){Ve(t,t.return,b)}if(t===e){se=null;break}var S=t.sibling;if(S!==null){S.return=t.return,se=S;break}se=t.return}}var bf=Math.ceil,$s=J.ReactCurrentDispatcher,Ul=J.ReactCurrentOwner,Lt=J.ReactCurrentBatchConfig,Le=0,tt=null,Qe=null,ot=0,Et=0,ir=hn(0),Je=0,Wr=null,In=0,Gs=0,Hl=0,$r=null,xt=null,Vl=0,ar=1/0,on=null,Qs=!1,Wl=null,wn=null,Ks=!1,Sn=null,Xs=0,Gr=0,$l=null,Ys=-1,Js=0;function pt(){return(Le&6)!==0?$e():Ys!==-1?Ys:Ys=$e()}function kn(e){return(e.mode&1)===0?1:(Le&2)!==0&&ot!==0?ot&-ot:af.transition!==null?(Js===0&&(Js=Bi()),Js):(e=Re,e!==0||(e=window.event,e=e===void 0?16:Xi(e.type)),e)}function Vt(e,t,n,s){if(50<Gr)throw Gr=0,$l=null,Error(l(185));gr(e,n,s),((Le&2)===0||e!==tt)&&(e===tt&&((Le&2)===0&&(Gs|=n),Je===4&&jn(e,ot)),wt(e,s),n===1&&Le===0&&(t.mode&1)===0&&(ar=$e()+500,Es&&vn()))}function wt(e,t){var n=e.callbackNode;id(e,t);var s=is(e,e===tt?ot:0);if(s===0)n!==null&&zi(n),e.callbackNode=null,e.callbackPriority=0;else if(t=s&-s,e.callbackPriority!==t){if(n!=null&&zi(n),t===1)e.tag===0?lf(Xc.bind(null,e)):Ia(Xc.bind(null,e)),nf(function(){(Le&6)===0&&vn()}),n=null;else{switch(Ui(s)){case 1:n=bo;break;case 4:n=Di;break;case 16:n=rs;break;case 536870912:n=qi;break;default:n=rs}n=su(n,Kc.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function Kc(e,t){if(Ys=-1,Js=0,(Le&6)!==0)throw Error(l(327));var n=e.callbackNode;if(cr()&&e.callbackNode!==n)return null;var s=is(e,e===tt?ot:0);if(s===0)return null;if((s&30)!==0||(s&e.expiredLanes)!==0||t)t=Zs(e,s);else{t=s;var o=Le;Le|=2;var c=Jc();(tt!==e||ot!==t)&&(on=null,ar=$e()+500,Fn(e,t));do try{Nf();break}catch(S){Yc(e,S)}while(!0);ul(),$s.current=c,Le=o,Qe!==null?t=0:(tt=null,ot=0,t=Je)}if(t!==0){if(t===2&&(o=Eo(e),o!==0&&(s=o,t=Gl(e,o))),t===1)throw n=Wr,Fn(e,0),jn(e,s),wt(e,$e()),n;if(t===6)jn(e,s);else{if(o=e.current.alternate,(s&30)===0&&!Ef(o)&&(t=Zs(e,s),t===2&&(c=Eo(e),c!==0&&(s=c,t=Gl(e,c))),t===1))throw n=Wr,Fn(e,0),jn(e,s),wt(e,$e()),n;switch(e.finishedWork=o,e.finishedLanes=s,t){case 0:case 1:throw Error(l(345));case 2:zn(e,xt,on);break;case 3:if(jn(e,s),(s&130023424)===s&&(t=Vl+500-$e(),10<t)){if(is(e,0)!==0)break;if(o=e.suspendedLanes,(o&s)!==s){pt(),e.pingedLanes|=e.suspendedLanes&o;break}e.timeoutHandle=Zo(zn.bind(null,e,xt,on),t);break}zn(e,xt,on);break;case 4:if(jn(e,s),(s&4194240)===s)break;for(t=e.eventTimes,o=-1;0<s;){var p=31-zt(s);c=1<<p,p=t[p],p>o&&(o=p),s&=~c}if(s=o,s=$e()-s,s=(120>s?120:480>s?480:1080>s?1080:1920>s?1920:3e3>s?3e3:4320>s?4320:1960*bf(s/1960))-s,10<s){e.timeoutHandle=Zo(zn.bind(null,e,xt,on),s);break}zn(e,xt,on);break;case 5:zn(e,xt,on);break;default:throw Error(l(329))}}}return wt(e,$e()),e.callbackNode===n?Kc.bind(null,e):null}function Gl(e,t){var n=$r;return e.current.memoizedState.isDehydrated&&(Fn(e,t).flags|=256),e=Zs(e,t),e!==2&&(t=xt,xt=n,t!==null&&Ql(t)),e}function Ql(e){xt===null?xt=e:xt.push.apply(xt,e)}function Ef(e){for(var t=e;;){if(t.flags&16384){var n=t.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var s=0;s<n.length;s++){var o=n[s],c=o.getSnapshot;o=o.value;try{if(!Dt(c(),o))return!1}catch{return!1}}}if(n=t.child,t.subtreeFlags&16384&&n!==null)n.return=t,t=n;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function jn(e,t){for(t&=~Hl,t&=~Gs,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-zt(t),s=1<<n;e[n]=-1,t&=~s}}function Xc(e){if((Le&6)!==0)throw Error(l(327));cr();var t=is(e,0);if((t&1)===0)return wt(e,$e()),null;var n=Zs(e,t);if(e.tag!==0&&n===2){var s=Eo(e);s!==0&&(t=s,n=Gl(e,s))}if(n===1)throw n=Wr,Fn(e,0),jn(e,t),wt(e,$e()),n;if(n===6)throw Error(l(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,zn(e,xt,on),wt(e,$e()),null}function Kl(e,t){var n=Le;Le|=1;try{return e(t)}finally{Le=n,Le===0&&(ar=$e()+500,Es&&vn())}}function An(e){Sn!==null&&Sn.tag===0&&(Le&6)===0&&cr();var t=Le;Le|=1;var n=Lt.transition,s=Re;try{if(Lt.transition=null,Re=1,e)return e()}finally{Re=s,Lt.transition=n,Le=t,(Le&6)===0&&vn()}}function Xl(){Et=ir.current,ze(ir)}function Fn(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(n!==-1&&(e.timeoutHandle=-1,tf(n)),Qe!==null)for(n=Qe.return;n!==null;){var s=n;switch(ol(s),s.tag){case 1:s=s.type.childContextTypes,s!=null&&Ms();break;case 3:sr(),ze(vt),ze(it),yl();break;case 5:vl(s);break;case 4:sr();break;case 13:ze(Ue);break;case 19:ze(Ue);break;case 10:dl(s.type._context);break;case 22:case 23:Xl()}n=n.return}if(tt=e,Qe=e=Mn(e.current,null),ot=Et=t,Je=0,Wr=null,Hl=Gs=In=0,xt=$r=null,Ln!==null){for(t=0;t<Ln.length;t++)if(n=Ln[t],s=n.interleaved,s!==null){n.interleaved=null;var o=s.next,c=n.pending;if(c!==null){var p=c.next;c.next=o,s.next=p}n.pending=s}Ln=null}return e}function Yc(e,t){do{var n=Qe;try{if(ul(),As.current=qs,Fs){for(var s=He.memoizedState;s!==null;){var o=s.queue;o!==null&&(o.pending=null),s=s.next}Fs=!1}if(Rn=0,et=Ye=He=null,Dr=!1,qr=0,Ul.current=null,n===null||n.return===null){Je=1,Wr=t,Qe=null;break}e:{var c=e,p=n.return,S=n,b=t;if(t=ot,S.flags|=32768,b!==null&&typeof b=="object"&&typeof b.then=="function"){var O=b,W=S,Y=W.tag;if((W.mode&1)===0&&(Y===0||Y===11||Y===15)){var H=W.alternate;H?(W.updateQueue=H.updateQueue,W.memoizedState=H.memoizedState,W.lanes=H.lanes):(W.updateQueue=null,W.memoizedState=null)}var re=kc(p);if(re!==null){re.flags&=-257,jc(re,p,S,c,t),re.mode&1&&Sc(c,O,t),t=re,b=O;var oe=t.updateQueue;if(oe===null){var le=new Set;le.add(b),t.updateQueue=le}else oe.add(b);break e}else{if((t&1)===0){Sc(c,O,t),Yl();break e}b=Error(l(426))}}else if(De&&S.mode&1){var Ge=kc(p);if(Ge!==null){(Ge.flags&65536)===0&&(Ge.flags|=256),jc(Ge,p,S,c,t),al(or(b,S));break e}}c=b=or(b,S),Je!==4&&(Je=2),$r===null?$r=[c]:$r.push(c),c=p;do{switch(c.tag){case 3:c.flags|=65536,t&=-t,c.lanes|=t;var T=xc(c,b,t);$a(c,T);break e;case 1:S=b;var C=c.type,L=c.stateNode;if((c.flags&128)===0&&(typeof C.getDerivedStateFromError=="function"||L!==null&&typeof L.componentDidCatch=="function"&&(wn===null||!wn.has(L)))){c.flags|=65536,t&=-t,c.lanes|=t;var ee=wc(c,S,t);$a(c,ee);break e}}c=c.return}while(c!==null)}eu(n)}catch(ie){t=ie,Qe===n&&n!==null&&(Qe=n=n.return);continue}break}while(!0)}function Jc(){var e=$s.current;return $s.current=qs,e===null?qs:e}function Yl(){(Je===0||Je===3||Je===2)&&(Je=4),tt===null||(In&268435455)===0&&(Gs&268435455)===0||jn(tt,ot)}function Zs(e,t){var n=Le;Le|=2;var s=Jc();(tt!==e||ot!==t)&&(on=null,Fn(e,t));do try{Cf();break}catch(o){Yc(e,o)}while(!0);if(ul(),Le=n,$s.current=s,Qe!==null)throw Error(l(261));return tt=null,ot=0,Je}function Cf(){for(;Qe!==null;)Zc(Qe)}function Nf(){for(;Qe!==null&&!Ju();)Zc(Qe)}function Zc(e){var t=ru(e.alternate,e,Et);e.memoizedProps=e.pendingProps,t===null?eu(e):Qe=t,Ul.current=null}function eu(e){var t=e;do{var n=t.alternate;if(e=t.return,(t.flags&32768)===0){if(n=wf(n,t,Et),n!==null){Qe=n;return}}else{if(n=Sf(n,t),n!==null){n.flags&=32767,Qe=n;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{Je=6,Qe=null;return}}if(t=t.sibling,t!==null){Qe=t;return}Qe=t=e}while(t!==null);Je===0&&(Je=5)}function zn(e,t,n){var s=Re,o=Lt.transition;try{Lt.transition=null,Re=1,Pf(e,t,n,s)}finally{Lt.transition=o,Re=s}return null}function Pf(e,t,n,s){do cr();while(Sn!==null);if((Le&6)!==0)throw Error(l(327));n=e.finishedWork;var o=e.finishedLanes;if(n===null)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(l(177));e.callbackNode=null,e.callbackPriority=0;var c=n.lanes|n.childLanes;if(ad(e,c),e===tt&&(Qe=tt=null,ot=0),(n.subtreeFlags&2064)===0&&(n.flags&2064)===0||Ks||(Ks=!0,su(rs,function(){return cr(),null})),c=(n.flags&15990)!==0,(n.subtreeFlags&15990)!==0||c){c=Lt.transition,Lt.transition=null;var p=Re;Re=1;var S=Le;Le|=4,Ul.current=null,jf(e,n),Vc(n,e),Qd(Yo),us=!!Xo,Yo=Xo=null,e.current=n,Mf(n),Zu(),Le=S,Re=p,Lt.transition=c}else e.current=n;if(Ks&&(Ks=!1,Sn=e,Xs=o),c=e.pendingLanes,c===0&&(wn=null),nd(n.stateNode),wt(e,$e()),t!==null)for(s=e.onRecoverableError,n=0;n<t.length;n++)o=t[n],s(o.value,{componentStack:o.stack,digest:o.digest});if(Qs)throw Qs=!1,e=Wl,Wl=null,e;return(Xs&1)!==0&&e.tag!==0&&cr(),c=e.pendingLanes,(c&1)!==0?e===$l?Gr++:(Gr=0,$l=e):Gr=0,vn(),null}function cr(){if(Sn!==null){var e=Ui(Xs),t=Lt.transition,n=Re;try{if(Lt.transition=null,Re=16>e?16:e,Sn===null)var s=!1;else{if(e=Sn,Sn=null,Xs=0,(Le&6)!==0)throw Error(l(331));var o=Le;for(Le|=4,se=e.current;se!==null;){var c=se,p=c.child;if((se.flags&16)!==0){var S=c.deletions;if(S!==null){for(var b=0;b<S.length;b++){var O=S[b];for(se=O;se!==null;){var W=se;switch(W.tag){case 0:case 11:case 15:Vr(8,W,c)}var Y=W.child;if(Y!==null)Y.return=W,se=Y;else for(;se!==null;){W=se;var H=W.sibling,re=W.return;if(Dc(W),W===O){se=null;break}if(H!==null){H.return=re,se=H;break}se=re}}}var oe=c.alternate;if(oe!==null){var le=oe.child;if(le!==null){oe.child=null;do{var Ge=le.sibling;le.sibling=null,le=Ge}while(le!==null)}}se=c}}if((c.subtreeFlags&2064)!==0&&p!==null)p.return=c,se=p;else e:for(;se!==null;){if(c=se,(c.flags&2048)!==0)switch(c.tag){case 0:case 11:case 15:Vr(9,c,c.return)}var T=c.sibling;if(T!==null){T.return=c.return,se=T;break e}se=c.return}}var C=e.current;for(se=C;se!==null;){p=se;var L=p.child;if((p.subtreeFlags&2064)!==0&&L!==null)L.return=p,se=L;else e:for(p=C;se!==null;){if(S=se,(S.flags&2048)!==0)try{switch(S.tag){case 0:case 11:case 15:Ws(9,S)}}catch(ie){Ve(S,S.return,ie)}if(S===p){se=null;break e}var ee=S.sibling;if(ee!==null){ee.return=S.return,se=ee;break e}se=S.return}}if(Le=o,vn(),$t&&typeof $t.onPostCommitFiberRoot=="function")try{$t.onPostCommitFiberRoot(ss,e)}catch{}s=!0}return s}finally{Re=n,Lt.transition=t}}return!1}function tu(e,t,n){t=or(n,t),t=xc(e,t,1),e=yn(e,t,1),t=pt(),e!==null&&(gr(e,1,t),wt(e,t))}function Ve(e,t,n){if(e.tag===3)tu(e,e,n);else for(;t!==null;){if(t.tag===3){tu(t,e,n);break}else if(t.tag===1){var s=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof s.componentDidCatch=="function"&&(wn===null||!wn.has(s))){e=or(n,e),e=wc(t,e,1),t=yn(t,e,1),e=pt(),t!==null&&(gr(t,1,e),wt(t,e));break}}t=t.return}}function Tf(e,t,n){var s=e.pingCache;s!==null&&s.delete(t),t=pt(),e.pingedLanes|=e.suspendedLanes&n,tt===e&&(ot&n)===n&&(Je===4||Je===3&&(ot&130023424)===ot&&500>$e()-Vl?Fn(e,0):Hl|=n),wt(e,t)}function nu(e,t){t===0&&((e.mode&1)===0?t=1:(t=ls,ls<<=1,(ls&130023424)===0&&(ls=4194304)));var n=pt();e=nn(e,t),e!==null&&(gr(e,t,n),wt(e,n))}function _f(e){var t=e.memoizedState,n=0;t!==null&&(n=t.retryLane),nu(e,n)}function Lf(e,t){var n=0;switch(e.tag){case 13:var s=e.stateNode,o=e.memoizedState;o!==null&&(n=o.retryLane);break;case 19:s=e.stateNode;break;default:throw Error(l(314))}s!==null&&s.delete(t),nu(e,n)}var ru;ru=function(e,t,n){if(e!==null)if(e.memoizedProps!==t.pendingProps||vt.current)yt=!0;else{if((e.lanes&n)===0&&(t.flags&128)===0)return yt=!1,xf(e,t,n);yt=(e.flags&131072)!==0}else yt=!1,De&&(t.flags&1048576)!==0&&Aa(t,Ns,t.index);switch(t.lanes=0,t.tag){case 2:var s=t.type;Hs(e,t),e=t.pendingProps;var o=Yn(t,it.current);rr(t,n),o=Sl(null,t,s,e,o,n);var c=kl();return t.flags|=1,typeof o=="object"&&o!==null&&typeof o.render=="function"&&o.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,gt(s)?(c=!0,bs(t)):c=!1,t.memoizedState=o.state!==null&&o.state!==void 0?o.state:null,hl(t),o.updater=Bs,t.stateNode=o,o._reactInternals=t,Nl(t,s,e,n),t=Ll(null,t,s,!0,c,n)):(t.tag=0,De&&c&&sl(t),ft(null,t,o,n),t=t.child),t;case 16:s=t.elementType;e:{switch(Hs(e,t),e=t.pendingProps,o=s._init,s=o(s._payload),t.type=s,o=t.tag=Rf(s),e=Bt(s,e),o){case 0:t=_l(null,t,s,e,n);break e;case 1:t=Pc(null,t,s,e,n);break e;case 11:t=Mc(null,t,s,e,n);break e;case 14:t=bc(null,t,s,Bt(s.type,e),n);break e}throw Error(l(306,s,""))}return t;case 0:return s=t.type,o=t.pendingProps,o=t.elementType===s?o:Bt(s,o),_l(e,t,s,o,n);case 1:return s=t.type,o=t.pendingProps,o=t.elementType===s?o:Bt(s,o),Pc(e,t,s,o,n);case 3:e:{if(Tc(t),e===null)throw Error(l(387));s=t.pendingProps,c=t.memoizedState,o=c.element,Wa(e,t),Rs(t,s,null,n);var p=t.memoizedState;if(s=p.element,c.isDehydrated)if(c={element:s,isDehydrated:!1,cache:p.cache,pendingSuspenseBoundaries:p.pendingSuspenseBoundaries,transitions:p.transitions},t.updateQueue.baseState=c,t.memoizedState=c,t.flags&256){o=or(Error(l(423)),t),t=_c(e,t,s,n,o);break e}else if(s!==o){o=or(Error(l(424)),t),t=_c(e,t,s,n,o);break e}else for(bt=pn(t.stateNode.containerInfo.firstChild),Mt=t,De=!0,qt=null,n=Ha(t,null,s,n),t.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(er(),s===o){t=sn(e,t,n);break e}ft(e,t,s,n)}t=t.child}return t;case 5:return Qa(t),e===null&&il(t),s=t.type,o=t.pendingProps,c=e!==null?e.memoizedProps:null,p=o.children,Jo(s,o)?p=null:c!==null&&Jo(s,c)&&(t.flags|=32),Nc(e,t),ft(e,t,p,n),t.child;case 6:return e===null&&il(t),null;case 13:return Lc(e,t,n);case 4:return ml(t,t.stateNode.containerInfo),s=t.pendingProps,e===null?t.child=tr(t,null,s,n):ft(e,t,s,n),t.child;case 11:return s=t.type,o=t.pendingProps,o=t.elementType===s?o:Bt(s,o),Mc(e,t,s,o,n);case 7:return ft(e,t,t.pendingProps,n),t.child;case 8:return ft(e,t,t.pendingProps.children,n),t.child;case 12:return ft(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(s=t.type._context,o=t.pendingProps,c=t.memoizedProps,p=o.value,Ae(_s,s._currentValue),s._currentValue=p,c!==null)if(Dt(c.value,p)){if(c.children===o.children&&!vt.current){t=sn(e,t,n);break e}}else for(c=t.child,c!==null&&(c.return=t);c!==null;){var S=c.dependencies;if(S!==null){p=c.child;for(var b=S.firstContext;b!==null;){if(b.context===s){if(c.tag===1){b=rn(-1,n&-n),b.tag=2;var O=c.updateQueue;if(O!==null){O=O.shared;var W=O.pending;W===null?b.next=b:(b.next=W.next,W.next=b),O.pending=b}}c.lanes|=n,b=c.alternate,b!==null&&(b.lanes|=n),fl(c.return,n,t),S.lanes|=n;break}b=b.next}}else if(c.tag===10)p=c.type===t.type?null:c.child;else if(c.tag===18){if(p=c.return,p===null)throw Error(l(341));p.lanes|=n,S=p.alternate,S!==null&&(S.lanes|=n),fl(p,n,t),p=c.sibling}else p=c.child;if(p!==null)p.return=c;else for(p=c;p!==null;){if(p===t){p=null;break}if(c=p.sibling,c!==null){c.return=p.return,p=c;break}p=p.return}c=p}ft(e,t,o.children,n),t=t.child}return t;case 9:return o=t.type,s=t.pendingProps.children,rr(t,n),o=Tt(o),s=s(o),t.flags|=1,ft(e,t,s,n),t.child;case 14:return s=t.type,o=Bt(s,t.pendingProps),o=Bt(s.type,o),bc(e,t,s,o,n);case 15:return Ec(e,t,t.type,t.pendingProps,n);case 17:return s=t.type,o=t.pendingProps,o=t.elementType===s?o:Bt(s,o),Hs(e,t),t.tag=1,gt(s)?(e=!0,bs(t)):e=!1,rr(t,n),gc(t,s,o),Nl(t,s,o,n),Ll(null,t,s,!0,e,n);case 19:return Rc(e,t,n);case 22:return Cc(e,t,n)}throw Error(l(156,t.tag))};function su(e,t){return Fi(e,t)}function Of(e,t,n,s){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=s,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ot(e,t,n,s){return new Of(e,t,n,s)}function Jl(e){return e=e.prototype,!(!e||!e.isReactComponent)}function Rf(e){if(typeof e=="function")return Jl(e)?1:0;if(e!=null){if(e=e.$$typeof,e===he)return 11;if(e===Z)return 14}return 2}function Mn(e,t){var n=e.alternate;return n===null?(n=Ot(e.tag,t,e.key,e.mode),n.elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=e.flags&14680064,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function eo(e,t,n,s,o,c){var p=2;if(s=e,typeof e=="function")Jl(e)&&(p=1);else if(typeof e=="string")p=5;else e:switch(e){case A:return Dn(n.children,o,c,t);case z:p=8,o|=8;break;case $:return e=Ot(12,n,t,o|2),e.elementType=$,e.lanes=c,e;case te:return e=Ot(13,n,t,o),e.elementType=te,e.lanes=c,e;case ce:return e=Ot(19,n,t,o),e.elementType=ce,e.lanes=c,e;case D:return to(n,o,c,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case pe:p=10;break e;case Ce:p=9;break e;case he:p=11;break e;case Z:p=14;break e;case B:p=16,s=null;break e}throw Error(l(130,e==null?e:typeof e,""))}return t=Ot(p,n,t,o),t.elementType=e,t.type=s,t.lanes=c,t}function Dn(e,t,n,s){return e=Ot(7,e,s,t),e.lanes=n,e}function to(e,t,n,s){return e=Ot(22,e,s,t),e.elementType=D,e.lanes=n,e.stateNode={isHidden:!1},e}function Zl(e,t,n){return e=Ot(6,e,null,t),e.lanes=n,e}function ei(e,t,n){return t=Ot(4,e.children!==null?e.children:[],e.key,t),t.lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function If(e,t,n,s,o){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Co(0),this.expirationTimes=Co(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Co(0),this.identifierPrefix=s,this.onRecoverableError=o,this.mutableSourceEagerHydrationData=null}function ti(e,t,n,s,o,c,p,S,b){return e=new If(e,t,n,S,b),t===1?(t=1,c===!0&&(t|=8)):t=0,c=Ot(3,null,null,t),e.current=c,c.stateNode=e,c.memoizedState={element:s,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},hl(c),e}function Af(e,t,n){var s=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:E,key:s==null?null:""+s,children:e,containerInfo:t,implementation:n}}function ou(e){if(!e)return mn;e=e._reactInternals;e:{if(Cn(e)!==e||e.tag!==1)throw Error(l(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(gt(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(l(171))}if(e.tag===1){var n=e.type;if(gt(n))return Oa(e,n,t)}return t}function lu(e,t,n,s,o,c,p,S,b){return e=ti(n,s,!0,e,o,c,p,S,b),e.context=ou(null),n=e.current,s=pt(),o=kn(n),c=rn(s,o),c.callback=t??null,yn(n,c,o),e.current.lanes=o,gr(e,o,s),wt(e,s),e}function no(e,t,n,s){var o=t.current,c=pt(),p=kn(o);return n=ou(n),t.context===null?t.context=n:t.pendingContext=n,t=rn(c,p),t.payload={element:e},s=s===void 0?null:s,s!==null&&(t.callback=s),e=yn(o,t,p),e!==null&&(Vt(e,o,p,c),Os(e,o,p)),p}function ro(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function iu(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var n=e.retryLane;e.retryLane=n!==0&&n<t?n:t}}function ni(e,t){iu(e,t),(e=e.alternate)&&iu(e,t)}function Ff(){return null}var au=typeof reportError=="function"?reportError:function(e){console.error(e)};function ri(e){this._internalRoot=e}so.prototype.render=ri.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(l(409));no(e,t,null,null)},so.prototype.unmount=ri.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;An(function(){no(null,e,null,null)}),t[Jt]=null}};function so(e){this._internalRoot=e}so.prototype.unstable_scheduleHydration=function(e){if(e){var t=Wi();e={blockedOn:null,target:e,priority:t};for(var n=0;n<un.length&&t!==0&&t<un[n].priority;n++);un.splice(n,0,e),n===0&&Qi(e)}};function si(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function oo(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function cu(){}function zf(e,t,n,s,o){if(o){if(typeof s=="function"){var c=s;s=function(){var O=ro(p);c.call(O)}}var p=lu(t,s,e,0,null,!1,!1,"",cu);return e._reactRootContainer=p,e[Jt]=p.current,_r(e.nodeType===8?e.parentNode:e),An(),p}for(;o=e.lastChild;)e.removeChild(o);if(typeof s=="function"){var S=s;s=function(){var O=ro(b);S.call(O)}}var b=ti(e,0,!1,null,null,!1,!1,"",cu);return e._reactRootContainer=b,e[Jt]=b.current,_r(e.nodeType===8?e.parentNode:e),An(function(){no(t,b,n,s)}),b}function lo(e,t,n,s,o){var c=n._reactRootContainer;if(c){var p=c;if(typeof o=="function"){var S=o;o=function(){var b=ro(p);S.call(b)}}no(t,p,e,o)}else p=zf(n,t,e,o,s);return ro(p)}Hi=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=vr(t.pendingLanes);n!==0&&(No(t,n|1),wt(t,$e()),(Le&6)===0&&(ar=$e()+500,vn()))}break;case 13:An(function(){var s=nn(e,1);if(s!==null){var o=pt();Vt(s,e,1,o)}}),ni(e,1)}},Po=function(e){if(e.tag===13){var t=nn(e,134217728);if(t!==null){var n=pt();Vt(t,e,134217728,n)}ni(e,134217728)}},Vi=function(e){if(e.tag===13){var t=kn(e),n=nn(e,t);if(n!==null){var s=pt();Vt(n,e,t,s)}ni(e,t)}},Wi=function(){return Re},$i=function(e,t){var n=Re;try{return Re=e,t()}finally{Re=n}},So=function(e,t,n){switch(t){case"input":if(me(e,n),t=n.name,n.type==="radio"&&t!=null){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var s=n[t];if(s!==e&&s.form===e.form){var o=js(s);if(!o)throw Error(l(90));We(s),me(s,o)}}}break;case"textarea":Ee(e,n);break;case"select":t=n.value,t!=null&&_e(e,!!n.multiple,t,!1)}},Ti=Kl,_i=An;var Df={usingClientEntryPoint:!1,Events:[Rr,Kn,js,Ni,Pi,Kl]},Qr={findFiberByHostInstance:Nn,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},qf={bundleType:Qr.bundleType,version:Qr.version,rendererPackageName:Qr.rendererPackageName,rendererConfig:Qr.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:J.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=Ii(e),e===null?null:e.stateNode},findFiberByHostInstance:Qr.findFiberByHostInstance||Ff,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var io=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!io.isDisabled&&io.supportsFiber)try{ss=io.inject(qf),$t=io}catch{}}return St.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Df,St.createPortal=function(e,t){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!si(t))throw Error(l(200));return Af(e,t,null,n)},St.createRoot=function(e,t){if(!si(e))throw Error(l(299));var n=!1,s="",o=au;return t!=null&&(t.unstable_strictMode===!0&&(n=!0),t.identifierPrefix!==void 0&&(s=t.identifierPrefix),t.onRecoverableError!==void 0&&(o=t.onRecoverableError)),t=ti(e,1,!1,null,null,n,!1,s,o),e[Jt]=t.current,_r(e.nodeType===8?e.parentNode:e),new ri(t)},St.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(l(188)):(e=Object.keys(e).join(","),Error(l(268,e)));return e=Ii(t),e=e===null?null:e.stateNode,e},St.flushSync=function(e){return An(e)},St.hydrate=function(e,t,n){if(!oo(t))throw Error(l(200));return lo(null,e,t,!0,n)},St.hydrateRoot=function(e,t,n){if(!si(e))throw Error(l(405));var s=n!=null&&n.hydratedSources||null,o=!1,c="",p=au;if(n!=null&&(n.unstable_strictMode===!0&&(o=!0),n.identifierPrefix!==void 0&&(c=n.identifierPrefix),n.onRecoverableError!==void 0&&(p=n.onRecoverableError)),t=lu(t,null,e,1,n??null,o,!1,c,p),e[Jt]=t.current,_r(e),s)for(e=0;e<s.length;e++)n=s[e],o=n._getVersion,o=o(n._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[n,o]:t.mutableSourceEagerHydrationData.push(n,o);return new so(t)},St.render=function(e,t,n){if(!oo(t))throw Error(l(200));return lo(null,e,t,!1,n)},St.unmountComponentAtNode=function(e){if(!oo(e))throw Error(l(40));return e._reactRootContainer?(An(function(){lo(null,null,e,!1,function(){e._reactRootContainer=null,e[Jt]=null})}),!0):!1},St.unstable_batchedUpdates=Kl,St.unstable_renderSubtreeIntoContainer=function(e,t,n,s){if(!oo(n))throw Error(l(200));if(e==null||e._reactInternals===void 0)throw Error(l(38));return lo(e,t,n,!1,s)},St.version="18.3.1-next-f1338f8080-20240426",St}var gu;function Qf(){if(gu)return ii.exports;gu=1;function r(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(r)}catch(a){console.error(a)}}return r(),ii.exports=Gf(),ii.exports}var yu;function Kf(){if(yu)return ao;yu=1;var r=Qf();return ao.createRoot=r.createRoot,ao.hydrateRoot=r.hydrateRoot,ao}var Xf=Kf(),Q=es();const qe=qu(Q),Jr=Math.PI*2,xu=(r,a,l)=>r<a?a:r>l?l:r,Yf=r=>{let a=1;for(;a<r;)a<<=1;return a},Jf=r=>{const a=new Uint32Array(r);let l=0;for(;1<<l<r;)l++;for(let u=0;u<r;u++){let d=0,f=u;for(let h=0;h<l;h++)d=d<<1|f&1,f>>=1;a[u]=d}return a},Zf=r=>{const a=new Float32Array(r),l=Jr/(r-1);for(let u=0;u<r;u++)a[u]=.5*(1-Math.cos(l*u));return a};class ep{size;permutation;twiddleReal;twiddleImag;constructor(a){this.size=a,this.permutation=Jf(a),this.twiddleReal=[],this.twiddleImag=[];for(let l=2;l<=a;l<<=1){const u=l>>1,d=Jr/l,f=new Float32Array(u),h=new Float32Array(u);for(let x=0;x<u;x++)f[x]=Math.cos(d*x),h[x]=Math.sin(d*x);this.twiddleReal.push(f),this.twiddleImag.push(h)}}fft(a,l,u){const{size:d,permutation:f,twiddleReal:h,twiddleImag:x}=this;for(let v=0;v<d;v++){const g=f[v];if(g>v){const w=a[v],k=l[v];a[v]=a[g],l[v]=l[g],a[g]=w,l[g]=k}}let m=0;for(let v=2;v<=d;v<<=1){const g=v>>1,w=h[m],k=x[m];for(let M=0;M<d;M+=v)for(let y=0;y<g;y++){const j=M+y,N=j+g,_=w[y],R=u?-k[y]:k[y],X=a[N],J=l[N],V=_*X-R*J,E=_*J+R*X,A=a[j],z=l[j];a[N]=A-V,l[N]=z-E,a[j]=A+V,l[j]=z+E}m++}if(u){const v=1/d;for(let g=0;g<d;g++)a[g]*=v,l[g]*=v}}}const tp=2048,np=512,rp=(r,a,l)=>r<=0?0:r<=a?1:Math.ceil((r-a)/l)+1,sp=r=>((r>Math.PI||r<-Math.PI)&&(r-=Jr*Math.round(r/Jr)),r),op=r=>{const{channels:a,pitchRatio:l}=r,u=Yf(xu(r.windowSize??tp,256,8192)),d=xu(r.hopSize??np,1,u>>1);if(!a.length)return[];const f=Number.isFinite(l)&&l>0?l:1;if(Math.abs(f-1)<1e-6)return a.map(A=>new Float32Array(A));const h=a[0].length;if(h===0)return a.map(()=>new Float32Array(0));const x=Zf(u),m=new ep(u),v=(u>>1)+1,g=rp(h,u,d),w=h+u,k=a.map(()=>new Float32Array(w)),M=new Float32Array(w),y=new Float32Array(u),j=new Float32Array(u),N=new Float32Array(u),_=new Float32Array(u),R=new Float32Array(v),X=new Float32Array(v),J=a.map(()=>new Float32Array(v)),V=a.map(()=>new Float32Array(v));for(let A=0;A<g;A++){const z=A*d;for(let $=0;$<a.length;$++){const pe=a[$];y.fill(0),j.fill(0);for(let te=0;te<u;te++){const ce=z+te,Z=ce<h?pe[ce]:0;y[te]=Z*x[te]}m.fft(y,j,!1);const Ce=J[$],he=V[$];for(let te=0;te<v;te++){const ce=y[te],Z=j[te],B=Math.hypot(ce,Z),D=Math.atan2(Z,ce),F=Jr*d*te/u,U=sp(D-Ce[te]-F),G=F+U;R[te]=B,X[te]=G,Ce[te]=D}N.fill(0),_.fill(0);for(let te=0;te<v;te++){const ce=te/f;let Z=0,B=0;if(ce<=0)Z=R[0],B=X[0]*f;else if(ce>=v-1){const G=v-1;Z=R[G],B=X[G]*f}else{const G=Math.floor(ce),P=G+1,q=ce-G,xe=R[G],ge=R[P],ke=X[G],ue=X[P];Z=xe+q*(ge-xe),B=(ke+q*(ue-ke))*f}he[te]+=B;const D=he[te],F=Z*Math.cos(D),U=Z*Math.sin(D);if(N[te]=F,_[te]=U,te>0&&te<v-1){const G=u-te;N[G]=F,_[G]=-U}}_[0]=0,_[v-1]=0,m.fft(N,_,!0);for(let te=0;te<u;te++){const ce=z+te;if(ce>=w)break;const Z=x[te];k[$][ce]+=N[te]*Z,$===0&&(M[ce]+=Z*Z)}}}return k.map(A=>{const z=A.subarray(0,h);for(let $=0;$<z.length;$++){const pe=M[$];pe>1e-6&&(z[$]/=pe)}return Float32Array.from(z)})},It={model:"va",harmonics:.6,timbre:.5,morph:.5,level:1},kt={id:null,name:"Empty",dataUrl:null,rootMidi:60,loop:!0,recordedAt:void 0,durationSec:0,trimStartSec:0,trimEndSec:0},wu=r=>({...r,mode:r.mode??"analog",macro:{...It,...r.macro??{}},sampler:{...kt,...r.sampler??{}}}),I={osc1:{wave:"sawtooth",detune:0,detuneFine:0,octave:0,mode:"analog",macro:{...It},sampler:{...kt}},osc2:{wave:"square",detune:0,detuneFine:0,octave:0,mode:"analog",macro:{...It},sampler:{...kt}},mix:0,fm:{enabled:!1,ratio:2,amount:0},sub:{enabled:!1,octave:1,level:0,wave:"square"},ring:{enabled:!1,amount:1},filter:{type:"lowpass",cutoff:1200,q:.8},envelope:{attack:.01,decay:.2,sustain:.7,release:.3},master:{gain:.2},sampler:{...kt},engineMode:"classic",macro:{...It},effects:{delay:{enabled:!1,time:.25,feedback:.3,mix:.2},reverb:{enabled:!1,size:.5,decay:.5,mix:.25}},lfo1:{enabled:!1,wave:"sine",rateHz:5,amount:.2,dest:"pitch"},lfo2:{enabled:!1,wave:"triangle",rateHz:.5,amount:.4,dest:"filter"},arp:{enabled:!1,rateHz:8,bpmSync:!1,bpm:120,division:"1/8",gate:.6,chordSource:"preset",mode:"up",octaves:1,chord:"none",latch:!1,swingPct:0,repeats:1,patternLen:0},sequencer:{enabled:!1,playing:!1,bpm:120,division:"1/16",swingPct:0,gate:.6,rootMidi:60,length:16,steps:Array.from({length:16},()=>({on:!1,offset:0,velocity:1}))},expression:{x:"osc1.detune",y:"filter.cutoff"},modMatrix:[]},lt=(r,a)=>Number.isFinite(r)?r:a,Rt=r=>{const a=r;if(!a._managedLifecycleAttached){a._managedLifecycleAttached=!0;const l=()=>{a._started=!1};if(typeof a.addEventListener=="function")a.addEventListener("ended",l);else{const u=a.onended;a.onended=d=>{l(),typeof u=="function"&&u.call(a,d)}}}return a._started==null&&(a._started=!!a._autoStarted),a},Su=r=>{const a=Rt(r);a._started=!0},lp=r=>{const a=Rt(r);a._autoStarted=!0,a._started=!0},ip=r=>r==="lfo1"||r==="lfo2",ap=r=>r==="filter.cutoff"||r==="filter.q"||r==="master.gain"||r==="mix",cp=r=>r==="exprX"||r==="exprY"||r==="seqStep"||r==="velocity"||r==="gate",co=(r,a)=>r.patch[a]??I[a],uo=r=>r.patch.macro??I.macro,ht={"filter.cutoff":{getBase:r=>lt(r.patch.filter.cutoff,I.filter.cutoff),range:(r,a)=>{const l=we(a*.25,80,12e3),u=we(a*4,l+20,14e3);return{min:l,max:u}},apply:(r,a)=>r.applyPatch({filter:{cutoff:a}},{fromExpression:!0})},"filter.q":{getBase:r=>lt(r.patch.filter.q,I.filter.q),range:(r,a)=>{const l=we(a*.5,.1,20),u=we(a*2.5,l+.1,20);return{min:l,max:u}},apply:(r,a)=>r.applyPatch({filter:{q:a}},{fromExpression:!0})},"master.gain":{getBase:r=>lt(r.patch.master.gain,I.master.gain),range:(r,a)=>{const l=we(a*.4,.01,1),u=we(a*1.6,l+.01,1);return{min:l,max:u}},apply:(r,a)=>r.applyPatch({master:{gain:a}},{fromExpression:!0})},mix:{getBase:r=>lt(r.patch.mix,I.mix),range:()=>({min:0,max:1}),apply:(r,a)=>r.applyPatch({mix:we(a,0,1)},{fromExpression:!0})},"osc1.detune":{getBase:r=>lt(r.patch.osc1.detune,I.osc1.detune),range:(r,a)=>{const l=we(a-120,-2400,2400),u=we(a+120,l+1,2400);return{min:l,max:u}},apply:(r,a)=>r.applyPatch({osc1:{detune:a}},{fromExpression:!0})},"osc2.detune":{getBase:r=>lt(r.patch.osc2.detune,I.osc2.detune),range:(r,a)=>{const l=we(a-120,-2400,2400),u=we(a+120,l+1,2400);return{min:l,max:u}},apply:(r,a)=>r.applyPatch({osc2:{detune:a}},{fromExpression:!0})},"fm.amount":{getBase:r=>lt(r.patch.fm.amount,I.fm.amount),range:(r,a)=>{const l=we(a*.5,0,4e3),u=we(Math.max(a+400,400),l+10,4e3);return{min:l,max:u}},apply:(r,a)=>r.applyPatch({fm:{amount:we(a,0,4e3)}},{fromExpression:!0})},"envelope.attack":{getBase:r=>lt(r.patch.envelope.attack,I.envelope.attack),range:(r,a)=>{const l=we(a*.2,.001,4),u=we(a*3,l+.01,4);return{min:l,max:u}},apply:(r,a)=>r.applyPatch({envelope:{attack:a}},{fromExpression:!0})},"envelope.release":{getBase:r=>lt(r.patch.envelope.release,I.envelope.release),range:(r,a)=>{const l=we(a*.5,.03,6),u=we(a*3,l+.05,6);return{min:l,max:u}},apply:(r,a)=>r.applyPatch({envelope:{release:a}},{fromExpression:!0})},"macro.harmonics":{getBase:r=>lt(uo(r).harmonics,I.macro.harmonics),range:()=>({min:0,max:1}),apply:(r,a)=>r.applyPatch({macro:{harmonics:we(a,0,1)}},{fromExpression:!0})},"macro.timbre":{getBase:r=>lt(uo(r).timbre,I.macro.timbre),range:()=>({min:0,max:1}),apply:(r,a)=>r.applyPatch({macro:{timbre:we(a,0,1)}},{fromExpression:!0})},"macro.morph":{getBase:r=>lt(uo(r).morph,I.macro.morph),range:()=>({min:0,max:1}),apply:(r,a)=>r.applyPatch({macro:{morph:we(a,0,1)}},{fromExpression:!0})},"macro.level":{getBase:r=>lt(uo(r).level,I.macro.level),range:()=>({min:0,max:1}),apply:(r,a)=>r.applyPatch({macro:{level:we(a,0,1)}},{fromExpression:!0})},"lfo1.rateHz":{getBase:r=>lt(co(r,"lfo1").rateHz,I.lfo1.rateHz),range:(r,a)=>{const l=we(a*.25,.05,30),u=we(a*4,l+.05,40);return{min:l,max:u}},apply:(r,a)=>r.applyPatch({lfo1:{rateHz:a}},{fromExpression:!0})},"lfo1.amount":{getBase:r=>lt(co(r,"lfo1").amount,I.lfo1.amount),range:()=>({min:0,max:1}),apply:(r,a)=>r.applyPatch({lfo1:{amount:we(a,0,1)}},{fromExpression:!0})},"lfo2.rateHz":{getBase:r=>lt(co(r,"lfo2").rateHz,I.lfo2.rateHz),range:(r,a)=>{const l=we(a*.25,.02,20),u=we(a*4,l+.05,30);return{min:l,max:u}},apply:(r,a)=>r.applyPatch({lfo2:{rateHz:a}},{fromExpression:!0})},"lfo2.amount":{getBase:r=>lt(co(r,"lfo2").amount,I.lfo2.amount),range:()=>({min:0,max:1}),apply:(r,a)=>r.applyPatch({lfo2:{amount:we(a,0,1)}},{fromExpression:!0})}},fo={"filter.cutoff":ht["filter.cutoff"],"filter.q":ht["filter.q"],"master.gain":ht["master.gain"],"macro.harmonics":ht["macro.harmonics"],"macro.timbre":ht["macro.timbre"],"macro.morph":ht["macro.morph"],"macro.level":ht["macro.level"],"fm.amount":ht["fm.amount"],mix:ht.mix,"envelope.attack":ht["envelope.attack"],"envelope.release":ht["envelope.release"]},ui=["x","y"],we=(r,a,l)=>Math.min(l,Math.max(a,r));function ku(r){const a=r.sampleRate*1,l=r.createBuffer(1,a,r.sampleRate),u=l.getChannelData(0);for(let d=0;d<a;d++)u[d]=Math.random()*2-1;return l}class xi{ctx;master;filter;analyser;noiseBuffer;activeVoices=new Map;fxInput;fxOutput;currentFxTap=null;lfos;expression2D={active:!1,x:.5,y:.5};expressionAxisTargets={x:I.expression.x,y:I.expression.y};expressionSnapshot={x:null,y:null};expressionApplying=!1;samplerBuffer=null;samplerMeta={...I.sampler};samplerLoadToken=0;samplerPitchCache=new Map;modMatrixConnections=new Map;controlSourceValues={exprX:0,exprY:0,seqStep:0,velocity:-1,gate:-1};controlModRows=[];controlModSnapshots=new Map;mixAudioAmounts=[0,0];activeNoteVelocities=new Map;patch;arpHeld=new Set;arpIndex=0;arpTimer=null;arpLastNote=null;arpBypass=!1;arpPhase=0;arpRepeatCounter=0;arpCurrentStepMs=0;seqTimer=null;seqPhase=0;seqCurrentStepMs=0;seqStepIndex=0;seqLastNote=null;seqControlToken=0;getModSourceIndex(a){switch(a){case"lfo1":return 0;case"lfo2":return 1;default:return-1}}getModTargetInfo(a){switch(a){case"filter.cutoff":return{param:this.filter.frequency,type:"param",scale:l=>l*2e3};case"filter.q":return{param:this.filter.Q,type:"param",scale:l=>l*5};case"master.gain":return{param:this.master.gain,type:"param",scale:l=>l*.5};default:return null}}getLfoConfig(a){return a==="lfo2"?this.patch.lfo2??I.lfo2:this.patch.lfo1??I.lfo1}removeModConnection(a){const l=this.modMatrixConnections.get(a);if(!l)return;const u=this.lfos[l.sourceIndex]?.gain;if(u)try{u.disconnect(l.tap)}catch{}try{l.tap.disconnect()}catch{}this.modMatrixConnections.delete(a)}applyModMatrix(a=[]){const l=a.filter(h=>h&&h.enabled),u=l.filter(h=>ip(h.source)&&ap(h.target)),d=new Set,f=[0,0];for(const h of u){const x=this.getModSourceIndex(h.source);if(x<0)continue;if(h.target==="mix"){const X=this.lfos[x]?.gain,J=h.source==="lfo2"?"lfo2":"lfo1",V=this.getLfoConfig(J),E=Math.max(0,V.amount??0),A=X?Math.abs(X.gain.value):0,z=A>1e-6?A:E>1e-6?E:1;f[x]+=h.amount/z;continue}const m=this.lfos[x]?.gain;if(!m)continue;const v=this.getModTargetInfo(h.target);if(!v)continue;const g=v.scale(h.amount),w=h.source==="lfo2"?"lfo2":"lfo1",k=this.getLfoConfig(w),M=Math.max(0,k.amount??0),y=Math.abs(m.gain.value),j=y>0?y:M,N=j>0?g/j:0,_=this.modMatrixConnections.get(h.id);_&&(_.sourceIndex!==x||_.target!==h.target)&&this.removeModConnection(h.id);let R=this.modMatrixConnections.get(h.id);if(R)R.tap.gain.setValueAtTime(N,this.ctx.currentTime),R.target=h.target;else{const X=this.ctx.createGain();X.gain.value=N,m.connect(X),X.connect(v.param),R={sourceIndex:x,tap:X,target:h.target},this.modMatrixConnections.set(h.id,R)}d.add(h.id)}for(const[h]of this.modMatrixConnections)d.has(h)||this.removeModConnection(h);this.resetControlTargets(),this.controlModRows=l.filter(h=>cp(h.source)),this.applyControlModMatrix(),this.mixAudioAmounts=[we(f[0],-1,1),we(f[1],-1,1)],this.refreshMixAudioConnections()}refreshMixAudioConnections(){const a=this.ctx.currentTime,l=[this.patch.lfo1??I.lfo1,this.patch.lfo2??I.lfo2],u=Math.min(this.lfos.length,this.mixAudioAmounts.length);for(const d of this.activeVoices.values())if(d.mixControl){d.mixConnections||(d.mixConnections=[]);for(let f=0;f<u;f++){const h=this.mixAudioAmounts[f],m=!!l[f]?.enabled&&Math.abs(h)>1e-4;let v=d.mixConnections.findIndex(g=>g.sourceIndex===f);if(m)if(v===-1){const g=this.ctx.createGain();g.gain.value=h;const w=this.lfos[f]?.gain;if(!w)continue;w.connect(g),g.connect(d.mixControl.offset),d.mixConnections.push({sourceIndex:f,gain:g})}else d.mixConnections[v].gain.gain.setValueAtTime(h,a);else if(v!==-1){const g=d.mixConnections[v],w=this.lfos[g.sourceIndex]?.gain;if(w)try{w.disconnect(g.gain)}catch{}try{g.gain.disconnect()}catch{}d.mixConnections.splice(v,1)}}}}getControlSourceValue(a){return a==="exprX"?this.controlSourceValues.exprX:a==="exprY"?this.controlSourceValues.exprY:a==="seqStep"?this.controlSourceValues.seqStep:a==="velocity"?this.controlSourceValues.velocity:a==="gate"?this.controlSourceValues.gate:0}updateControlSource(a,l){const u=we(l,-1,1);this.controlSourceValues[a]!==u&&(this.controlSourceValues[a]=u,this.applyControlModMatrix())}resetControlTargets(){if(this.controlModSnapshots.size!==0){for(const[a,l]of this.controlModSnapshots){const u=fo[a];u&&u.apply(this,l)}this.controlModSnapshots.clear()}}applyControlModMatrix(){if(this.controlModRows.length===0){this.resetControlTargets();return}const a=new Map;for(const u of this.controlModRows){const d=fo[u.target];if(!d)continue;const f=this.getControlSourceValue(u.source);if(!Number.isFinite(f))continue;let h=a.get(u.target);if(!h){const x=this.controlModSnapshots.get(u.target)??d.getBase(this),m=Number.isFinite(x)?x:0;this.controlModSnapshots.set(u.target,m),h={base:m,sum:0},a.set(u.target,h)}h.sum+=u.amount*f}const l=new Set(a.keys());for(const[u,d]of[...this.controlModSnapshots])if(!l.has(u)){const f=fo[u];f&&f.apply(this,d),this.controlModSnapshots.delete(u)}for(const[u,d]of a){const f=fo[u];if(!f)continue;const{base:h,sum:x}=d,m=f.range(this,h),v=m.max-m.min,g=v>0?x*v:0,w=we(h+g,m.min,m.max);f.apply(this,w)}}refreshVelocitySignals(){if(this.activeNoteVelocities.size===0){this.updateControlSource("velocity",-1),this.updateControlSource("gate",-1);return}let a=0;for(const u of this.activeNoteVelocities.values())a+=u;const l=a/this.activeNoteVelocities.size;this.updateControlSource("velocity",we(l*2-1,-1,1)),this.updateControlSource("gate",1)}constructor(a){this.ctx=a??new(window.AudioContext||window.webkitAudioContext),this.master=this.ctx.createGain(),this.filter=this.ctx.createBiquadFilter(),this.analyser=this.ctx.createAnalyser(),this.fxInput=this.ctx.createGain(),this.fxOutput=this.ctx.createGain(),this.filter.connect(this.fxInput),this.fxInput.connect(this.fxOutput),this.fxOutput.connect(this.master),this.master.connect(this.ctx.destination);try{this.filter.connect(this.analyser)}catch{}this.analyser.smoothingTimeConstant=0,this.lfos=[];for(let l=0;l<2;l++){const u=this.ctx.createOscillator();u.type="sine",u.frequency.value=5;const d=this.ctx.createGain();d.gain.value=0,u.connect(d),u.start(),this.lfos.push({osc:u,noise:null,noiseFilter:null,gain:d,dest:"none",wave:"sine"})}this.patch={...I},this.applyPatch(),this.samplerMeta=this.normalizeSamplerMeta(this.patch.sampler,null)}get audioContext(){return this.ctx}getAnalyser(){return this.analyser}getWaveform(){const a=this.analyser.fftSize,l=new Uint8Array(a);return this.analyser.getByteTimeDomainData(l),l}async resume(){this.ctx.state!=="running"&&await this.ctx.resume()}normalizeSamplerMeta(a,l){const u=l?.duration??(Number.isFinite(a.durationSec)?a.durationSec:0);if(!(u>0))return{...a,durationSec:0,trimStartSec:0,trimEndSec:0};const d=.005,f=Math.max(0,u-d),h=Number(a.trimStartSec),x=we(Number.isFinite(h)?h:0,0,f),m=Number(a.trimEndSec);let v=Number.isFinite(m)?m:u;return v=we(v,x+d,u),v-x<d&&(v=Math.min(u,x+d)),{...a,durationSec:u,trimStartSec:x,trimEndSec:v}}async updateSamplerBuffer(a){const l=this.samplerMeta.id===a.id&&this.samplerMeta.dataUrl===a.dataUrl;if(this.samplerMeta=this.normalizeSamplerMeta({...a},l?this.samplerBuffer:null),!a.dataUrl){this.samplerBuffer=null,this.samplerMeta=this.normalizeSamplerMeta(this.samplerMeta,null),this.samplerPitchCache.clear();return}if(l&&this.samplerBuffer)return;const u=++this.samplerLoadToken;try{const f=await(await fetch(a.dataUrl)).arrayBuffer(),h=await this.ctx.decodeAudioData(f.slice(0));u===this.samplerLoadToken&&(this.samplerBuffer=h,this.samplerMeta=this.normalizeSamplerMeta(this.samplerMeta,h),this.samplerPitchCache.clear())}catch(d){u===this.samplerLoadToken&&(this.samplerBuffer=null,this.samplerMeta=this.normalizeSamplerMeta(this.samplerMeta,null),this.samplerPitchCache.clear()),console.warn("Failed to decode sampler buffer",d)}}getSamplerBaseFrequency(){const a=Number.isFinite(this.samplerMeta.rootMidi)?this.samplerMeta.rootMidi:60;return 440*Math.pow(2,(a-69)/12)}getDetuneCents(a){if(a==="osc1"){const l=this.patch.osc1.detune||0,u=this.patch.osc1.detuneFine??0;return l+u}return this.patch.osc2.detune||0}mapNoiseLfoCutoff(a){const l=we(a,.01,20);return we(l*12,.5,600)}updateLfoSource(a,l){const u=this.lfos[a];if(!u)return;const d=this.ctx.currentTime,f=l.wave;if(f==="noise"){if(this.noiseBuffer||(this.noiseBuffer=ku(this.ctx)),u.osc){try{u.osc.stop(d)}catch{}try{u.osc.disconnect()}catch{}u.osc=null}if(!u.noise){const h=this.ctx.createBufferSource();h.buffer=this.noiseBuffer,h.loop=!0;const x=this.ctx.createBiquadFilter();x.type="lowpass",x.Q.value=1e-4,h.connect(x),x.connect(u.gain),h.start(),u.noise=h,u.noiseFilter=x}if(u.noiseFilter){const h=this.mapNoiseLfoCutoff(l.rateHz);u.noiseFilter.frequency.setTargetAtTime(h,d,.05)}}else{if(u.osc)u.osc.type=f,u.osc.frequency.setValueAtTime(Math.max(.01,l.rateHz),d);else{const h=this.ctx.createOscillator();h.type=f,h.frequency.value=Math.max(.01,l.rateHz),h.connect(u.gain),h.start(),u.osc=h}if(u.noise){try{u.noise.stop(d)}catch{}try{u.noise.disconnect()}catch{}u.noise=null}if(u.noiseFilter){try{u.noiseFilter.disconnect()}catch{}u.noiseFilter=null}}u.wave=f}getPitchedSamplerBuffer(a){if(!this.samplerBuffer)return null;const l=this.samplerBuffer.sampleRate,u=this.samplerMeta.trimStartSec??0,d=this.samplerMeta.trimEndSec??this.samplerBuffer.duration,f=we(u,0,this.samplerBuffer.duration),h=we(d,f+.005,this.samplerBuffer.duration),x=Math.max(0,Math.floor(f*l)),m=Math.max(x+1,Math.min(this.samplerBuffer.length,Math.floor(h*l)));if(m-x<=0)return null;const w=`${this.samplerMeta.id??"inline"}|${this.samplerMeta.dataUrl??"data"}|${x}|${m}`,k=Number.isFinite(a)&&a>0?a:1,M=k.toFixed(6),y=`${w}|${M}|${l}|${this.samplerBuffer.numberOfChannels}`,j=this.samplerPitchCache.get(y);if(j)return j;const N=this.samplerBuffer.numberOfChannels,_=[];for(let J=0;J<N;J++){const E=this.samplerBuffer.getChannelData(J).subarray(x,m);_.push(new Float32Array(E))}const R=Math.abs(k-1)<1e-4?_:op({channels:_,pitchRatio:k});if(!R.length||R[0].length===0)return null;const X=this.ctx.createBuffer(R.length,R[0].length,l);for(let J=0;J<R.length;J++)X.copyToChannel(R[J],J,0);return this.samplerPitchCache.set(y,X),X}createSamplerSource(a,l,u={}){const{autoStart:d=!0,allowLoop:f=!0}=u;if(!this.samplerBuffer)return null;this.samplerMeta=this.normalizeSamplerMeta(this.samplerMeta,this.samplerBuffer);const h=this.getSamplerBaseFrequency(),x=this.getDetuneCents(l),m=Math.pow(2,x/1200),v=h>0?a/h*m:m,g=this.getPitchedSamplerBuffer(v);if(!g)return null;const w=g.duration,k=f&&!!this.samplerMeta.loop&&w>.01,M=Rt(this.ctx.createBufferSource());if(M.buffer=g,M.loop=k,k&&(M.loopStart=0,M.loopEnd=w),d){if(k)M.start(0);else{const y=Math.max(.005,w);M.start(0,0,y)}lp(M)}return M}applyPatch(a={},l={}){const{fromExpression:u=!1}=l,d=this.patch,f=a.osc1??{},h=a.osc2??{},x=Array.isArray(a.modMatrix)?a.modMatrix.map(k=>({...k,amount:Number.isFinite(k.amount)?k.amount:0,enabled:k.enabled!==!1})):void 0,m=(this.patch.modMatrix??[]).map(k=>({...k})),v=wu({...this.patch.osc1,...f}),g=wu({...this.patch.osc2,...h}),w={...this.patch,...a,osc1:v,osc2:g,fm:{...this.patch.fm,...a.fm??{}},sub:{...this.patch.sub,...a.sub??{}},ring:{...this.patch.ring,...a.ring??{}},filter:{...this.patch.filter,...a.filter??{}},envelope:{...this.patch.envelope,...a.envelope??{}},master:{...this.patch.master,...a.master??{}},mix:a.mix!=null?we(a.mix,0,1):this.patch.mix,engineMode:a.engineMode??this.patch.engineMode??"classic",sampler:{...this.patch.sampler??I.sampler,...a.sampler??{}},macro:{...this.patch.macro??It,...a.macro??{}},effects:{...this.patch.effects??I.effects,...a.effects??{}},lfo1:{...this.patch.lfo1??I.lfo1,...a.lfo1??{}},lfo2:{...this.patch.lfo2??I.lfo2,...a.lfo2??{}},arp:{...this.patch.arp??I.arp,...a.arp??{}},sequencer:{...this.patch.sequencer??I.sequencer,...a.sequencer??{}},expression:{...this.patch.expression??I.expression,...a.expression??{}},modMatrix:x??m};if(this.patch=w,a.sampler!==void 0?this.updateSamplerBuffer(w.sampler):a.osc1?.sampler!==void 0?this.updateSamplerBuffer(w.osc1.sampler??I.sampler):a.osc2?.sampler!==void 0&&this.updateSamplerBuffer(w.osc2.sampler??I.sampler),this.configureExpressionRouting(w.expression),a.mix!==void 0&&w.mix!==d.mix){const k=we(w.mix,0,1),M=this.ctx.currentTime;for(const y of this.activeVoices.values())y.mixControl&&y.mixControl.offset.setTargetAtTime(k,M,.01)}if(w.master.gain!==d.master.gain&&this.master.gain.setTargetAtTime(w.master.gain,this.ctx.currentTime,.01),w.filter.type!==d.filter.type&&(this.filter.type=w.filter.type),w.filter.q!==d.filter.q&&this.filter.Q.setTargetAtTime(w.filter.q,this.ctx.currentTime,.02),w.filter.cutoff!==d.filter.cutoff&&this.filter.frequency.setTargetAtTime(w.filter.cutoff,this.ctx.currentTime,.015),this.noiseBuffer||(this.noiseBuffer=ku(this.ctx)),a.effects!==void 0&&this.buildFxChain(),a.lfo1!==void 0||a.lfo2!==void 0||a.master?.gain!==void 0){const k=[this.patch.lfo1,this.patch.lfo2];for(let M=0;M<this.lfos.length;M++){const y=this.lfos[M],j=k[M];this.updateLfoSource(M,j);try{y.gain.disconnect()}catch{}if(y.dest="none",y.gain.gain.value=0,j.enabled)if(j.dest==="filter")y.dest="filter",y.gain.gain.value=Math.max(0,j.amount)*2e3,y.gain.connect(this.filter.frequency);else if(j.dest==="amp"){y.dest="amp";const N=this.patch.master.gain;y.gain.gain.value=Math.max(0,j.amount)*Math.max(0,N)*.8,y.gain.connect(this.master.gain)}else j.dest==="pitch"&&(y.dest="pitch",y.gain.gain.value=Math.max(0,j.amount)*50)}this.refreshMixAudioConnections()}if(a.arp!==void 0&&this.updateArpScheduler({forceRestart:!0}),a.sequencer!==void 0&&this.updateSeqScheduler(),(a.modMatrix!==void 0||a.lfo1!==void 0||a.lfo2!==void 0)&&this.applyModMatrix(this.patch.modMatrix??[]),a.osc1?.detune!==void 0||a.osc1?.detuneFine!==void 0){const k=this.ctx.currentTime,M=(w.osc1.detune||0)+(w.osc1.detuneFine??0);for(const y of this.activeVoices.values())if(y.osc1Detune)try{y.osc1Detune.setTargetAtTime(M,k,.01)}catch{}}if(a.osc2?.detune!==void 0){const k=this.ctx.currentTime;for(const M of this.activeVoices.values())if(M.osc2Detune)try{M.osc2Detune.setTargetAtTime(w.osc2.detune||0,k,.01)}catch{}}this.expression2D.active&&!u&&this.applyExpression2D()}async previewSampler(a){const l=this.patch[a].sampler??I.sampler;if(!l?.dataUrl||(await this.updateSamplerBuffer(l),!this.samplerBuffer))return;const u=Number.isFinite(l.rootMidi)?l.rootMidi:60,d=440*Math.pow(2,(u-69)/12),f=this.createSamplerSource(d,a,{autoStart:!1,allowLoop:!1});if(!f)return;const h=Rt(f),x=this.ctx.createGain();x.gain.value=.8,h.connect(x),x.connect(this.master);const m=this.ctx.currentTime,v=Math.max(.05,Math.min(h.buffer?.duration??.5,5));let g=!1;try{h.start(m),g=!0,Su(h),h.stop(m+v),h._started=!1}catch(k){if(!g){try{h.disconnect()}catch{}try{x.disconnect()}catch{}return}throw k}const w=()=>{try{h.disconnect()}catch{}try{x.disconnect()}catch{}};h.addEventListener("ended",w,{once:!0})}buildFxChain(){try{this.fxInput.disconnect()}catch{}if(this.currentFxTap){try{this.currentFxTap.disconnect(this.fxOutput)}catch{}this.currentFxTap=null}let a=this.fxInput;const l=this.patch.effects;l?.delay?.enabled&&(a=this.applyDelayEffect(a,l.delay)),l?.reverb?.enabled&&(a=this.applyReverbEffect(a,l.reverb)),a.connect(this.fxOutput),this.currentFxTap=a}clamp01(a){return Math.min(1,Math.max(0,a))}setExpression2D(a,l){const u=this.clamp01(a),d=this.clamp01(l);this.expression2D.active||this.captureExpressionBase(),this.expression2D={active:!0,x:u,y:d},this.applyExpression2D(),this.updateControlSource("exprX",u*2-1),this.updateControlSource("exprY",d*2-1)}clearExpression2D(){if(this.expression2D.active){this.expressionApplying=!0;try{for(const a of ui)this.resetExpressionAxis(a)}finally{this.expressionApplying=!1,this.expression2D={active:!1,x:.5,y:.5},this.expressionSnapshot={x:null,y:null},this.updateControlSource("exprX",0),this.updateControlSource("exprY",0)}}}configureExpressionRouting(a=this.patch.expression??I.expression){const l=I.expression??{x:"osc1.detune",y:"filter.cutoff"};for(const u of ui){const d=a?.[u]??l[u],f=ht[d]?d:l[u];(this.expressionAxisTargets[u]!==f||!this.expression2D.active)&&(this.expressionSnapshot[u]=null),this.expressionAxisTargets[u]=f}}captureExpressionBase(){for(const a of ui){const l=this.expressionAxisTargets[a],u=ht[l];if(!u)continue;const d=u.getBase(this);this.expressionSnapshot[a]=Number.isFinite(d)?d:0}}applyExpressionAxis(a,l){const u=this.expressionAxisTargets[a],d=ht[u];if(!d)return;let f=this.expressionSnapshot[a];(f==null||Number.isNaN(f))&&(f=d.getBase(this),this.expressionSnapshot[a]=f);const{min:h,max:x}=d.range(this,f),m=x-h,v=m<=0?f:h+m*this.clamp01(l);d.apply(this,v)}resetExpressionAxis(a){const l=this.expressionSnapshot[a],u=this.expressionAxisTargets[a],d=ht[u];d&&l!=null&&Number.isFinite(l)&&d.apply(this,l),this.expressionSnapshot[a]=null}applyExpression2D(){if(!(!this.expression2D.active||this.expressionApplying)){this.expressionApplying=!0;try{this.applyExpressionAxis("x",this.expression2D.x),this.applyExpressionAxis("y",this.expression2D.y)}finally{this.expressionApplying=!1}}}applyDelayEffect(a,l){const u=this.clamp01(l.mix),d=Math.max(0,Math.min(1.5,l.time)),f=Math.max(0,Math.min(.95,l.feedback)),h=this.ctx.createDelay(2);h.delayTime.value=d;const x=this.ctx.createGain();x.gain.value=f,h.connect(x),x.connect(h);const m=this.ctx.createGain();m.gain.value=1-u;const v=this.ctx.createGain();v.gain.value=u;const g=this.ctx.createGain();return a.connect(m),a.connect(h),h.connect(v),m.connect(g),v.connect(g),g}makeImpulse(a,l){const u=Math.max(1,Math.floor(this.ctx.sampleRate*Math.max(.05,a))),d=this.ctx.createBuffer(2,u,this.ctx.sampleRate);for(let f=0;f<d.numberOfChannels;f++){const h=d.getChannelData(f);for(let x=0;x<u;x++){const m=x/u;h[x]=(Math.random()*2-1)*Math.pow(1-m,2+l*6)}}return d}applyReverbEffect(a,l){const u=this.clamp01(l.mix),d=.1+this.clamp01(l.size)*3,f=this.clamp01(l.decay),h=this.ctx.createConvolver();h.normalize=!0,h.buffer=this.makeImpulse(d,f);const x=this.ctx.createGain();x.gain.value=1-u;const m=this.ctx.createGain();m.gain.value=u;const v=this.ctx.createGain();return a.connect(x),a.connect(h),h.connect(m),x.connect(v),m.connect(v),v}makeWavefolderCurve(a,l,u=2048){const d=new Float32Array(u),f=Math.max(1e-4,a)*6,h=(l-.5)*2;for(let x=0;x<u;x++){let m=x/(u-1)*2-1;m+=h*.5;const v=Math.tanh(f*m)/Math.tanh(f);d[x]=v}return d}buildMacroVoice(a,l){switch(l.model){case"fold":return this.createMacroFold(a,l);case"pluck":return this.createMacroPluck(a,l);case"supersaw":return this.createMacroSuperSaw(a,l);case"pwm":return this.createMacroPWM(a,l);case"fm2op":return this.createMacroFM2Op(a,l);case"wavetable":return this.createMacroWavetable(a,l);case"harmonic":return this.createMacroHarmonic(a,l);case"chord":return this.createMacroChord(a,l);case"dirichlet":return this.createMacroDirichletPulse(a,l);case"formant":return this.createMacroFormant(a,l);case"va":default:return this.createMacroVA(a,l)}}createMacroSuperSaw(a,l){const d=this.ctx.createGain(),f=this.ctx.createBiquadFilter();f.type="lowpass",f.frequency.value=800+l.timbre*12e3,f.Q.value=.3;const h=0+l.harmonics*30,x=[-1,-.6,-.2,.2,.6,1],m=[];for(let g=0;g<6;g++){const w=this.ctx.createOscillator();w.type="sawtooth",w.frequency.value=a,w.detune.value=x[g]*h;const k=this.ctx.createGain();k.gain.value=1/6;const M=this.ctx.createStereoPanner(),y=(l.morph-.5)*2,j=x[g]/Math.max(1,Math.max(...x.map(Math.abs)))*y;M.pan.value=j,w.connect(k).connect(M).connect(d),m.push({osc:w,pan:M}),w.start()}d.connect(f);const v=this.ctx.createGain();return v.gain.value=l.level,f.connect(v),{output:v,stop:g=>m.forEach(({osc:w})=>w.stop(g)),pitched:m.map(g=>g.osc)}}createMacroDirichletPulse(a,l){const u=this.ctx.createOscillator();u.frequency.value=a;const d=8,h=Math.max(d,Math.round(d+l.harmonics*(64-d))),x=Math.min(.92,Math.max(.08,.08+l.timbre*.84)),m=(l.morph-.5)*Math.PI*2,v=new Float32Array(h+1),g=new Float32Array(h+1);v[0]=0;for(let j=1;j<=h;j++){const N=j,_=2/(N*Math.PI)*Math.sin(N*Math.PI*x),R=N/(h+1),X=R===0?1:Math.sin(Math.PI*R)/(Math.PI*R),J=_*X;if(!Number.isFinite(J)||Math.abs(J)<1e-6)continue;const V=m*N;v[N]=J*Math.cos(V),g[N]=J*Math.sin(V)}const w=this.ctx.createPeriodicWave(v,g,{disableNormalization:!1});u.setPeriodicWave(w);const k=this.ctx.createBiquadFilter();k.type="lowpass";const M=Math.max(a*2,a*Math.min(h+2,40));k.frequency.value=Math.min(this.ctx.sampleRate*.48,M),k.Q.value=Math.max(.35,.7+(.5-x)*.6);const y=this.ctx.createGain();return y.gain.value=l.level,u.connect(k).connect(y),u.start(),{output:y,stop:j=>u.stop(j),pitched:[u]}}createMacroWavetable(a,l){const u=["sine","triangle","sawtooth","square"],d=Math.min(3,Math.max(0,Math.floor(l.morph*3.00001))),f=Math.min(1,Math.max(0,l.morph*3-d)),h=(k,M)=>{const y=this.ctx.createOscillator();y.type=k,y.frequency.value=a;const j=this.ctx.createGain();return j.gain.value=M,y.connect(j),{osc:y,g:j}},x=h(u[d],d===3?1:1-f),m=d<3?h(u[d+1],f):null,v=this.ctx.createBiquadFilter();v.type="lowpass",v.frequency.value=800+l.harmonics*15e3,v.Q.value=.1+l.timbre*.6;const g=this.ctx.createGain();g.gain.value=l.level,x.g.connect(v),m&&m.g.connect(v),v.connect(g),x.osc.start(),m&&m.osc.start();const w=[x.osc];return m&&w.push(m.osc),{output:g,stop:k=>{x.osc.stop(k),m&&m.osc.stop(k)},pitched:w}}createMacroHarmonic(a,l){const f=Math.round(2+l.harmonics*14),h=.5+(1-l.timbre)*2,x=(l.morph-.5)*2,m=this.ctx.createGain(),v=[];for(let k=1;k<=f;k++){const M=this.ctx.createOscillator();M.type="sine",M.frequency.value=a*k;let y=1/Math.pow(k,h);const N=k%2===0?Math.max(.1,(x+1)/2):Math.max(.1,(1-x)/2);y*=N;const _=this.ctx.createGain();_.gain.value=y,M.connect(_).connect(m),M.start(),v.push(M)}const g=this.ctx.createBiquadFilter();g.type="lowpass",g.frequency.value=1e3+l.timbre*15e3,g.Q.value=.2;const w=this.ctx.createGain();return w.gain.value=l.level,m.connect(g).connect(w),{output:w,stop:k=>{for(const M of v)M.stop(k)},pitched:v}}createMacroFormant(a,l){const u=this.ctx.createOscillator();u.type="sawtooth",u.frequency.value=a;const d=this.ctx.createGain();d.gain.value=1,u.connect(d);const f=this.ctx.createGain();f.gain.value=1;const h=[{ratios:[1,2.6,4.9],widths:[.22,.18,.28],gains:[1,.7,.45]},{ratios:[.9,2.1,3.5],widths:[.28,.22,.32],gains:[1,.65,.55]},{ratios:[1.3,2.8,4.2],widths:[.2,.16,.24],gains:[.9,.75,.5]},{ratios:[.8,1.6,2.8],widths:[.32,.26,.36],gains:[1.05,.6,.55]}],x=l.morph*(h.length-1),m=Math.floor(x),v=Math.min(h.length-1,m+1),g=x-m,w=h[m]??h[0],k=h[v],M=.8+l.harmonics*1.4,y=.6+l.timbre*2.4,j=this.ctx.sampleRate*.48,N=w.ratios.length;for(let J=0;J<N;J++){const V=w.ratios[J],E=k.ratios[J],A=w.widths[J],z=k.widths[J],$=w.gains[J],pe=k.gains[J],Ce=(V+(E-V)*g)*M,he=Math.max(.05,A+(z-A)*g),te=$+(pe-$)*g,ce=Math.min(j,Math.max(60,a*Ce)),Z=this.ctx.createBiquadFilter();Z.type="bandpass",Z.frequency.value=ce;const B=Math.max(.5,Math.min(30,1/he*y));Z.Q.value=B;const D=this.ctx.createGain();D.gain.value=te/N*(1/Math.sqrt(B)),d.connect(Z),Z.connect(D).connect(f)}const _=this.ctx.createBiquadFilter();_.type="highpass",_.frequency.value=Math.max(40,a*.5),_.Q.value=.7;const R=this.ctx.createBiquadFilter();R.type="lowpass",R.frequency.value=Math.min(j,3e3+l.harmonics*14e3),R.Q.value=.7+l.timbre*.6,f.connect(_).connect(R);const X=this.ctx.createGain();return X.gain.value=l.level,R.connect(X),u.start(),{output:X,stop:J=>u.stop(J),pitched:[u]}}createMacroChord(a,l){const u=[[0,4,7],[0,3,7],[0,5,7],[0,2,7],[0,4,7,10],[0,3,7,10],[0,4,7,11],[0,3,6,9],[0,4,8],[-12,0,7,12]],d=Math.max(0,Math.min(u.length-1,Math.floor(l.harmonics*u.length))),f=u[d],h=(l.morph-.5)*2,x=this.ctx.createGain(),m=this.ctx.createBiquadFilter();m.type="lowpass",m.frequency.value=900+l.timbre*15e3,m.Q.value=.3;const v=this.ctx.createGain();v.gain.value=l.level;const g=[],w=[-1,-.3,.3,1];return f.forEach((k,M)=>{const y=this.ctx.createOscillator();y.type="sawtooth";const j=440*Math.pow(2,Math.log2(a/440)+k/12);y.frequency.value=j;const N=w[M%w.length]*h*15;y.detune.value=N;const _=this.ctx.createGain();_.gain.value=1/f.length;const R=this.ctx.createStereoPanner();R.pan.value=w[M%w.length]*h,y.connect(_).connect(R).connect(x),y.start(),g.push(y)}),x.connect(m).connect(v),{output:v,stop:k=>{for(const M of g)M.stop(k)},pitched:g}}createMacroPWM(a,l){const u=this.ctx.createOscillator();u.type="sawtooth",u.frequency.value=a;const d=this.ctx.createGain();d.gain.value=1;const f=this.ctx.createConstantSource(),h=(l.morph-.5)*1.6;f.offset.value=h,f.start(),u.connect(d),f.connect(d);const x=this.ctx.createWaveShaper(),m=1+l.harmonics*24,v=2048,g=new Float32Array(v);for(let M=0;M<v;M++){const y=M/(v-1)*2-1;g[M]=Math.tanh(m*y)}x.curve=g,x.oversample="4x";const w=this.ctx.createBiquadFilter();w.type="lowpass",w.frequency.value=2e3+l.timbre*14e3,w.Q.value=.2;const k=this.ctx.createGain();return k.gain.value=l.level,d.connect(x).connect(w).connect(k),u.start(),{output:k,stop:M=>{u.stop(M),f.stop(M)},pitched:[u]}}createMacroFM2Op(a,l){const u=this.ctx.createOscillator();u.type="sine",u.frequency.value=a;const d=this.ctx.createOscillator();d.type="sine";const f=.25+l.harmonics*7.75;d.frequency.value=a*f;const h=this.ctx.createGain();h.gain.value=Math.max(0,l.timbre)*a*2,d.connect(h).connect(u.frequency);const x=this.ctx.createBiquadFilter();x.type="lowpass",x.frequency.value=1e3+l.morph*15e3,x.Q.value=.1;const m=this.ctx.createGain();return m.gain.value=l.level,u.connect(x).connect(m),u.start(),d.start(),{output:m,stop:v=>{u.stop(v),d.stop(v)},pitched:[u]}}createMacroVA(a,l){const u=this.ctx.createOscillator(),d=this.ctx.createOscillator();u.type="sawtooth",d.type="triangle",u.frequency.value=a,d.frequency.value=a;const f=this.ctx.createGain(),h=this.ctx.createGain();f.gain.value=1-l.timbre,h.gain.value=l.timbre;const x=this.ctx.createGain(),m=this.ctx.createBiquadFilter();return m.type="lowpass",m.frequency.value=1e3+l.harmonics*15e3,m.Q.value=.5,d.connect(f).connect(x),u.connect(h).connect(x),x.connect(m),d.start(),u.start(),{output:m,stop:v=>{d.stop(v),u.stop(v)},pitched:[d,u]}}createMacroFold(a,l){const u=this.ctx.createOscillator();u.type="sine",u.frequency.value=a;const d=this.ctx.createGain(),f=this.ctx.createWaveShaper(),h=this.ctx.createGain(),x=.2+l.harmonics*1.6,m=l.morph;f.curve=this.makeWavefolderCurve(x,m),f.oversample="4x",d.gain.value=1,h.gain.value=l.level;const v=this.ctx.createBiquadFilter();return v.type="lowpass",v.frequency.value=4e3+l.timbre*16e3,v.Q.value=.2,u.connect(d).connect(f).connect(v).connect(h),u.start(),{output:h,stop:g=>u.stop(g),pitched:[u]}}createMacroPluck(a,l){const u=this.ctx.createGain(),d=this.ctx.createBufferSource(),f=Math.floor(this.ctx.sampleRate*.02),h=this.ctx.createBuffer(1,f,this.ctx.sampleRate),x=h.getChannelData(0);for(let j=0;j<f;j++)x[j]=(Math.random()*2-1)*(1-j/f);d.buffer=h,d.loop=!1;const m=1/Math.max(20,a),v=this.ctx.createDelay(1);v.delayTime.value=m;const g=this.ctx.createGain(),w=.78+l.harmonics*.2,k=Math.max(.8,1-a*9e-4);g.gain.value=Math.min(.96,w*k);const M=this.ctx.createBiquadFilter();M.type="lowpass",M.frequency.value=1e3+l.timbre*8e3,M.Q.value=0;const y=this.ctx.createBiquadFilter();return y.type="highpass",y.frequency.value=50+l.morph*400,d.connect(y).connect(v).connect(u),v.connect(M).connect(g).connect(v),u.gain.value=l.level,d.start(),{output:u,stop:j=>{},pitched:[]}}makeVoice(a){const l=this.ctx.currentTime,u=this.patch.envelope,d=this.ctx.createGain();d.gain.value=0,d.connect(this.filter);const f=this.activeVoices.size,x=.65/Math.max(1,Math.sqrt(f+1)),v=(B=>{const D=Number(B??0);return Number.isFinite(D)?Math.max(-3,Math.min(3,Math.round(D))):0})(this.patch.osc1.octave),g=a*Math.pow(2,v),w=this.patch.engineMode??"classic",k=B=>B==="macro"?"macro":B==="sampler"?"sampler":"analog",M=this.patch.osc1.mode??k(w),y=this.patch.osc2.mode??k(w),j=this.ctx.createGain(),N=this.ctx.createGain();j.gain.value=0,N.gain.value=0;const _=this.ctx.createGain();_.gain.value=1,j.connect(_),N.connect(_),_.connect(d);const R=we(this.patch.mix,0,1),X=this.ctx.createConstantSource();X.offset.value=R;const J=this.ctx.createConstantSource();J.offset.value=1;const V=this.ctx.createGain();V.gain.value=-1,X.connect(N.gain),X.connect(V),V.connect(j.gain),J.connect(j.gain),X.start(),J.start();const E=[];let A=null,z=null,$=null;const pe=[],Ce=[];if(M==="macro"){const B=this.patch.osc1.macro??this.patch.macro??It,D=this.buildMacroVoice(g,B);if(D.output.connect(j),Ce.push(D),$||($=D.output),D.pitched&&D.pitched.length)for(const F of D.pitched)for(const U of this.lfos)U.dest==="pitch"&&this.patch[this.lfos.indexOf(U)===0?"lfo1":"lfo2"]?.enabled&&(U.gain.connect(F.detune),pe.push({g:U.gain,p:F.detune}))}else if(M==="sampler"){const B=this.createSamplerSource(g,"osc1");B&&(B.connect(j),E.push(B),$=B)}else{let B=null;if(this.patch.osc1.wave==="noise"){const D=Rt(this.ctx.createBufferSource());D.buffer=this.noiseBuffer,D.loop=!0,B=D}else if(this.patch.osc1.wave==="sample")B=this.createSamplerSource(g,"osc1");else{const D=Rt(this.ctx.createOscillator());D.type=this.patch.osc1.wave,D.frequency.setValueAtTime(g,l);const F=this.patch.osc1.detuneFine??0;D.detune.value=(this.patch.osc1.detune||0)+F,B=D,A=D}if(B&&(B.connect(j),E.push(B),$=B),B&&this.patch.fm.enabled&&"frequency"in B){const D=B,F=Rt(this.ctx.createOscillator());F.type=this.patch.osc2.wave;const U=Math.max(.01,this.patch.fm.ratio||1);F.frequency.setValueAtTime(a*U,l),F.detune.value=this.patch.osc2.detune||0;const G=this.ctx.createGain();G.gain.value=Math.max(0,this.patch.fm.amount||0),F.connect(G),G.connect(D.frequency),E.push(F)}if(B&&"detune"in B)for(const D of this.lfos)D.dest==="pitch"&&this.patch[this.lfos.indexOf(D)===0?"lfo1":"lfo2"]?.enabled&&(D.gain.connect(B.detune),pe.push({g:D.gain,p:B.detune}))}if(y==="macro"){const B=this.patch.osc2.macro??this.patch.macro??It,D=this.buildMacroVoice(a,B);if(D.output.connect(N),Ce.push(D),D.pitched&&D.pitched.length)for(const F of D.pitched)for(const U of this.lfos)U.dest==="pitch"&&this.patch[this.lfos.indexOf(U)===0?"lfo1":"lfo2"]?.enabled&&(U.gain.connect(F.detune),pe.push({g:U.gain,p:F.detune}))}else if(y==="sampler"){const B=this.createSamplerSource(a,"osc2");B&&(B.connect(N),E.push(B))}else{let B=null;if(this.patch.osc2.wave==="noise"){const D=Rt(this.ctx.createBufferSource());D.buffer=this.noiseBuffer,D.loop=!0,B=D}else{const D=Rt(this.ctx.createOscillator());D.type=this.patch.osc2.wave,D.frequency.setValueAtTime(a,l),D.detune.value=this.patch.osc2.detune,B=D,z=D}if(B&&(B.connect(N),E.push(B)),this.patch.ring.enabled&&$&&B){const D=this.ctx.createGain();D.gain.value=0,$.connect(D);const F=this.ctx.createGain();F.gain.value=1,B.connect(F),F.connect(D.gain);const U=Math.max(0,Math.min(1,this.patch.ring.amount));_.gain.value=1-U;const G=this.ctx.createGain();G.gain.value=U,D.connect(G),G.connect(d)}if(B&&"detune"in B)for(const D of this.lfos)D.dest==="pitch"&&this.patch[this.lfos.indexOf(D)===0?"lfo1":"lfo2"]?.enabled&&(D.gain.connect(B.detune),pe.push({g:D.gain,p:B.detune}))}const he=d.gain;if(he.cancelScheduledValues(l),he.setValueAtTime(0,l),he.linearRampToValueAtTime(x,l+Math.max(.001,u.attack)),he.linearRampToValueAtTime(u.sustain*x,l+u.attack+Math.max(.001,u.decay)),this.patch.sub.enabled){const B=Rt(this.ctx.createOscillator());B.type=this.patch.sub.wave||"square";const D=a/Math.pow(2,Math.max(1,Math.min(2,this.patch.sub.octave)));B.frequency.setValueAtTime(D,l);const F=this.ctx.createGain();F.gain.value=Math.max(0,Math.min(1,this.patch.sub.level)),B.connect(F),F.connect(d),E.push(B);for(const U of this.lfos)U.dest==="pitch"&&this.patch[this.lfos.indexOf(U)===0?"lfo1":"lfo2"]?.enabled&&(U.gain.connect(B.detune),pe.push({g:U.gain,p:B.detune}))}for(const B of E)if("start"in B){const D=Rt(B);if(D._autoStarted)continue;D._started||(D.start(),Su(D))}const te=[],Z={stop:B=>{const D=Math.max(this.ctx.currentTime,B);he.cancelScheduledValues(D),he.setValueAtTime(he.value,D),he.linearRampToValueAtTime(0,D+Math.max(.001,u.release));for(const F of E)if("stop"in F){const U=Rt(F);if(!U._started)continue;try{U.stop(D+u.release+.05)}catch(G){if(!(G instanceof DOMException))throw G}finally{U._started=!1}}for(const F of Ce)try{F.stop(D+u.release+.05)}catch{}for(const F of pe)try{F.g.disconnect(F.p)}catch{}for(const F of te){const U=this.lfos[F.sourceIndex]?.gain;if(U)try{U.disconnect(F.gain)}catch{}try{F.gain.disconnect()}catch{}}try{X.stop(D+u.release+.05)}catch{}try{J.stop(D+u.release+.05)}catch{}try{X.disconnect()}catch{}try{V.disconnect()}catch{}try{J.disconnect()}catch{}},mixControl:X,mixBias:J,mixConnections:te};return A&&(Z.osc1Detune=A.detune),z&&(Z.osc2Detune=z.detune),Z}allNotesOff(){const a=this.ctx.currentTime;for(const l of this.activeVoices.values())l.stop(a);this.activeVoices.clear(),this.activeNoteVelocities.clear(),this.refreshVelocitySignals()}getArpChordOffsets(){const a=this.patch.arp??I.arp;if((a.chordSource??"preset")==="sequencer"){const d=this.patch.sequencer??I.sequencer,f=d.steps??[],h=Math.max(1,Math.min(f.length,d.length)),x=new Set;for(let m=0;m<h;m++){const v=f[m];if(v?.on){const g=Math.round(v.offset??0);Number.isFinite(g)&&x.add(g)}}return x.size>0?Array.from(x).sort((m,v)=>m-v):[0]}switch(a.chord??I.arp.chord??"none"){case"power":return[0,7];case"major":return[0,4,7];case"minor":return[0,3,7];case"sus2":return[0,2,7];case"sus4":return[0,5,7];case"maj7":return[0,4,7,11];case"min7":return[0,3,7,10];default:return[0]}}buildArpPool(){if(this.arpHeld.size===0)return[];const a=this.patch.arp?.mode??"up",l=a==="asplayed"?Array.from(this.arpHeld.values()):Array.from(this.arpHeld.values()).sort((h,x)=>h-x),u=Math.max(1,Math.min(4,this.patch.arp?.octaves??1)),d=[],f=this.getArpChordOffsets();for(let h=0;h<u;h++)for(const x of l){const m=x+h*12;for(const v of f){const g=m+v;g<0||g>127||d.push(g)}}if(a==="down")return d.slice().sort((h,x)=>x-h);if(a==="random")return d.slice().sort(()=>Math.random()-.5);if(a==="updown"){const h=d.slice().sort((m,v)=>m-v),x=h.slice().reverse().slice(1,-1);return h.concat(x)}return d}updateArpScheduler(a={}){const{forceRestart:l=!1}=a;if(!!this.patch.arp?.enabled&&this.arpHeld.size>0){const d=l||this.arpTimer==null;if(d&&this.arpTimer!=null&&(clearTimeout(this.arpTimer),this.arpTimer=null),d){this.arpPhase=0,this.arpRepeatCounter=0;const f=this.getArpStepMs(),h=this.computeArpAlignmentDelay(f);this.scheduleNextArpTick(h)}}else{if(this.arpTimer!=null&&(clearTimeout(this.arpTimer),this.arpTimer=null),this.arpLastNote!=null){const d=this.arpLastNote;this.arpBypass=!0;try{this.noteOff(d)}finally{this.arpBypass=!1}this.arpLastNote=null}this.arpIndex=0,this.arpRepeatCounter=0}}computeArpAlignmentDelay(a){if(!(a>0))return 0;const u=this.ctx.currentTime*1e3%a;return u<1?0:a-u}scheduleNextArpTick(a){const l=this.getArpStepMs();let u=0;if(this.patch.arp?.bpmSync){const x=this.patch.arp?.division,m=Math.max(0,Math.min(1,this.patch.arp?.swingPct??0));x==="1/8"?u=m:x==="1/16"?u=m*.5:u=0}const d=this.arpPhase===0?1+u*.5:1-u*.5,f=l*d,h=a??f;this.arpCurrentStepMs=f,this.arpTimer=setTimeout(()=>{if(!this.patch.arp?.enabled||this.arpHeld.size===0){this.updateArpScheduler();return}this.arpTick(),this.arpPhase=this.arpPhase?0:1,this.scheduleNextArpTick()},Math.max(0,h))}getArpStepMs(){const a=this.patch.arp;if(a?.bpmSync){const u=6e4/Math.max(20,Math.min(300,a.bpm||120)),d=a.division||"1/8",f=d==="1/4"?1:d==="1/8"?.5:d==="1/8T"?1/3:d==="1/16"?.25:1/6;return u*f}else return 1e3/Math.max(.1,a?.rateHz??8)}arpTick(){let a=this.buildArpPool();if(a.length===0){if(this.arpLastNote!=null){const v=this.arpLastNote;this.arpBypass=!0;try{this.noteOff(v)}finally{this.arpBypass=!1}this.arpLastNote=null}return}const l=Math.max(0,this.patch.arp?.patternLen??0);l>0&&a.length>l&&(a=a.slice(0,l)),this.arpIndex>=a.length&&(this.arpIndex=0);const u=a[this.arpIndex++],d=Math.max(1,Math.min(8,this.patch.arp?.repeats??1));this.arpRepeatCounter<d-1?(this.arpIndex=(this.arpIndex-1+a.length)%a.length,this.arpRepeatCounter++):this.arpRepeatCounter=0,this.arpLastNote!=null&&(this.patch.arp?.gate??.6)>=1,this.arpBypass=!0;try{this.noteOn(u,1)}finally{this.arpBypass=!1}this.arpLastNote=u;const f=this.arpCurrentStepMs||this.getArpStepMs(),h=Math.max(.05,Math.min(1,this.patch.arp?.gate??.6)),x=f*h,m=u;setTimeout(()=>{this.arpBypass=!0;try{this.noteOff(m)}finally{this.arpBypass=!1}},x)}getArpStatus(){const a=!!this.patch.arp?.enabled;let l=0,u=0;if(a){const d=this.buildArpPool().length,f=Math.max(0,this.patch.arp?.patternLen??0);if(l=f>0?Math.min(f,d):d,l<=0&&(l=0),l>0){const h=(this.arpIndex-1+l)%l;u=h<0?0:h}}return{enabled:a,stepIndex:u,length:l}}getSeqStepMs(){const a=this.patch.sequencer,u=6e4/Math.max(20,Math.min(300,a.bpm||120)),d=a.division,f=d==="1/4"?1:d==="1/8"?.5:d==="1/8T"?1/3:d==="1/16"?.25:1/6;return u*f}updateSeqScheduler(){const a=this.patch.sequencer;if(!!a.enabled&&!!a.playing)this.seqTimer!=null&&(clearTimeout(this.seqTimer),this.seqTimer=null),this.seqPhase=0,this.seqStepIndex=0,this.scheduleNextSeqTick();else{if(this.seqTimer!=null&&(clearTimeout(this.seqTimer),this.seqTimer=null),this.seqLastNote!=null){const u=this.seqLastNote;this.arpBypass=!0;try{this.noteOff(u)}finally{this.arpBypass=!1}this.seqLastNote=null}this.updateControlSource("seqStep",0)}}scheduleNextSeqTick(){const a=this.getSeqStepMs(),l=this.patch.sequencer?.division;let u=Math.max(0,Math.min(1,this.patch.sequencer?.swingPct??0));l==="1/16"&&(u*=.5),l==="1/8"&&(u=u),(l==="1/4"||l?.endsWith("T"))&&(u=0);const d=this.seqPhase===0?1+u*.5:1-u*.5,f=a*d;this.seqCurrentStepMs=f,this.seqTimer=setTimeout(()=>{if(!this.patch.sequencer?.enabled||!this.patch.sequencer?.playing){this.updateSeqScheduler();return}this.seqTick(),this.seqPhase=this.seqPhase?0:1,this.scheduleNextSeqTick()},f)}seqTick(){const a=this.patch.sequencer,l=Math.max(1,Math.min(a.steps.length,a.length)),u=this.seqStepIndex%l,d=a.steps[u]||{on:!1,offset:0,velocity:1};if(this.seqStepIndex=(this.seqStepIndex+1)%l,this.seqLastNote!=null&&(a.gate??.6)>=1){const f=this.seqLastNote;this.arpBypass=!0;try{this.noteOff(f)}finally{this.arpBypass=!1}this.seqLastNote=null}if(d.on){const f=Math.round((a.rootMidi||60)+(d.offset||0)),h=we(d.velocity??1,0,1);this.arpBypass=!0;try{this.noteOn(f,h)}finally{this.arpBypass=!1}this.seqLastNote=f;const x=++this.seqControlToken;this.updateControlSource("seqStep",h*2-1);const m=Math.max(.05,Math.min(1,a.gate??.6)),v=(this.seqCurrentStepMs||this.getSeqStepMs())*m;setTimeout(()=>{this.arpBypass=!0;try{this.noteOff(f)}finally{this.arpBypass=!1}this.seqControlToken===x&&this.updateControlSource("seqStep",0)},v)}else this.updateControlSource("seqStep",0)}getSequencerStatus(){const a=this.patch.sequencer,l=!!a.enabled&&!!a.playing,u=Math.max(0,Math.min(a.steps.length,a.length)),d=l&&u>0?(this.seqStepIndex+u-1)%u:0;return{enabled:l,stepIndex:d,length:u}}previewNote(a,l=150){this.arpBypass=!0;try{this.noteOn(a,1)}finally{this.arpBypass=!1}setTimeout(()=>{this.arpBypass=!0;try{this.noteOff(a)}finally{this.arpBypass=!1}},Math.max(20,l))}noteOn(a,l=1){if(this.patch.arp?.enabled&&!this.arpBypass){this.arpHeld.add(a),this.updateArpScheduler();return}const u=440*Math.pow(2,(a-69)/12),d=this.makeVoice(u);this.activeVoices.set(a,d);const f=we(l,0,1);this.activeNoteVelocities.set(a,f),this.refreshVelocitySignals(),this.refreshMixAudioConnections()}noteOff(a){if(this.patch.arp?.enabled&&!this.arpBypass){if(this.patch.arp?.latch||(this.arpHeld.delete(a),this.arpHeld.size===0&&this.updateArpScheduler()),this.arpLastNote===a){const u=this.activeVoices.get(a);u&&u.stop(this.ctx.currentTime),this.activeVoices.delete(a),this.arpLastNote===a&&(this.arpLastNote=null)}return}const l=this.activeVoices.get(a);l&&(l.stop(this.ctx.currentTime),this.activeVoices.delete(a)),this.arpBypass?this.activeNoteVelocities.delete(a):this.activeNoteVelocities.delete(a),this.refreshVelocitySignals()}arpClear(){if(this.arpHeld.clear(),this.arpIndex=0,this.arpTimer!=null&&(clearInterval(this.arpTimer),this.arpTimer=null),this.arpLastNote!=null){const a=this.arpLastNote;this.arpBypass=!0;try{this.noteOff(a)}finally{this.arpBypass=!1}this.arpLastNote=null}}}const up={},ju=r=>{let a;const l=new Set,u=(g,w)=>{const k=typeof g=="function"?g(a):g;if(!Object.is(k,a)){const M=a;a=w??(typeof k!="object"||k===null)?k:Object.assign({},a,k),l.forEach(y=>y(a,M))}},d=()=>a,m={setState:u,getState:d,getInitialState:()=>v,subscribe:g=>(l.add(g),()=>l.delete(g)),destroy:()=>{(up?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),l.clear()}},v=a=r(u,d,m);return m},dp=r=>r?ju(r):ju;var di={exports:{}},fi={},pi={exports:{}},hi={};/**
 * @license React
 * use-sync-external-store-shim.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Mu;function fp(){if(Mu)return hi;Mu=1;var r=es();function a(w,k){return w===k&&(w!==0||1/w===1/k)||w!==w&&k!==k}var l=typeof Object.is=="function"?Object.is:a,u=r.useState,d=r.useEffect,f=r.useLayoutEffect,h=r.useDebugValue;function x(w,k){var M=k(),y=u({inst:{value:M,getSnapshot:k}}),j=y[0].inst,N=y[1];return f(function(){j.value=M,j.getSnapshot=k,m(j)&&N({inst:j})},[w,M,k]),d(function(){return m(j)&&N({inst:j}),w(function(){m(j)&&N({inst:j})})},[w]),h(M),M}function m(w){var k=w.getSnapshot;w=w.value;try{var M=k();return!l(w,M)}catch{return!0}}function v(w,k){return k()}var g=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?v:x;return hi.useSyncExternalStore=r.useSyncExternalStore!==void 0?r.useSyncExternalStore:g,hi}var bu;function pp(){return bu||(bu=1,pi.exports=fp()),pi.exports}/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Eu;function hp(){if(Eu)return fi;Eu=1;var r=es(),a=pp();function l(v,g){return v===g&&(v!==0||1/v===1/g)||v!==v&&g!==g}var u=typeof Object.is=="function"?Object.is:l,d=a.useSyncExternalStore,f=r.useRef,h=r.useEffect,x=r.useMemo,m=r.useDebugValue;return fi.useSyncExternalStoreWithSelector=function(v,g,w,k,M){var y=f(null);if(y.current===null){var j={hasValue:!1,value:null};y.current=j}else j=y.current;y=x(function(){function _(E){if(!R){if(R=!0,X=E,E=k(E),M!==void 0&&j.hasValue){var A=j.value;if(M(A,E))return J=A}return J=E}if(A=J,u(X,E))return A;var z=k(E);return M!==void 0&&M(A,z)?A:(X=E,J=z)}var R=!1,X,J,V=w===void 0?null:w;return[function(){return _(g())},V===null?void 0:function(){return _(V())}]},[g,w,k,M]);var N=d(v,y[0],y[1]);return h(function(){j.hasValue=!0,j.value=N},[N]),m(N),N},fi}var Cu;function mp(){return Cu||(Cu=1,di.exports=hp()),di.exports}var vp=mp();const gp=qu(vp),Bu={},{useDebugValue:yp}=qe,{useSyncExternalStoreWithSelector:xp}=gp;let Nu=!1;const wp=r=>r;function Sp(r,a=wp,l){(Bu?"production":void 0)!=="production"&&l&&!Nu&&(console.warn("[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"),Nu=!0);const u=xp(r.subscribe,r.getState,r.getServerState||r.getInitialState,a,l);return yp(u),u}const kp=r=>{(Bu?"production":void 0)!=="production"&&typeof r!="function"&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");const a=typeof r=="function"?dp(r):r,l=(u,d)=>Sp(a,u,d);return Object.assign(l,a),l},jp=r=>kp,Mp={};function bp(r,a){let l;try{l=r()}catch{return}return{getItem:d=>{var f;const h=m=>m===null?null:JSON.parse(m,void 0),x=(f=l.getItem(d))!=null?f:null;return x instanceof Promise?x.then(h):h(x)},setItem:(d,f)=>l.setItem(d,JSON.stringify(f,void 0)),removeItem:d=>l.removeItem(d)}}const Zr=r=>a=>{try{const l=r(a);return l instanceof Promise?l:{then(u){return Zr(u)(l)},catch(u){return this}}}catch(l){return{then(u){return this},catch(u){return Zr(u)(l)}}}},Ep=(r,a)=>(l,u,d)=>{let f={getStorage:()=>localStorage,serialize:JSON.stringify,deserialize:JSON.parse,partialize:N=>N,version:0,merge:(N,_)=>({..._,...N}),...a},h=!1;const x=new Set,m=new Set;let v;try{v=f.getStorage()}catch{}if(!v)return r((...N)=>{console.warn(`[zustand persist middleware] Unable to update item '${f.name}', the given storage is currently unavailable.`),l(...N)},u,d);const g=Zr(f.serialize),w=()=>{const N=f.partialize({...u()});let _;const R=g({state:N,version:f.version}).then(X=>v.setItem(f.name,X)).catch(X=>{_=X});if(_)throw _;return R},k=d.setState;d.setState=(N,_)=>{k(N,_),w()};const M=r((...N)=>{l(...N),w()},u,d);let y;const j=()=>{var N;if(!v)return;h=!1,x.forEach(R=>R(u()));const _=((N=f.onRehydrateStorage)==null?void 0:N.call(f,u()))||void 0;return Zr(v.getItem.bind(v))(f.name).then(R=>{if(R)return f.deserialize(R)}).then(R=>{if(R)if(typeof R.version=="number"&&R.version!==f.version){if(f.migrate)return f.migrate(R.state,R.version);console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return R.state}).then(R=>{var X;return y=f.merge(R,(X=u())!=null?X:M),l(y,!0),w()}).then(()=>{_?.(y,void 0),h=!0,m.forEach(R=>R(y))}).catch(R=>{_?.(void 0,R)})};return d.persist={setOptions:N=>{f={...f,...N},N.getStorage&&(v=N.getStorage())},clearStorage:()=>{v?.removeItem(f.name)},getOptions:()=>f,rehydrate:()=>j(),hasHydrated:()=>h,onHydrate:N=>(x.add(N),()=>{x.delete(N)}),onFinishHydration:N=>(m.add(N),()=>{m.delete(N)})},j(),y||M},Cp=(r,a)=>(l,u,d)=>{let f={storage:bp(()=>localStorage),partialize:j=>j,version:0,merge:(j,N)=>({...N,...j}),...a},h=!1;const x=new Set,m=new Set;let v=f.storage;if(!v)return r((...j)=>{console.warn(`[zustand persist middleware] Unable to update item '${f.name}', the given storage is currently unavailable.`),l(...j)},u,d);const g=()=>{const j=f.partialize({...u()});return v.setItem(f.name,{state:j,version:f.version})},w=d.setState;d.setState=(j,N)=>{w(j,N),g()};const k=r((...j)=>{l(...j),g()},u,d);d.getInitialState=()=>k;let M;const y=()=>{var j,N;if(!v)return;h=!1,x.forEach(R=>{var X;return R((X=u())!=null?X:k)});const _=((N=f.onRehydrateStorage)==null?void 0:N.call(f,(j=u())!=null?j:k))||void 0;return Zr(v.getItem.bind(v))(f.name).then(R=>{if(R)if(typeof R.version=="number"&&R.version!==f.version){if(f.migrate)return[!0,f.migrate(R.state,R.version)];console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,R.state];return[!1,void 0]}).then(R=>{var X;const[J,V]=R;if(M=f.merge(V,(X=u())!=null?X:k),l(M,!0),J)return g()}).then(()=>{_?.(M,void 0),M=u(),h=!0,m.forEach(R=>R(M))}).catch(R=>{_?.(void 0,R)})};return d.persist={setOptions:j=>{f={...f,...j},j.storage&&(v=j.storage)},clearStorage:()=>{v?.removeItem(f.name)},getOptions:()=>f,rehydrate:()=>y(),hasHydrated:()=>h,onHydrate:j=>(x.add(j),()=>{x.delete(j)}),onFinishHydration:j=>(m.add(j),()=>{m.delete(j)})},f.skipHydration||y(),M||k},Np=(r,a)=>"getStorage"in a||"serialize"in a||"deserialize"in a?((Mp?"production":void 0)!=="production"&&console.warn("[DEPRECATED] `getStorage`, `serialize` and `deserialize` options are deprecated. Use `storage` option instead."),Ep(r,a)):Cp(r,a),Pp=Np,Wt=r=>({...r,mode:r.mode??"analog",macro:{...It,...r.macro??{}},sampler:{...kt,...r.sampler??{}}}),Tp=(r,a)=>r==="sampler"||a==="sampler"?"sampler":r==="macro"||a==="macro"?"macro":"classic",_p=r=>r.osc1.mode==="macro"&&r.osc1.macro?r.osc1.macro:r.osc2.mode==="macro"&&r.osc2.macro?r.osc2.macro:r.macro??It,Lp=(r,a,l)=>Math.min(l,Math.max(a,r)),Op=["lfo1","lfo2","exprX","exprY","seqStep","velocity","gate"],Rp=["filter.cutoff","filter.q","master.gain","macro.harmonics","macro.timbre","macro.morph","macro.level","fm.amount","mix","envelope.attack","envelope.release"],Uu=(r,a)=>{const l=typeof r.id=="string"&&r.id.length>0?r.id:a,u=Op.includes(r.source)?r.source:"lfo1",d=Rp.includes(r.target)?r.target:"filter.cutoff",f=Lp(Number.isFinite(r.amount)?Number(r.amount):0,-1,1),h=r.enabled!==!1;return{id:l,source:u,target:d,amount:f,enabled:h}},wi=()=>`mod-${Date.now().toString(36)}-${Math.random().toString(16).slice(2,6)}`,po=r=>{const a=new Set;return r.map(l=>{let u=Uu(l,wi());return a.has(u.id)&&(u={...u,id:wi()}),a.add(u.id),u})},Ip=r=>JSON.parse(JSON.stringify(r)),ne=jp()(Pp((r,a)=>({engine:null,patch:I,userPresets:[],samplerLibrary:[],layoutOrder:[],oscilloscope:{fftSize:4096},tempo:110,transport:{tempo:110,playing:!1,tick:0},midi:{supported:null,status:"idle",enabled:!1,inputs:[],selectedInputId:null,lastError:null,activeNotes:[]},setEngine:l=>r({engine:l}),updatePatch:l=>{const u=a().patch,d=Array.isArray(l.modMatrix)?po(l.modMatrix):void 0,f=(u.modMatrix??[]).map(k=>({...k})),h={...u,...l,osc1:{...u.osc1,...l.osc1},osc2:{...u.osc2,...l.osc2},fm:{...u.fm,...l.fm},sub:{...u.sub,...l.sub},ring:{...u.ring,...l.ring},filter:{...u.filter,...l.filter},envelope:{...u.envelope,...l.envelope},master:{...u.master,...l.master},sampler:{...u.sampler,...l.sampler},macro:{...u.macro||I.macro,...l.macro},effects:{...u.effects||I.effects,...l.effects},lfo1:{...u.lfo1||I.lfo1,...l.lfo1},lfo2:{...u.lfo2||I.lfo2,...l.lfo2},arp:{...u.arp||I.arp,...l.arp},sequencer:{...u.sequencer||I.sequencer,...l.sequencer},mix:l.mix!=null?l.mix:u.mix,expression:{...u.expression||I.expression,...l.expression}};h.osc1=Wt(h.osc1),h.osc2=Wt(h.osc2),h.modMatrix=d??f;const x=l.engineMode,m=x??Tp(h.osc1.mode??"analog",h.osc2.mode??"analog");h.engineMode=m;const v={...l};(x!==void 0||(u.engineMode??"classic")!==m)&&(v.engineMode=m);const g=_p(h),w={...It,...g??{}};h.macro=w,(m==="macro"||l.macro!==void 0||l.osc1?.macro!==void 0||l.osc2?.macro!==void 0)&&(v.macro=w),d!==void 0&&(v.modMatrix=d),a().engine?.applyPatch(v),r({patch:h})},setLayoutOrder:l=>r({layoutOrder:l}),setTempo:l=>r(u=>({tempo:l,transport:{...u.transport,tempo:l}})),setTransportPlaying:l=>r(u=>({transport:{...u.transport,playing:l,tick:0}})),bumpTransportTick:()=>r(l=>({transport:{...l.transport,tick:l.transport.tick+1}})),importPatch:l=>{const u=JSON.parse(l),d={...a().patch,...u,osc1:{...a().patch.osc1,...u.osc1},osc2:{...a().patch.osc2,...u.osc2},fm:{...a().patch.fm,...u.fm},sub:{...a().patch.sub,...u.sub},ring:{...a().patch.ring,...u.ring},filter:{...a().patch.filter,...u.filter},envelope:{...a().patch.envelope,...u.envelope},master:{...a().patch.master,...u.master},sampler:{...a().patch.sampler,...u.sampler},macro:{...a().patch.macro||I.macro,...u.macro},effects:{...a().patch.effects||I.effects,...u.effects},lfo1:{...a().patch.lfo1||I.lfo1,...u.lfo1},lfo2:{...a().patch.lfo2||I.lfo2,...u.lfo2},arp:{...a().patch.arp||I.arp,...u.arp},sequencer:{...a().patch.sequencer||I.sequencer,...u.sequencer},mix:u.mix!=null?u.mix:a().patch.mix,expression:{...a().patch.expression||I.expression,...u.expression},modMatrix:Array.isArray(u.modMatrix)?po(u.modMatrix):(a().patch.modMatrix??[]).map(f=>({...f}))};d.osc1=Wt(d.osc1),d.osc2=Wt(d.osc2),a().engine?.applyPatch(d),r({patch:d})},exportPatch:()=>JSON.stringify(a().patch,null,2),saveUserPreset:(l,u)=>{const d=l.trim();if(!d)return null;const f=(u??"").trim();let h=null;return r(x=>{const m=d.toLowerCase().replace(/[^a-z0-9]+/g,"-").replace(/^-+|-+$/g,""),v=m.length>0?`user-${m}`:`user-${Date.now().toString(36)}`,g=new Set(x.userPresets.map(j=>j.id));let w=v,k=1;for(;g.has(w);)w=`${v}-${k++}`;h=w;const M=Ip(x.patch),y={id:w,name:d,description:f.length>0?f:"Custom preset",createdAt:new Date().toISOString(),patch:M};return{userPresets:[...x.userPresets,y]}}),h},setMidiSupported:l=>r(u=>({midi:{...u.midi,supported:l}})),setMidiStatus:(l,u=null)=>r(d=>({midi:{...d.midi,status:l,lastError:u}})),setMidiEnabled:l=>r(u=>({midi:{...u.midi,enabled:l}})),setMidiInputs:l=>r(u=>({midi:{...u.midi,inputs:l}})),setMidiSelectedInput:l=>r(u=>({midi:{...u.midi,selectedInputId:l}})),setMidiActiveNotes:l=>r(u=>({midi:{...u.midi,activeNotes:l}})),setOscilloscopeFftSize:l=>r(u=>({oscilloscope:{fftSize:l}})),saveSamplerSample:(l,u)=>r(d=>{const f=u.id??`sample-${Date.now()}`,h={...kt,...u,id:f},x=d.samplerLibrary.filter(g=>g.id!==f).concat(h),m={...d.patch,[l]:Wt({...d.patch[l],mode:"sampler",sampler:h})},v={[l]:{mode:"sampler",sampler:h}};return m.sampler=h,v.sampler=h,d.engine?.applyPatch(v),{samplerLibrary:x,patch:m}}),deleteSamplerSample:l=>r(u=>{const d=u.samplerLibrary.filter(x=>x.id!==l),f={...u.patch},h={};if(["osc1","osc2"].forEach(x=>{if(f[x].sampler?.id===l){const m={...kt};f[x]=Wt({...f[x],sampler:m}),h[x]={sampler:m}}}),f.sampler?.id===l){const x={...kt};f.sampler=x,h.sampler=x}return Object.keys(h).length>0&&u.engine?.applyPatch(h),{samplerLibrary:d,patch:f}}),setSamplerFromLibrary:(l,u)=>r(d=>{const f=d.samplerLibrary.find(v=>v.id===u);if(!f)return{};const h={...kt,...f},x={...d.patch,[l]:Wt({...d.patch[l],mode:"sampler",sampler:h})},m={[l]:{mode:"sampler",sampler:h}};return x.sampler=h,m.sampler=h,d.engine?.applyPatch(m),{patch:x}}),updateCurrentSampler:(l,u)=>r(d=>{const h={...{...kt,...d.patch[l].sampler??{}},...u},x={...d.patch,[l]:Wt({...d.patch[l],sampler:h})},m={[l]:{sampler:h}};x.sampler=h,m.sampler=h,d.engine?.applyPatch(m);const v=h.id?d.samplerLibrary.map(g=>g.id===h.id?{...g,...u}:g):d.samplerLibrary;return{patch:x,samplerLibrary:v}}),renameSamplerSample:(l,u)=>r(d=>{const f=u.trim();if(!f)return{};let h=!1;const x=d.samplerLibrary.map(g=>g.id!==l?g:(h=!0,{...g,name:f}));if(!h)return{};const m={...d.patch},v={};if(["osc1","osc2"].forEach(g=>{if(m[g].sampler?.id===l){const w={...m[g].sampler,name:f};m[g]=Wt({...m[g],sampler:w}),v[g]={sampler:w}}}),m.sampler?.id===l){const g={...m.sampler,name:f};m.sampler=g,v.sampler=g}return Object.keys(v).length>0&&d.engine?.applyPatch(v),{samplerLibrary:x,patch:m}}),playSamplerPreview:l=>{const u=a().engine;u&&u.previewSampler(l)},resetPatch:()=>r(l=>(l.engine?.applyPatch(I),{patch:I,samplerLibrary:l.samplerLibrary})),addModRoute:()=>{const l=a().patch.modMatrix??[];if(l.length>=16)return;const u={id:wi(),source:"lfo1",target:"filter.cutoff",amount:.5,enabled:!0},d=[...l.map(f=>({...f})),u];a().updatePatch({modMatrix:d})},updateModRoute:(l,u)=>{const d=(a().patch.modMatrix??[]).map(f=>f.id===l?Uu({...f,...u},f.id):f);a().updatePatch({modMatrix:d})},removeModRoute:l=>{const u=(a().patch.modMatrix??[]).filter(d=>d.id!==l);a().updatePatch({modMatrix:u})}}),{name:"websynth-patch",partialize:r=>({patch:{...r.patch,sequencer:r.patch.sequencer?{...r.patch.sequencer,playing:!1}:r.patch.sequencer,arp:r.patch.arp?{...r.patch.arp,bpmSync:r.patch.arp.bpmSync??!0}:r.patch.arp},userPresets:r.userPresets,samplerLibrary:r.samplerLibrary,layoutOrder:r.layoutOrder,tempo:r.tempo,transport:{tempo:r.transport.tempo,playing:!1,tick:0},midi:{enabled:r.midi.enabled,selectedInputId:r.midi.selectedInputId},oscilloscope:r.oscilloscope}),version:11,migrate:(r,a)=>{const l=r?.patch;if(!l)return r;const u=l.osc1||{},{finePct:d,...f}=u,h={...I,...l,osc1:{...I.osc1,...f},osc2:{...I.osc2,...l.osc2||{}},fm:{...I.fm,...l.fm||{}},sub:{...I.sub,...l.sub||{}},ring:{...I.ring,...l.ring||{}},filter:{...I.filter,...l.filter||{}},envelope:{...I.envelope,...l.envelope||{}},master:{...I.master,...l.master||{}},sampler:{...I.sampler,...l.sampler||{}},macro:{...I.macro,...l.macro||{}},effects:{...I.effects,...l.effects||{}},lfo1:{...I.lfo1,...l.lfo1||{}},lfo2:{...I.lfo2,...l.lfo2||{}},arp:{...I.arp,...l.arp||{}},sequencer:{...I.sequencer,...l.sequencer||{}},mix:typeof l.mix=="number"?l.mix:I.mix,expression:{...I.expression,...l.expression||{}},modMatrix:Array.isArray(l.modMatrix)?po(l.modMatrix):[]},x=Array.isArray(r?.layoutOrder)?r.layoutOrder.filter(R=>typeof R=="string"):[],m=typeof r?.tempo=="number"?r.tempo:110,v=r?.transport,g=v?{tempo:v.tempo??m,playing:!1,tick:0}:{tempo:m,playing:!1,tick:0},w=r?.midi,k={supported:null,status:"idle",enabled:w?.enabled??!1,inputs:[],selectedInputId:w?.selectedInputId??null,lastError:null,activeNotes:[]},M=Array.isArray(r?.samplerLibrary)?r.samplerLibrary.map((R,X)=>({...I.sampler,...R??{},id:typeof R?.id=="string"?R.id:`legacy-${Date.now()}-${X}`})):[],y=Array.isArray(r?.userPresets)?r.userPresets.map((R,X)=>{const J=typeof R?.name=="string"&&R.name.trim().length>0?R.name.trim():`Custom Preset ${X+1}`,V=typeof R?.description=="string"?R.description:"Custom preset",E=typeof R?.id=="string"&&R.id.trim().length>0?R.id.trim():`user-${Date.now()}-${X}`,A=typeof R?.createdAt=="string"?R.createdAt:new Date().toISOString(),z=R?.patch&&typeof R.patch=="object"?R.patch:I,$={...I,...z};return $.osc1=Wt($.osc1),$.osc2=Wt($.osc2),$.modMatrix=Array.isArray(z?.modMatrix)?po(z.modMatrix):($.modMatrix??[]).map(pe=>({...pe})),{id:E,name:J,description:V,createdAt:A,patch:$}}):[],j=[1024,2048,4096,8192],N=r?.oscilloscope?.fftSize,_=j.includes(N)?N:4096;return{...r,patch:h,samplerLibrary:M,userPresets:y,layoutOrder:x,tempo:m,transport:g,midi:k,oscilloscope:{fftSize:_}}},onRehydrateStorage:()=>r=>{r&&(r.engine=null,(!r.oscilloscope||![1024,2048,4096,8192].includes(r.oscilloscope.fftSize))&&(r.oscilloscope={fftSize:4096}),Array.isArray(r.layoutOrder)||(r.layoutOrder=[]),typeof r.tempo!="number"&&(r.tempo=110),r.transport||(r.transport={tempo:r.tempo,playing:!1,tick:0}),r.midi?r.midi={supported:null,status:"idle",enabled:!!r.midi.enabled,inputs:[],selectedInputId:r.midi.selectedInputId??null,lastError:null,activeNotes:[]}:r.midi={supported:null,status:"idle",enabled:!1,inputs:[],selectedInputId:null,lastError:null,activeNotes:[]},Array.isArray(r.userPresets)||(r.userPresets=[]))}}));function Te({value:r,min:a,max:l,step:u=.01,size:d=56,label:f,hint:h,formatValue:x,onChange:m,disabled:v=!1,showValue:g=!0}){const[w,k]=Q.useState(!1),M=Q.useRef(null),y=Q.useCallback(Z=>Math.min(l,Math.max(a,Z)),[a,l]),j=l-a,N=j===0?0:(r-a)/j,_=Q.useMemo(()=>-135+N*270,[N]),R=x?x(r):Ap(r),X=Z=>{v||(Z.currentTarget.setPointerCapture(Z.pointerId),M.current={y:Z.clientY,v:r},k(!0))},J=Z=>{if(!M.current||v)return;if(Z.buttons===0){M.current=null,k(!1);try{Z.currentTarget.releasePointerCapture(Z.pointerId)}catch{}return}const D=(M.current.y-Z.clientY)/150*j,F=y(M.current.v+D);m(mi(F,u))},V=Z=>{if(!v){try{Z.currentTarget.releasePointerCapture(Z.pointerId)}catch{}M.current=null,k(!1)}},E=Z=>{if(v)return;const B=u;(Z.key==="ArrowUp"||Z.key==="ArrowRight")&&m(y(mi(r+B,B))),(Z.key==="ArrowDown"||Z.key==="ArrowLeft")&&m(y(mi(r-B,B)))},A=d/2-6,z=d/2,$=d/2,pe=-135,Ce=z+Math.cos(pe*Math.PI/180)*(A+6),he=$+Math.sin(pe*Math.PI/180)*(A+6),te=z+Math.cos(_*Math.PI/180)*(A-6),ce=$+Math.sin(_*Math.PI/180)*(A-6);return i.jsxs("div",{style:{display:"inline-flex",flexDirection:"column",alignItems:"center",gap:6,opacity:v?.4:1,pointerEvents:v?"none":"auto",width:d},title:h,children:[i.jsxs("svg",{width:d,height:d,onPointerDown:X,onPointerMove:J,onPointerUp:V,onKeyDown:E,role:"slider","aria-label":f,"aria-valuemin":a,"aria-valuemax":l,"aria-valuenow":r,"aria-valuetext":R,"aria-description":h,tabIndex:v?-1:0,style:{cursor:v?"default":"ns-resize",outline:w?"1px solid var(--accent)":"none",borderRadius:8},children:[i.jsx("circle",{cx:z,cy:$,r:A,fill:"#0f1217",stroke:"#2a3040"}),i.jsx("circle",{cx:z,cy:$,r:A-8,fill:"#161a22",stroke:"#202635"}),i.jsx("circle",{cx:Ce,cy:he,r:2.4,fill:"#3dd973",stroke:"#12161f",strokeWidth:.8}),i.jsx("line",{x1:z,y1:$,x2:te,y2:ce,stroke:"var(--accent)",strokeWidth:3,strokeLinecap:"round"})]}),(f||g)&&i.jsxs("div",{className:"knob-legend",children:[f?i.jsx("span",{className:"label",children:f}):null,g?i.jsx("span",{className:"value",children:R}):null]})]})}function mi(r,a){const l=1/a;return Math.round(r*l)/l}function Ap(r){return Math.abs(r)>=100?r.toFixed(0):Math.abs(r)>=10?r.toFixed(1):r.toFixed(2)}const Fp=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"],ur=10,zp=Array.from({length:61},(r,a)=>{const l=36+a,u=Fp[l%12],d=Math.floor(l/12)-1;return{midi:l,label:`${u}${d}`}}),Dp=()=>typeof crypto<"u"&&typeof crypto.randomUUID=="function"?crypto.randomUUID():`sample-${Date.now()}-${Math.random().toString(16).slice(2)}`,Pu=(r,a)=>{const l=(r??"").trim();return l?l.slice(0,ur):a},qp=()=>`REC-${Math.floor(Date.now()%1e6).toString(36).toUpperCase().padStart(4,"0")}`.slice(0,ur),Bp=r=>{const l=r.replace(/\.[^/.]+$/,"").replace(/[^A-Za-z0-9_-]/g,"").toUpperCase();return l?l.slice(0,ur):"SAMPLE"},Up=r=>{const a={...kt,...r??{}},l=typeof a.durationSec=="number"&&a.durationSec>0?a.durationSec:0;if(l===0)return{...a,durationSec:0,trimStartSec:0,trimEndSec:0};const u=.005,d=Math.max(0,l-u),f=Number(a.trimStartSec),h=Math.min(Math.max(Number.isFinite(f)?f:0,0),d),x=Number(a.trimEndSec);let m=Number.isFinite(x)?x:l;return m-h<u&&(m=l),m=Math.min(Math.max(m,h+u),l),{...a,durationSec:l,trimStartSec:h,trimEndSec:m}},ho=r=>{const a=Math.max(0,r),l=Math.floor(a/60),u=Math.floor(a%60);return`${String(l).padStart(2,"0")}:${String(u).padStart(2,"0")}`};function Hp({oscillator:r="osc1"}){const a=ne(K=>K.patch[r].sampler),l=ne(K=>K.samplerLibrary),u=ne(K=>K.saveSamplerSample),d=ne(K=>K.deleteSamplerSample),f=ne(K=>K.setSamplerFromLibrary),h=ne(K=>K.updateCurrentSampler),x=ne(K=>K.renameSamplerSample),m=ne(K=>K.playSamplerPreview),[v,g]=Q.useState(null),[w,k]=Q.useState(!1),[M,y]=Q.useState(!1),[j,N]=Q.useState(0),[_,R]=Q.useState(!1),X=Q.useRef(null),J=Q.useRef(null),V=Q.useRef(null),E=Q.useRef([]),A=Q.useRef(null),z=Q.useRef(null),$=Q.useRef(null),[pe,Ce]=Q.useState(null),[he,te]=Q.useState(""),Z=Q.useMemo(()=>typeof window<"u"?typeof window.MediaRecorder<"u":!1,[])&&typeof navigator<"u"&&!!navigator.mediaDevices?.getUserMedia,B=Q.useCallback(()=>{V.current&&(V.current.getTracks().forEach(K=>{try{K.stop()}catch{}}),V.current=null),J.current=null},[]),D=Q.useCallback(async()=>{if(typeof window>"u")return null;if(!$.current)try{$.current=new AudioContext}catch(me){return g(me instanceof Error?me.message:"Unable to create AudioContext"),null}const K=$.current;if(K&&K.state==="suspended")try{await K.resume()}catch{}return K},[]),F=Q.useCallback(async K=>{const me=await D();if(!me)return null;try{const ye=await(await fetch(K)).arrayBuffer();return(await me.decodeAudioData(ye.slice(0))).duration}catch(je){return g(je instanceof Error?je.message:"Unable to decode audio"),null}},[D]),U=Up(a),G=Q.useCallback(async(K,me)=>{k(!0),g(null);try{const je=await F(K);if(je==null)return;const ye=je>0?je:0,Ne={id:Dp(),name:Pu(me,"SAMPLE"),dataUrl:K,recordedAt:Date.now(),durationSec:ye,trimStartSec:0,trimEndSec:ye,loop:U.loop,rootMidi:U.rootMidi};u(r,Ne)}finally{k(!1)}},[r,U.loop,U.rootMidi,F,u]),P=Q.useCallback((K,me)=>{const je=new FileReader;je.onloadend=()=>{const ye=je.result;typeof ye=="string"?G(ye,me):g("Unable to read recording data")},je.onerror=()=>{g("Failed to read recorded audio")},je.readAsDataURL(K)},[G]),q=Q.useCallback(()=>{const K=J.current;if(K&&K.state!=="inactive"){try{K.stop()}catch{}y(!1),A.current=null}},[]),xe=async()=>{if(!(!Z||M||w)){g(null);try{const K=await navigator.mediaDevices.getUserMedia({audio:!0}),me=window.MediaRecorder,je=new me(K);E.current=[],je.ondataavailable=ye=>{ye.data&&ye.data.size>0&&E.current.push(ye.data)},je.onerror=ye=>{const Ne=ye?.error?.message??"Recording error";g(Ne),q()},je.onstop=()=>{y(!1);const ye=new Blob(E.current,{type:E.current[0]?.type||"audio/webm"});E.current=[],B(),ye.size>0&&P(ye,qp())},je.start(),J.current=je,V.current=K,y(!0),A.current=performance.now(),N(0),R(!0)}catch(K){B(),y(!1),A.current=null,g(K instanceof Error?K.message:"Microphone access denied")}}},ge=Q.useCallback(K=>{const me=new FileReader;me.onloadend=()=>{const je=me.result;typeof je=="string"?G(je,Bp(K.name)):g("Unable to read file")},me.onerror=()=>g("Unable to load file"),me.readAsDataURL(K)},[G]),ke=K=>{const me=K.target.files?.[0];me&&ge(me),K.target&&(K.target.value="")};Q.useEffect(()=>()=>{q(),B()},[B,q]),Q.useEffect(()=>(M?(z.current!=null&&window.clearInterval(z.current),z.current=window.setInterval(()=>{if(A.current!=null){const K=(performance.now()-A.current)/1e3;N(K),R(me=>!me)}},500)):(z.current!=null&&(window.clearInterval(z.current),z.current=null),N(0),R(!1)),()=>{z.current!=null&&(window.clearInterval(z.current),z.current=null)}),[M]);const ue=U.durationSec??0,Se=!!U.dataUrl&&ue>0,Me=U.trimStartSec??0,Pe=U.trimEndSec??ue,ae=K=>{if(!Se)return;const me=Math.max(0,Math.min(K,ue)),ye=Math.max(me+.005,Pe);h(r,{trimStartSec:me,trimEndSec:Math.min(ye,ue)})},Be=K=>{if(!Se)return;const me=Math.max(0,Math.min(K,ue)),je=.005,ye=Math.min(Me,me-je),Ne=Math.max(0,Math.min(ye,ue)),_e=Math.min(ue,Math.max(me,je));h(r,{trimStartSec:Math.max(Ne,0),trimEndSec:_e})},We=Q.useCallback(K=>{if(typeof window>"u"||!K.dataUrl)return;const me=document.createElement("a");me.href=K.dataUrl;const je=K.dataUrl.split(";")[0]?.split(":")[1]??"audio/webm",ye=je.includes("/")?je.split("/")[1]:"webm",Ne=(K.name||"sample").replace(/[^a-z0-9_\-]+/gi,"_");me.download=`${Ne}.${ye}`,document.body.appendChild(me),me.click(),document.body.removeChild(me)},[]),Xe=Q.useCallback(()=>{if(typeof window>"u"||l.length===0)return;const K=JSON.stringify(l.map(Ne=>({...Ne,recordedAt:Ne.recordedAt??null})),null,2),me=new Blob([K],{type:"application/json"}),je=URL.createObjectURL(me),ye=document.createElement("a");ye.href=je,ye.download=`sampler-library-${new Date().toISOString().replace(/[:.]/g,"-")}.json`,document.body.appendChild(ye),ye.click(),document.body.removeChild(ye),URL.revokeObjectURL(je)},[l]),dt=Q.useCallback(()=>{Ce(null),te("")},[]),At=Q.useCallback(()=>{if(!pe)return;const K=he.trim();K&&(x(pe,Pu(K,"SAMPLE")),Ce(null),te(""))},[pe,he,x]);return i.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:12,padding:"0 0 8px"},children:[i.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:8},children:[i.jsx("div",{className:"label",children:"Sampler"}),i.jsxs("div",{style:{display:"flex",gap:8,flexWrap:"wrap",alignItems:"center"},children:[i.jsx("button",{type:"button",onClick:()=>X.current?.click(),disabled:w,children:w?"Loading...":"Load Sample"}),i.jsx("button",{type:"button",onClick:()=>m(r),disabled:!U.dataUrl||w,children:"Play"}),i.jsx("button",{type:"button",onClick:M?q:xe,disabled:!Z||w,children:M?"Stop Recording":"Record"}),i.jsx("button",{type:"button",onClick:()=>{h(r,{id:null,name:kt.name,dataUrl:null,recordedAt:void 0,durationSec:0,trimStartSec:0,trimEndSec:0,loop:kt.loop,rootMidi:kt.rootMidi}),g(null)},disabled:!U.dataUrl,children:"Clear"})]}),i.jsx("input",{ref:X,type:"file",accept:"audio/*",style:{display:"none"},onChange:ke,disabled:w})]}),M&&i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[i.jsx("span",{style:{width:12,height:12,borderRadius:"50%",backgroundColor:_?"#ff4d4f":"#ffb3b8",boxShadow:_?"0 0 8px rgba(255,77,79,0.8)":"none",transition:"background-color 0.2s linear, box-shadow 0.2s linear"}}),i.jsxs("span",{style:{fontFamily:"monospace",fontSize:12},children:["Recording ",ho(j)]})]}),i.jsxs("div",{style:{fontSize:12,color:"var(--muted)",display:"flex",flexWrap:"wrap",gap:8},children:[i.jsxs("span",{children:[i.jsx("span",{className:"label",style:{marginRight:4},children:"Current"}),i.jsx("span",{style:{maxWidth:`${ur}ch`,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",display:"inline-block",verticalAlign:"bottom"},title:U.dataUrl?U.name:void 0,children:U.dataUrl?U.name:"No sample loaded"})]}),Se&&i.jsxs("span",{children:["Length ",ho(ue)," · Window ",ho(Pe-Me)]}),!Z&&i.jsx("span",{children:"(Recording unsupported in this browser)"})]}),v&&i.jsx("div",{style:{color:"var(--danger, #d14343)",fontSize:12},children:v}),i.jsxs("div",{style:{display:"flex",gap:16,flexWrap:"wrap",alignItems:"center"},children:[i.jsxs("label",{children:[i.jsx("span",{className:"label",children:"Root Note"}),i.jsx("select",{value:U.rootMidi,onChange:K=>h(r,{rootMidi:Number(K.target.value)}),children:zp.map(K=>i.jsx("option",{value:K.midi,children:K.label},K.midi))})]}),i.jsxs("label",{style:{display:"flex",alignItems:"center",gap:8},children:[i.jsx("input",{type:"checkbox",checked:!!U.loop,onChange:K=>h(r,{loop:K.target.checked})}),"Loop playback"]})]}),Se&&i.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:12},children:[i.jsx("div",{className:"label",children:"Trim"}),i.jsxs("div",{style:{display:"grid",gap:8,gridTemplateColumns:"repeat(auto-fit, minmax(180px, 1fr))"},children:[i.jsxs("label",{style:{display:"flex",flexDirection:"column",gap:4},children:[i.jsxs("span",{style:{fontSize:12,color:"var(--muted)"},children:["Start ",Math.round(Me*1e3)," ms"]}),i.jsx("input",{type:"range",min:0,max:Math.max(ue*1e3,5),step:5,value:Math.round(Me*1e3),onChange:K=>ae(Number(K.target.value)/1e3)})]}),i.jsxs("label",{style:{display:"flex",flexDirection:"column",gap:4},children:[i.jsxs("span",{style:{fontSize:12,color:"var(--muted)"},children:["End ",Math.round(Pe*1e3)," ms"]}),i.jsx("input",{type:"range",min:5,max:Math.max(ue*1e3,5),step:5,value:Math.round(Pe*1e3),onChange:K=>Be(Number(K.target.value)/1e3)})]})]})]}),l.length>0&&i.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:8},children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",gap:8},children:[i.jsx("div",{className:"label",children:"Library"}),i.jsx("button",{type:"button",onClick:Xe,style:{fontSize:12},children:"Export Library"})]}),i.jsx("div",{style:{display:"flex",flexDirection:"column",gap:8},children:l.map(K=>{if(!K.id)return null;const me=K.id===U.id,je=pe===K.id;return i.jsxs("div",{style:{display:"flex",flexWrap:"wrap",alignItems:"center",justifyContent:"space-between",gap:8,padding:"6px 8px",borderRadius:6,background:me?"rgba(255, 77, 79, 0.1)":"rgba(255,255,255,0.04)"},children:[i.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:4,minWidth:160},children:[je?i.jsx("input",{value:he,onChange:ye=>te(ye.target.value),onKeyDown:ye=>{ye.key==="Enter"&&(ye.preventDefault(),At()),ye.key==="Escape"&&(ye.preventDefault(),dt())},autoFocus:!0,maxLength:ur}):i.jsx("span",{style:{fontWeight:600,maxWidth:`${ur}ch`,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},title:K.name||"Sample",children:K.name||"Sample"}),i.jsxs("span",{style:{fontSize:12,color:"var(--muted)"},children:[ho(K.durationSec??0)," ",me?"· Active":""]})]}),i.jsx("div",{style:{display:"flex",gap:8},children:je?i.jsxs(i.Fragment,{children:[i.jsx("button",{type:"button",onClick:At,disabled:!he.trim(),children:"Save"}),i.jsx("button",{type:"button",onClick:dt,children:"Cancel"})]}):i.jsxs(i.Fragment,{children:[i.jsx("button",{type:"button",onClick:()=>f(r,K.id),disabled:me,children:me?"In Use":"Use"}),i.jsx("button",{type:"button",onClick:()=>{Ce(K.id),te(K.name||"")},children:"Rename"}),i.jsx("button",{type:"button",onClick:()=>We(K),disabled:!K.dataUrl,children:"Export"}),i.jsx("button",{type:"button",onClick:()=>d(K.id),style:{color:"var(--danger, #d14343)"},children:"Delete"})]})})]},K.id)})})]})]})}const Vp=[{value:"analog",label:"Analog"},{value:"macro",label:"Macro"},{value:"sampler",label:"Sampler"}],Tu={va:"VA",fold:"Wavefold",pluck:"Pluck",supersaw:"Supersaw",pwm:"PWM",fm2op:"FM 2-Op",wavetable:"Wavetable",harmonic:"Harmonic",chord:"Chord Stack",dirichlet:"Dirichlet Pulse",formant:"Formant"},Wp={va:"https://en.wikipedia.org/wiki/Subtractive_synthesis",fold:"https://en.wikipedia.org/wiki/Waveshaping",pluck:"https://en.wikipedia.org/wiki/Karplus%E2%80%93Strong_string_synthesis",supersaw:"https://en.wikipedia.org/wiki/Supersaw_(synthesizer)",pwm:"https://en.wikipedia.org/wiki/Pulse-width_modulation",fm2op:"https://en.wikipedia.org/wiki/Frequency_modulation_synthesis",wavetable:"https://en.wikipedia.org/wiki/Wavetable_synthesis",harmonic:"https://en.wikipedia.org/wiki/Additive_synthesis",chord:"https://en.wikipedia.org/wiki/Chord_(music)",dirichlet:"https://en.wikipedia.org/wiki/Dirichlet_kernel",formant:"https://en.wikipedia.org/wiki/Formant"},$p=["va","fold","pluck","supersaw","pwm","fm2op","wavetable","harmonic","chord","dirichlet","formant"],Gp={va:{summary:"Triangle/saw hybrid with simple low-pass tone control.",harmonics:{label:"Tone",hint:"Sets low-pass cutoff; higher adds brightness."},timbre:{label:"Blend",hint:"Crossfades triangle ↔ sawtooth balance."},morph:{label:"Shape",hint:"Reserved for future tweaks; minimal impact today."}},fold:{summary:"Wavefolder voice with controllable drive and symmetry.",harmonics:{label:"Drive",hint:"Increase folding depth to add upper harmonics."},timbre:{label:"Brightness",hint:"Post-filter to tame or open the highs."},morph:{label:"Symmetry",hint:"Offset folding symmetry for odd/even emphasis."}},pluck:{summary:"Karplus-Strong burst with damped feedback.",harmonics:{label:"Decay",hint:"Feedback amount controlling sustain length."},timbre:{label:"Damping",hint:"Low-pass filter inside the loop for darker plucks."},morph:{label:"Body HP",hint:"Pre high-pass to thin or warm the attack."}},supersaw:{summary:"Six detuned saws with tone and stereo spread.",harmonics:{label:"Spread",hint:"Detune range distributed across the stack."},timbre:{label:"Brightness",hint:"Low-pass the swarm to soften or brighten."},morph:{label:"Stereo",hint:"Pan spread from narrow mono to wide field."}},pwm:{summary:"Pulse made from tanh-shaped saw for animated PWM tones.",harmonics:{label:"Edge",hint:"Tanh drive for sharper edges and richer harmonics."},timbre:{label:"Brightness",hint:"Low-pass shaper output to control fizz."},morph:{label:"Pulse Width",hint:"Duty cycle sweep from roughly 10% to 90%."}},fm2op:{summary:"Sine carrier with modulator FM for glassy to harsh tones.",harmonics:{label:"Ratio",hint:"Modulator:carrier ratio from 0.25× up to 8×."},timbre:{label:"Amount",hint:"FM depth adds sidebands and grit."},morph:{label:"Tone",hint:"Low-pass filter to smooth bright spectra."}},wavetable:{summary:"Morph between sine, triangle, saw, and square.",harmonics:{label:"Brightness",hint:"Low-pass cutoff governing top-end energy."},timbre:{label:"Resonance",hint:"Boost Q for a sharper or flatter peak."},morph:{label:"Shape Blend",hint:"Scan through the wavetable continuum."}},harmonic:{summary:"Additive bank with controllable partial count and tilt.",harmonics:{label:"Partials",hint:"Number of sine partials mixed together."},timbre:{label:"Tilt",hint:"Shift energy toward darker or brighter spectra."},morph:{label:"Odd / Even",hint:"Bias emphasis toward odd or even harmonics."}},chord:{summary:"Voicing generator stacking detuned chord tones.",harmonics:{label:"Chord Set",hint:"Selects the chord recipe around the played note."},timbre:{label:"Brightness",hint:"Low-pass filter across the chord stack."},morph:{label:"Spread",hint:"Detune and stereo spread amount."}},dirichlet:{summary:"Dirichlet pulse oscillator with adjustable width and skew.",harmonics:{label:"Partials",hint:"Upper harmonic count while staying anti-aliased."},timbre:{label:"Width",hint:"Pulse width from narrow hollow tones to square-like."},morph:{label:"Skew",hint:"Phase skew for asymmetry and transient emphasis."}},formant:{summary:"Stacked, phase-aligned formants for vowel pads and choirs.",harmonics:{label:"Spacing",hint:"Scales formant frequency spacing and height."},timbre:{label:"Resonance",hint:"Boosts formant Q for sharper vowels."},morph:{label:"Vowel Sweep",hint:"Blend between stored vowel targets."}}},Qp=[{value:"sine",label:"Sine"},{value:"square",label:"Square"},{value:"sawtooth",label:"Saw"},{value:"triangle",label:"Triangle"},{value:"noise",label:"Noise"}],Kp={osc1:"ENG1",osc2:"ENG2"},Xp="Adjusts macro output gain before it mixes with the other voices.";function Yp(){const r=ne(g=>g.patch),a=ne(g=>g.updatePatch),l=qe.useCallback((g,w)=>{a({[g]:w})},[a]),u=qe.useCallback((g,w)=>{l(g,{mode:w})},[l]),d=qe.useCallback((g,w)=>{const k=r[g].macro??It;l(g,{macro:{...k,...w}})},[r,l]),f=g=>{const w=r[g],k=w.mode??"analog",M=w.macro??It;return i.jsxs("div",{className:"osc-section",style:{display:"grid",gap:12},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",gap:8},children:[i.jsx("h4",{className:"settings-heading",style:{margin:0},children:Kp[g]}),i.jsx("select",{value:k,onChange:y=>u(g,y.target.value),children:Vp.map(y=>i.jsx("option",{value:y.value,children:y.label},y.value))})]}),k==="analog"&&i.jsxs(i.Fragment,{children:[i.jsxs("label",{children:[i.jsx("div",{className:"label",children:"Wave"}),i.jsx("select",{value:w.wave??"sawtooth",onChange:y=>l(g,{wave:y.target.value}),children:Qp.map(y=>i.jsx("option",{value:y.value,children:y.label},y.value))})]}),i.jsxs("div",{className:"osc-knob-row",children:[i.jsx("div",{className:"knob-group",children:i.jsx(Te,{label:"Octave",min:-2,max:2,step:1,value:w.octave??0,onChange:y=>l(g,{octave:Math.round(y)}),formatValue:y=>`${Math.round(y)}`})}),i.jsx("div",{className:"knob-group",children:i.jsx(Te,{label:"Detune",min:-1200,max:1200,step:1,value:w.detune,onChange:y=>l(g,{detune:y}),formatValue:y=>`${Math.round(y)}¢`})}),i.jsx("div",{className:"knob-group",children:i.jsx(Te,{label:"Fine",min:-10,max:10,step:.1,value:w.detuneFine??0,onChange:y=>l(g,{detuneFine:Number(y.toFixed(1))}),formatValue:y=>`${y.toFixed(1)}¢`})})]})]}),k==="macro"&&i.jsxs(i.Fragment,{children:[i.jsxs("label",{children:[i.jsx("div",{className:"label",children:"Model"}),i.jsx("select",{value:M.model??"va",onChange:y=>d(g,{model:y.target.value}),children:$p.map(y=>i.jsx("option",{value:y,children:Tu[y]},y))})]}),(()=>{const y=M.model??"va",j=Gp[y],N=Tu[y];return i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:"osc-knob-row",children:[i.jsx(Te,{label:j.harmonics.label,hint:j.harmonics.hint,min:0,max:1,step:.001,value:M.harmonics??.6,onChange:_=>d(g,{harmonics:_})}),i.jsx(Te,{label:j.timbre.label,hint:j.timbre.hint,min:0,max:1,step:.001,value:M.timbre??.5,onChange:_=>d(g,{timbre:_})}),i.jsx(Te,{label:j.morph.label,hint:j.morph.hint,min:0,max:1,step:.001,value:M.morph??.5,onChange:_=>d(g,{morph:_})}),i.jsx(Te,{label:"Level",hint:Xp,min:0,max:1,step:.001,value:M.level??1,onChange:_=>d(g,{level:_})})]}),i.jsxs("div",{style:{marginTop:6,fontSize:12,color:"var(--muted)",lineHeight:1.5},children:[i.jsx("strong",{style:{fontSize:11,letterSpacing:.4},children:i.jsxs("a",{className:"macro-model-link",href:Wp[y],target:"_blank",rel:"noreferrer",children:[i.jsx("span",{children:N}),i.jsx("svg",{viewBox:"0 0 12 12","aria-hidden":"true",focusable:"false",children:i.jsx("path",{d:"M4 3.25a.75.75 0 0 1 .75-.75H9a.75.75 0 0 1 .75.75v4.25a.75.75 0 0 1-1.5 0V4.81l-4.22 4.22a.75.75 0 0 1-1.06-1.06L7.19 3.75H4.75A.75.75 0 0 1 4 3.25Z"})})]})})," – ",j.summary]})]})})()]}),k==="sampler"&&i.jsx(Hp,{oscillator:g})]},g)},h=r.osc1.mode??"analog",x=r.osc2.mode??"analog",m=h==="analog"&&x==="analog",v=m;return i.jsxs("div",{style:{display:"grid",gap:16},children:[i.jsx("div",{className:"controls-grid",style:{gridTemplateColumns:"repeat(auto-fit, minmax(240px, 1fr))",gap:16},children:["osc1","osc2"].map(f)}),i.jsxs("div",{className:"osc-knob-row",style:{justifyContent:"flex-start"},children:[i.jsx("div",{className:"knob-group",children:i.jsx(Te,{label:"Mix",min:0,max:1,step:.01,value:r.mix,onChange:g=>a({mix:g}),formatValue:g=>`${Math.round(g*100)}%`})}),i.jsxs("label",{style:{display:"flex",alignItems:"center",gap:8,minWidth:120,opacity:m?1:.5},children:[i.jsx("input",{type:"checkbox",checked:r.fm.enabled&&m,disabled:!m,onChange:g=>a({fm:{...r.fm,enabled:g.target.checked}})}),i.jsx("span",{className:"label",children:"FM"})]}),i.jsx(Te,{label:"Ratio",min:.1,max:8,step:.1,value:r.fm.ratio,onChange:g=>a({fm:{...r.fm,ratio:g}}),disabled:!m||!r.fm.enabled}),i.jsx(Te,{label:"Amount (Hz)",min:0,max:1e3,step:1,value:r.fm.amount,onChange:g=>a({fm:{...r.fm,amount:g}}),disabled:!m||!r.fm.enabled}),i.jsxs("label",{style:{display:"flex",alignItems:"center",gap:8,minWidth:120,opacity:v?1:.5},children:[i.jsx("input",{type:"checkbox",checked:r.ring.enabled&&v,disabled:!v,onChange:g=>a({ring:{...r.ring,enabled:g.target.checked}})}),i.jsx("span",{className:"label",children:"Ring"})]}),i.jsx(Te,{label:"Amount",min:0,max:1,step:.01,value:r.ring.amount,onChange:g=>a({ring:{...r.ring,amount:g}}),disabled:!v||!r.ring.enabled})]})]})}function Jp(){const r=ne(d=>d.patch),a=ne(d=>d.updatePatch),l=d=>{a({filter:{...r.filter,...d}})},u=r.master.gain;return i.jsxs("div",{className:"filter-panel",children:[i.jsxs("label",{className:"filter-type",children:[i.jsx("span",{className:"label",children:"Filter Type"}),i.jsxs("select",{value:r.filter.type,onChange:d=>l({type:d.target.value}),children:[i.jsx("option",{value:"lowpass",children:"Low-pass"}),i.jsx("option",{value:"highpass",children:"High-pass"}),i.jsx("option",{value:"bandpass",children:"Band-pass"}),i.jsx("option",{value:"notch",children:"Notch"})]})]}),i.jsxs("div",{className:"filter-knobs",children:[i.jsx("div",{className:"knob-group",children:i.jsx(Te,{label:"Cutoff",min:40,max:8e3,step:10,value:r.filter.cutoff,onChange:d=>l({cutoff:d}),formatValue:d=>`${Math.round(d)} Hz`})}),i.jsx("div",{className:"knob-group",children:i.jsx(Te,{label:"Resonance",min:0,max:10,step:.1,value:r.filter.q,onChange:d=>l({q:d}),formatValue:d=>d.toFixed(2)})}),i.jsx("div",{className:"knob-group",children:i.jsx(Te,{label:"Master",min:0,max:1,step:.01,value:u,onChange:d=>a({master:{...r.master,gain:d}}),formatValue:d=>d.toFixed(2)})})]})]})}function Zp(){const r=ne(u=>u.patch),a=ne(u=>u.updatePatch),l=r.envelope;return i.jsx("div",{className:"envelope-panel",children:i.jsxs("div",{className:"envelope-knobs",children:[i.jsx("div",{className:"knob-group",children:i.jsx(Te,{label:"Attack",min:0,max:2,step:.01,value:l.attack,onChange:u=>a({envelope:{...l,attack:u}})})}),i.jsx("div",{className:"knob-group",children:i.jsx(Te,{label:"Decay",min:0,max:2,step:.01,value:l.decay,onChange:u=>a({envelope:{...l,decay:u}})})}),i.jsx("div",{className:"knob-group",children:i.jsx(Te,{label:"Sustain",min:0,max:1,step:.01,value:l.sustain,onChange:u=>a({envelope:{...l,sustain:u}})})}),i.jsx("div",{className:"knob-group",children:i.jsx(Te,{label:"Release",min:0,max:3,step:.01,value:l.release,onChange:u=>a({envelope:{...l,release:u}})})})]})})}const eh=[0,2,4,5,7,9,11],th={0:1,1:3,2:null,3:6,4:8,5:10,6:null};function nh(r,a=60){const l=Math.floor(r/7),u=eh[r%7];return a+l*12+u}function rh(r,a=60){const l=Math.floor(r/7),u=th[r%7];return u==null?null:a+l*12+u}const Si={a:0,w:1,s:2,e:3,d:4,f:5,t:6,g:7,y:8,h:9,u:10,j:11,k:12,o:13,l:14,p:15,";":16,"'":17},_u=Object.fromEntries(Object.entries(Si).map(([r,a])=>[a,r.length===1?r.toUpperCase():r]));function sh(){const r=ne(V=>V.engine),a=ne(V=>V.midi.activeNotes),[l,u]=Q.useState(()=>new Set),[d,f]=Q.useState(60),h=Q.useRef(new Map),x=Q.useRef(l);Q.useEffect(()=>{x.current=l},[l]);const m=Q.useMemo(()=>{const V=new Set(l);for(const E of a)V.add(E);return V},[l,a]),v=V=>{r?.noteOn(V,1),u(E=>new Set(E).add(V))},g=V=>{r?.noteOff(V),u(E=>{const A=new Set(E);return A.delete(V),A})};Q.useEffect(()=>{const V=new Set,E=te=>te.length===1?te.toLowerCase():te,A=te=>{if(!(te instanceof HTMLElement))return!1;if(te.isContentEditable)return!0;const ce=te.tagName;return ce==="INPUT"||ce==="TEXTAREA"||ce==="SELECT"},z=()=>{const te=new Set;h.current.forEach(ce=>{te.has(ce)||(r&&r.noteOff(ce),te.add(ce))}),h.current.clear(),x.current.forEach(ce=>{te.has(ce)||(r&&r.noteOff(ce),te.add(ce))}),(te.size>0||x.current.size>0)&&(u(new Set),x.current=new Set),V.clear()},$=te=>{if(te.repeat)return;const ce=E(te.key);if(A(te.target))return;if(ce==="z"){f(D=>Math.max(24,D-12));return}if(ce==="x"){f(D=>Math.min(96,D+12));return}const Z=Si[ce],B=Z!=null?d+Z:void 0;B!=null&&!V.has(ce)&&(te.preventDefault(),te.stopPropagation(),V.add(ce),v(B))},pe=te=>{const ce=E(te.key),Z=Si[ce],B=Z!=null?d+Z:void 0;B!=null&&(V.delete(ce),g(B))},Ce=()=>{z()},he=()=>{document.visibilityState==="hidden"&&z()};return window.addEventListener("keydown",$),window.addEventListener("keyup",pe),window.addEventListener("blur",Ce),document.addEventListener("visibilitychange",he),()=>{window.removeEventListener("keydown",$),window.removeEventListener("keyup",pe),window.removeEventListener("blur",Ce),document.removeEventListener("visibilitychange",he),z()}},[r,d]);const w=14,k=Q.useMemo(()=>Array.from({length:w},(V,E)=>nh(E,d)),[w,d]),M=28,j=M+2,N=Math.floor(d/12)-1,_=N-4,R=(V,E)=>{V.currentTarget.setPointerCapture(V.pointerId),V.preventDefault(),h.current.set(V.pointerId,E),v(E)},X=V=>{if(!h.current.has(V.pointerId))return;const E=h.current.get(V.pointerId),z=document.elementFromPoint(V.clientX,V.clientY)?.dataset?.midi,$=z!=null?Number(z):void 0;if($==null){E!=null&&(g(E),h.current.delete(V.pointerId));return}$!==E&&(E!=null&&g(E),h.current.set(V.pointerId,$),v($))},J=V=>{const E=h.current.get(V.pointerId);E!=null&&(g(E),h.current.delete(V.pointerId))};return i.jsxs("div",{className:"keyboard",children:[i.jsx("div",{className:"row",style:{alignItems:"center",justifyContent:"space-between"},children:i.jsxs("div",{className:"octave-indicator",children:[i.jsx("span",{className:"badge",children:"Octave"}),i.jsxs("span",{className:"value",style:{color:_===0?"var(--text)":"var(--accent)"},children:[N," ",_!==0?`(${_>0?"+":""}${_})`:""]})]})}),i.jsxs("div",{className:"keys-and-help",children:[i.jsxs("div",{className:"keys-row",style:{touchAction:"none"},children:[k.map((V,E)=>i.jsx("div",{className:"key",style:{background:m.has(V)?"#d1d5db":"#f8fafc"},"data-midi":V,onPointerDown:A=>R(A,V),onPointerMove:X,onPointerUp:J,onPointerCancel:J,children:i.jsx("span",{className:"key-label",children:_u[V-d]??""})},E)),Array.from({length:w}).map((V,E)=>{const A=rh(E,d);if(A==null)return null;const z=E*j+Math.floor(M*.7);return i.jsx("div",{className:"key black",style:{left:z,background:m.has(A)?"#111827":"#0b0f16"},"data-midi":A,onPointerDown:$=>R($,A),onPointerMove:X,onPointerUp:J,onPointerCancel:J,children:i.jsx("span",{className:"key-label",children:_u[A-d]??""})},`b-${E}`)})]}),i.jsxs("div",{className:"kbd-help",children:[i.jsx("div",{className:"badge",style:{alignSelf:"flex-start"},children:"Octave shift"}),i.jsxs("button",{className:"kbd-row keyboard-shift-button",onClick:()=>f(V=>Math.max(24,V-12)),type:"button",children:[i.jsx("span",{className:"kbd",children:"Z"}),i.jsx("span",{className:"hint-text",children:"Octave Down"})]}),i.jsxs("button",{className:"kbd-row keyboard-shift-button",onClick:()=>f(V=>Math.min(96,V+12)),type:"button",children:[i.jsx("span",{className:"kbd",children:"X"}),i.jsx("span",{className:"hint-text",children:"Octave Up"})]})]})]})]})}const Xr={highPct:2,lowPct:2,windowPct:25,holdOff:3,corrRefresh:.5};function oh(){const r=ne(g=>g.engine),a=Q.useRef(null),l=Q.useRef(),u=Q.useRef(0),d=Q.useRef(0),f=Q.useRef(0),h=Q.useRef(0),x=Q.useRef(null),m=Q.useRef(128),v=ne(g=>g.oscilloscope.fftSize);return Q.useEffect(()=>{const g=a.current;if(!g||!r||typeof r.getAnalyser!="function")return;const w=g.getContext("2d"),k=r.getAnalyser();k.fftSize=v,k.smoothingTimeConstant=0;const M=()=>{const y=r.getWaveform,j=typeof y=="function"?y.call(r):new Uint8Array(k.fftSize),N=window.devicePixelRatio||1,_=g.clientWidth||600,R=g.clientHeight||160,X=Math.floor(_*N),J=Math.floor(R*N);(g.width!==X||g.height!==J)&&(g.width=X,g.height=J);const V=g.width,E=g.height;w.clearRect(0,0,V,E),w.fillStyle=getComputedStyle(document.documentElement).getPropertyValue("--viz-bg")||"#05070b",w.fillRect(0,0,V,E),w.save(),w.strokeStyle="rgba(255,255,255,0.06)",w.lineWidth=1,w.beginPath(),w.moveTo(0,E/2),w.lineTo(V,E/2),w.stroke();const A=6;for(let Z=1;Z<A;Z++){const B=Z*V/A;w.beginPath(),w.moveTo(B,0),w.lineTo(B,E),w.stroke()}w.restore();const z=j.length,$=new Float32Array(z);let pe=0;for(let Z=0;Z<z;Z++)pe+=j[Z];pe/=z;let Ce=0;for(let Z=0;Z<z;Z++){const B=(j[Z]-pe)/128;$[Z]=B,Ce+=B*B}let he=u.current||0;if(Ce>.001){const Z=Math.max(.001,Xr.highPct/100),B=-Math.max(.001,Xr.lowPct/100);let D=!1;const F=[];for(let ae=1;ae<z;ae++){const Be=$[ae-1],We=$[ae];!D&&Be<B&&(D=!0),D&&Be<Z&&We>=Z&&(F.push(ae),D=!1)}if(F.length>=2){const ae=[];for(let _e=1;_e<F.length;_e++)ae.push(F[_e]-F[_e-1]);ae.sort((_e,mt)=>_e-mt);const Be=ae[Math.floor(ae.length/2)];let We=0,Xe=0;for(const _e of ae)Math.abs(_e-Be)<=.2*Be&&(We+=_e,Xe++);const dt=Xe>0?We/Xe:Be,At=f.current||dt,K=Math.max(6,Math.min(z,At*.6+dt*.4));f.current=K;const me=((u.current||F[0])+K)%z,je=Math.max(6,Math.floor(Xr.windowPct/100*K)),ye=[];for(const _e of F)Math.abs(_e-me)<=je&&ye.push(_e);ye.length===0&&ye.push(Math.round(me));const Ne=Math.max(32,Math.min(256,Math.floor(K)));if(m.current=Ne,!x.current){const _e=new Float32Array(Ne);for(let Ee=0;Ee<Ne;Ee++)_e[Ee]=$[(ye[0]+Ee)%z];let mt=0;for(let Ee=0;Ee<Ne;Ee++)mt+=_e[Ee];mt/=Ne;let Yt=0;for(let Ee=0;Ee<Ne;Ee++)_e[Ee]=_e[Ee]-mt,Yt+=_e[Ee]*_e[Ee];Yt=Math.sqrt(Math.max(Yt,1e-12));for(let Ee=0;Ee<Ne;Ee++)_e[Ee]/=Yt;x.current=_e}{let _e=ye[0],mt=-1/0;const Yt=x.current;for(const Ee of ye){let Ft=0;for(let rt=0;rt<Ne;rt++)Ft+=$[(Ee+rt)%z];Ft/=Ne;let Ct=0,Ie=0;for(let rt=0;rt<Ne;rt++){const En=$[(Ee+rt)%z]-Ft;Ct+=En*En}Ct=Math.sqrt(Math.max(Ct,1e-12));for(let rt=0;rt<Ne;rt++){const En=($[(Ee+rt)%z]-Ft)/Ct;Ie+=En*Yt[rt]}Ie>mt&&(mt=Ie,_e=Ee)}if(he=_e,mt<Xr.corrRefresh){const Ee=new Float32Array(Ne);for(let Ie=0;Ie<Ne;Ie++)Ee[Ie]=$[(he+Ie)%z];let Ft=0;for(let Ie=0;Ie<Ne;Ie++)Ft+=Ee[Ie];Ft/=Ne;let Ct=0;for(let Ie=0;Ie<Ne;Ie++)Ee[Ie]=Ee[Ie]-Ft,Ct+=Ee[Ie]*Ee[Ie];Ct=Math.sqrt(Math.max(Ct,1e-12));for(let Ie=0;Ie<Ne;Ie++)Ee[Ie]/=Ct;x.current=Ee}}}else if(F.length===1)he=F[0];else{let ae=0,Be=0;for(let We=1;We<z;We++){const Xe=$[We]-$[We-1];Xe>ae&&(ae=Xe,Be=We)}he=Be}const U=u.current||0,G=f.current||0,P=G?(U+G)%z:U,q=Math.abs(he-P);if(G&&q>.6*G||h.current>=Xr.holdOff){const ae=Math.round(U*.4+he*.6);u.current=ae,h.current=0}else h.current+=1;let ge=u.current;const ke=12;for(let ae=-ke;ae<=ke;ae++){const Be=(ge+ae+z)%z,We=(Be+1)%z,Xe=$[Be],dt=$[We];if(Xe<Z&&dt>=Z){const At=(Z-Xe)/Math.max(dt-Xe,1e-6);ge=Be+At;break}}d.current=ge;const ue=m.current,Se=new Float32Array(ue);for(let ae=0;ae<ue;ae++){const Be=(ge+ae)%z,We=Math.floor(Be),Xe=(We+1)%z,dt=Be-We,At=$[We]*(1-dt)+$[Xe]*dt;Se[ae]=At}let Me=0;for(let ae=0;ae<ue;ae++)Me+=Se[ae];Me/=ue;let Pe=0;for(let ae=0;ae<ue;ae++)Se[ae]=Se[ae]-Me,Pe+=Se[ae]*Se[ae];Pe=Math.sqrt(Math.max(Pe,1e-12));for(let ae=0;ae<ue;ae++)Se[ae]/=Pe;x.current=Se}const te=d.current||u.current||0,ce=V/z;w.strokeStyle=getComputedStyle(document.documentElement).getPropertyValue("--viz-stroke")||"#00ffd5",w.lineWidth=2,w.shadowColor=w.strokeStyle,w.shadowBlur=8,w.beginPath();for(let Z=0;Z<z;Z++){const B=(Z+te)%z,D=Math.floor(B),F=(D+1)%z,U=B-D,P=(($[D]*(1-U)+$[F]*U)*.5+.5)*E,q=Z*ce;Z===0?w.moveTo(q,P):w.lineTo(q,P)}w.stroke(),w.shadowBlur=0,l.current=requestAnimationFrame(M)};return l.current=requestAnimationFrame(M),()=>{l.current&&cancelAnimationFrame(l.current)}},[r,v]),i.jsx("div",{children:i.jsx("canvas",{ref:a,width:600,height:300,style:{width:"100%",height:300,borderRadius:8,border:"1px solid #222631"}})})}function lh(){const r=ne(u=>u.patch),a=ne(u=>u.updatePatch),l=r.effects??{delay:{enabled:!1,time:.25,feedback:.3,mix:.2},reverb:{enabled:!1,size:.5,decay:.5,mix:.25}};return i.jsxs("div",{className:"effects-panel",children:[i.jsxs("div",{className:"effects-row",children:[i.jsx("div",{className:"effects-heading",children:"Delay"}),i.jsxs("label",{style:{display:"flex",alignItems:"center",gap:8},children:[i.jsx("input",{type:"checkbox",checked:l.delay.enabled,onChange:u=>a({effects:{...l,delay:{...l.delay,enabled:u.target.checked}}})}),i.jsx("span",{className:"label",children:"Enabled"})]}),i.jsxs("div",{className:"effects-knobs",children:[i.jsx(Te,{label:"Time",min:0,max:1.5,step:.01,value:l.delay.time,onChange:u=>a({effects:{...l,delay:{...l.delay,time:u}}}),disabled:!l.delay.enabled}),i.jsx(Te,{label:"Feedback",min:0,max:.95,step:.01,value:l.delay.feedback,onChange:u=>a({effects:{...l,delay:{...l.delay,feedback:u}}}),disabled:!l.delay.enabled}),i.jsx(Te,{label:"Mix",min:0,max:1,step:.01,value:l.delay.mix,onChange:u=>a({effects:{...l,delay:{...l.delay,mix:u}}}),disabled:!l.delay.enabled})]})]}),i.jsxs("div",{className:"effects-row",style:{marginTop:12},children:[i.jsx("div",{className:"effects-heading",children:"Reverb"}),i.jsxs("label",{style:{display:"flex",alignItems:"center",gap:8},children:[i.jsx("input",{type:"checkbox",checked:l.reverb.enabled,onChange:u=>a({effects:{...l,reverb:{...l.reverb,enabled:u.target.checked}}})}),i.jsx("span",{className:"label",children:"Enabled"})]}),i.jsxs("div",{className:"effects-knobs",children:[i.jsx(Te,{label:"Size",min:0,max:1,step:.01,value:l.reverb.size,onChange:u=>a({effects:{...l,reverb:{...l.reverb,size:u}}}),disabled:!l.reverb.enabled}),i.jsx(Te,{label:"Decay",min:0,max:1,step:.01,value:l.reverb.decay,onChange:u=>a({effects:{...l,reverb:{...l.reverb,decay:u}}}),disabled:!l.reverb.enabled}),i.jsx(Te,{label:"Mix",min:0,max:1,step:.01,value:l.reverb.mix,onChange:u=>a({effects:{...l,reverb:{...l.reverb,mix:u}}}),disabled:!l.reverb.enabled})]})]})]})}function Lu({idx:r}){const a=ne(f=>f.patch),l=ne(f=>f.updatePatch),u=r===1?"lfo1":"lfo2",d=a[u]||{enabled:!1,wave:"sine",rateHz:5,amount:.2,dest:"pitch"};return i.jsxs("div",{className:"lfo-row",children:[i.jsxs("label",{className:"lfo-toggle",children:[i.jsx("input",{type:"checkbox",checked:d.enabled,onChange:f=>l({[u]:{...d,enabled:f.target.checked}})}),i.jsxs("span",{className:"label",children:["LFO ",r]})]}),i.jsxs("label",{className:"lfo-select",children:[i.jsx("span",{className:"label",children:"Wave"}),i.jsxs("select",{value:d.wave,onChange:f=>l({[u]:{...d,wave:f.target.value}}),children:[i.jsx("option",{value:"sine",children:"Sine"}),i.jsx("option",{value:"triangle",children:"Triangle"}),i.jsx("option",{value:"square",children:"Square"}),i.jsx("option",{value:"sawtooth",children:"Saw"}),i.jsx("option",{value:"noise",children:"Noise"})]})]}),i.jsxs("label",{className:"lfo-select",children:[i.jsx("span",{className:"label",children:"Dest"}),i.jsxs("select",{value:d.dest,onChange:f=>l({[u]:{...d,dest:f.target.value}}),children:[i.jsx("option",{value:"pitch",children:"Pitch"}),i.jsx("option",{value:"filter",children:"Filter"}),i.jsx("option",{value:"amp",children:"Amp"})]})]}),i.jsx("div",{className:"knob-group",children:i.jsx(Te,{label:"Rate",min:.01,max:20,step:.01,value:d.rateHz,onChange:f=>l({[u]:{...d,rateHz:f}}),disabled:!d.enabled,formatValue:f=>`${f.toFixed(2)} Hz`})}),i.jsx("div",{className:"knob-group",children:i.jsx(Te,{label:"Amount",min:0,max:1,step:.01,value:d.amount,onChange:f=>l({[u]:{...d,amount:f}}),disabled:!d.enabled,formatValue:f=>`${Math.round(f*100)}%`})})]})}function ih(){return i.jsxs("div",{style:{display:"grid",gap:12},children:[i.jsx(Lu,{idx:1}),i.jsx(Lu,{idx:2})]})}function ah(){const r=ne(k=>k.patch),a=ne(k=>k.updatePatch),l=ne(k=>k.engine),u=ne(k=>k.transport.tempo),d=ne(k=>k.setTempo),f=r.arp??I.arp,h=r.sequencer??I.sequencer,[x,m]=qe.useState({enabled:!1,stepIndex:0,length:0}),v=k=>{a({arp:{...f,...k}})},g=f.chordSource??"preset",w=qe.useMemo(()=>{const k=h.steps??[],M=Math.max(1,Math.min(k.length,h.length)),y=new Set;for(let j=0;j<M;j++){const N=k[j];N?.on&&y.add(Math.round(N.offset??0))}return y.size},[h]);return qe.useEffect(()=>{if(!l)return;const k=setInterval(()=>{const M=l.getArpStatus?.();M&&m(M)},120);return()=>clearInterval(k)},[l]),i.jsxs("div",{className:"controls-grid",style:{gridTemplateColumns:"repeat(4, 1fr)"},children:[i.jsxs("label",{style:{display:"flex",alignItems:"center",gap:8},children:[i.jsx("input",{type:"checkbox",checked:f.enabled,onChange:k=>a({arp:{...f,enabled:k.target.checked}})}),i.jsx("span",{className:"label",children:"Enabled"})]}),i.jsxs("label",{style:{display:"flex",alignItems:"center",gap:8},children:[i.jsx("input",{type:"checkbox",checked:f.latch||!1,onChange:k=>a({arp:{...f,latch:k.target.checked}}),disabled:!f.enabled}),i.jsx("span",{className:"label",children:"Latch"})]}),i.jsx("button",{onClick:()=>l?.arpClear(),disabled:!f.enabled,style:{justifySelf:"start",alignSelf:"end",padding:"6px 10px",fontSize:12,borderRadius:6,background:"transparent",border:"1px solid var(--border, #2a3040)",color:"var(--text)"},children:"Clear"}),i.jsxs("div",{style:{gridColumn:"1 / -1",display:"grid",gridTemplateColumns:"repeat(4, minmax(0, 1fr))",gap:12,alignItems:"end"},children:[i.jsxs("label",{children:[i.jsx("div",{className:"label",children:"Mode"}),i.jsxs("select",{value:f.mode,onChange:k=>a({arp:{...f,mode:k.target.value}}),disabled:!f.enabled,children:[i.jsx("option",{value:"up",children:"Up"}),i.jsx("option",{value:"down",children:"Down"}),i.jsx("option",{value:"updown",children:"Up-Down"}),i.jsx("option",{value:"random",children:"Random"}),i.jsx("option",{value:"asplayed",children:"As Played"})]})]}),i.jsxs("label",{children:[i.jsx("div",{className:"label",children:"Octaves"}),i.jsxs("select",{value:f.octaves,onChange:k=>a({arp:{...f,octaves:Number(k.target.value)}}),disabled:!f.enabled,children:[i.jsx("option",{value:1,children:"1"}),i.jsx("option",{value:2,children:"2"}),i.jsx("option",{value:3,children:"3"}),i.jsx("option",{value:4,children:"4"})]})]}),i.jsxs("label",{children:[i.jsx("div",{className:"label",children:"Chord"}),i.jsxs("select",{value:g==="sequencer"?"sequencer":f.chord??"none",onChange:k=>{const M=k.target.value;v(M==="sequencer"?{chordSource:"sequencer"}:{chordSource:"preset",chord:M})},disabled:!f.enabled,children:[i.jsx("option",{value:"none",children:"Single"}),i.jsx("option",{value:"power",children:"Power (5th)"}),i.jsx("option",{value:"major",children:"Major Triad"}),i.jsx("option",{value:"minor",children:"Minor Triad"}),i.jsx("option",{value:"sus2",children:"Sus2"}),i.jsx("option",{value:"sus4",children:"Sus4"}),i.jsx("option",{value:"maj7",children:"Major 7th"}),i.jsx("option",{value:"min7",children:"Minor 7th"}),i.jsx("option",{value:"sequencer",children:"Sequencer Pattern"})]})]}),i.jsxs("label",{children:[i.jsx("div",{className:"label",children:"Division"}),i.jsxs("select",{value:f.division,onChange:k=>v({division:k.target.value}),disabled:!f.enabled,children:[i.jsx("option",{value:"1/4",children:"1/4"}),i.jsx("option",{value:"1/8",children:"1/8"}),i.jsx("option",{value:"1/8T",children:"1/8T"}),i.jsx("option",{value:"1/16",children:"1/16"}),i.jsx("option",{value:"1/16T",children:"1/16T"})]})]})]}),g==="sequencer"&&i.jsxs("div",{className:"hint-text",style:{gridColumn:"1 / -1",fontSize:12,opacity:.8,alignSelf:"start"},children:["Sequencer pattern",w>0?` • ${w} interval${w===1?"":"s"}`:" • no active steps yet"]}),i.jsxs("div",{style:{gridColumn:"1 / -1",display:"flex",gap:20,alignItems:"center",justifyContent:"flex-start",padding:"6px 0"},children:[i.jsx(Te,{label:"Tempo",min:40,max:240,step:1,value:u,onChange:k=>{d(k),v({bpm:k,bpmSync:!0})},disabled:!f.enabled}),i.jsx(Te,{label:"Gate",min:.05,max:1,step:.01,value:f.gate,onChange:k=>a({arp:{...f,gate:k}}),disabled:!f.enabled}),i.jsx(Te,{label:"Swing",min:0,max:.75,step:.01,value:f.swingPct??0,onChange:k=>a({arp:{...f,swingPct:k}}),disabled:!f.enabled||!f.bpmSync})]}),i.jsxs("div",{style:{gridColumn:"1 / -1",display:"grid",gridTemplateColumns:"1fr 1fr",gap:12},children:[i.jsxs("label",{children:[i.jsx("div",{className:"label",children:"Repeats"}),i.jsx("select",{value:f.repeats??1,onChange:k=>a({arp:{...f,repeats:Number(k.target.value)}}),disabled:!f.enabled,children:[1,2,3,4].map(k=>i.jsxs("option",{value:k,children:[k,"x"]},k))})]}),i.jsxs("label",{children:[i.jsx("div",{className:"label",children:"Length"}),i.jsxs("select",{value:f.patternLen??0,onChange:k=>a({arp:{...f,patternLen:Number(k.target.value)}}),disabled:!f.enabled,children:[i.jsx("option",{value:0,children:"Auto"}),Array.from({length:16},(k,M)=>M+1).map(k=>i.jsx("option",{value:k,children:k},k))]})]})]})]})}function ch(){const r=ne(E=>E.patch),a=ne(E=>E.updatePatch),l=ne(E=>E.engine),u=ne(E=>E.transport.tempo),d=ne(E=>E.transport.playing),f=ne(E=>E.transport.tick),h=ne(E=>E.setTempo),x=ne(E=>E.setTransportPlaying),m=r.sequencer??I.sequencer,v=E=>{const A=r.sequencer??I.sequencer;a({sequencer:{...A,...E}})},g=m.steps||[],w=Math.max(1,Math.min(g.length,m.length)),[k,M]=qe.useState({enabled:!1,stepIndex:0,length:0});qe.useEffect(()=>{if(!l)return;const E=setInterval(()=>{const A=l.getSequencerStatus?.();A&&M(A)},100);return()=>clearInterval(E)},[l]);const y=(E,A)=>{const z=g.slice();z[E]={...z[E],...A},v({steps:z})},j={a:0,w:1,s:2,e:3,d:4,f:5,t:6,g:7,y:8,h:9,u:10,j:11,k:12,o:13,l:14,p:15,";":16,"'":17},N=qe.useRef(null),[_,R]=qe.useState(0),[X,J]=qe.useState(!1);qe.useEffect(()=>{R(E=>Math.min(Math.max(0,E),w-1))},[w]),qe.useEffect(()=>{X&&N.current?.focus()},[X]),qe.useEffect(()=>{m.enabled&&m.bpm!==u&&v({bpm:u})},[u]),qe.useEffect(()=>{m.enabled&&m.playing!==d&&v({playing:d})},[d,m.playing,m.enabled]);const V=E=>{if(!X||!m.enabled)return;const A=E.key,z=A.length===1?A.toLowerCase():A;if(z in j){E.preventDefault();const $=j[z];y(_,{on:!0,offset:$}),R(pe=>(pe+1)%w);return}A==="ArrowRight"?(E.preventDefault(),R($=>($+1)%w)):A==="ArrowLeft"?(E.preventDefault(),R($=>($-1+w)%w)):A==="ArrowUp"?(E.preventDefault(),y(_,{on:!0,offset:Math.min(24,(g[_]?.offset||0)+1)})):A==="ArrowDown"?(E.preventDefault(),y(_,{on:!0,offset:Math.max(-24,(g[_]?.offset||0)-1)})):A==="Enter"?(E.preventDefault(),y(_,{on:!g[_]?.on})):A==="Backspace"||A==="Delete"?(E.preventDefault(),y(_,{on:!1})):A==="+"||A==="="?(E.preventDefault(),y(_,{on:!0,offset:Math.min(24,(g[_]?.offset||0)+1)})):A==="-"||A==="_"?(E.preventDefault(),y(_,{on:!0,offset:Math.max(-24,(g[_]?.offset||0)-1)})):z==="z"?(E.preventDefault(),v({rootMidi:Math.max(24,m.rootMidi-12)})):z==="x"?(E.preventDefault(),v({rootMidi:Math.min(96,m.rootMidi+12)})):A===" "&&(E.preventDefault(),x(!d))};return i.jsxs("div",{className:"sequence-panel",children:[i.jsxs("div",{className:"sequence-controls",children:[i.jsx("button",{className:"play-button",onClick:()=>x(!d),disabled:!m.enabled,children:d?"Stop":"Play"}),i.jsxs("label",{className:"sequence-toggle",children:[i.jsx("input",{type:"checkbox",checked:m.enabled,onChange:E=>v({enabled:E.target.checked})}),i.jsx("span",{children:"Enabled"})]}),i.jsxs("label",{className:"sequence-toggle",children:[i.jsx("span",{children:"Division"}),i.jsxs("select",{value:m.division,onChange:E=>v({division:E.target.value}),disabled:!m.enabled,children:[i.jsx("option",{value:"1/4",children:"1/4"}),i.jsx("option",{value:"1/8",children:"1/8"}),i.jsx("option",{value:"1/8T",children:"1/8T"}),i.jsx("option",{value:"1/16",children:"1/16"}),i.jsx("option",{value:"1/16T",children:"1/16T"})]})]})]}),i.jsx("div",{className:"sequence-body",children:i.jsxs("div",{className:"controls-grid",style:{gridTemplateColumns:"repeat(5, 1fr)"},children:[i.jsxs("label",{children:[i.jsx("div",{className:"label",children:"Length"}),i.jsx("select",{value:m.length,onChange:E=>v({length:Number(E.target.value)}),disabled:!m.enabled,children:Array.from({length:g.length},(E,A)=>A+1).map(E=>i.jsx("option",{value:E,children:E},E))})]}),i.jsx(Te,{label:"Tempo",min:40,max:240,step:1,value:u,onChange:E=>{h(E),v({bpm:E})},disabled:!m.enabled}),i.jsx(Te,{label:"Gate",min:.05,max:1,step:.01,value:m.gate,onChange:E=>v({gate:E}),disabled:!m.enabled}),i.jsx(Te,{label:"Swing",min:0,max:.75,step:.01,value:m.swingPct??0,onChange:E=>v({swingPct:E}),disabled:!m.enabled||m.division.endsWith("T")||m.division==="1/4"}),i.jsx(Te,{label:"Root",min:36,max:84,step:1,value:m.rootMidi,onChange:E=>v({rootMidi:E}),disabled:!m.enabled}),i.jsxs("div",{style:{gridColumn:"1 / -1",display:"flex",gap:12,alignItems:"center"},children:[i.jsxs("label",{style:{display:"flex",alignItems:"center",gap:8},children:[i.jsx("input",{type:"checkbox",checked:X,onChange:E=>J(E.target.checked)}),i.jsx("span",{className:"label",children:"Edit Notes (Keyboard)"})]}),i.jsx("div",{className:"hint-text",style:{opacity:.8},children:"Keys: A/W/S... set notes • Arrows move • Z/X root ±1 oct • Space play/pause • +/- semitone • Backspace clear"})]}),i.jsx("div",{ref:N,tabIndex:0,onKeyDown:V,style:{gridColumn:"1 / -1",display:"grid",gridTemplateColumns:"repeat(16, 1fr)",gap:6,outline:X?"1px dashed #2a3040":"none",borderRadius:6,padding:2},children:g.map((E,A)=>{const z=A<w,$=E.on&&z,pe=w>0?f%w:0,Ce=k.enabled&&d&&z&&pe===A;return i.jsx("div",{onClick:he=>{he.altKey?y(A,{offset:Math.max(-24,Math.min(24,(E.offset||0)+1))}):y(A,{on:!E.on}),R(A)},onContextMenu:he=>{he.preventDefault(),y(A,{offset:Math.max(-24,Math.min(24,(E.offset||0)-1))})},title:`Step ${A+1}${E.offset?`, ${E.offset>0?"+":""}${E.offset}`:""}`,style:{height:44,borderRadius:6,border:`1px solid ${Ce||A===_&&X?"var(--accent)":"#2a3040"}`,background:$?Ce?"var(--accent)":"#1d2432":"#0f1217",color:$?Ce?"#0f1217":"var(--text)":"#556",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",userSelect:"none"},children:i.jsx("span",{style:{fontSize:11,opacity:.9},children:E.offset===0?"0":E.offset>0?`+${E.offset}`:`${E.offset}`})},A)})})]})})]})}const ki=[{id:"filter.cutoff",label:"Filter Cutoff",category:"Filter",description:"Move the filter cutoff frequency"},{id:"filter.q",label:"Filter Resonance",category:"Filter",description:"Adjust filter Q / resonance"},{id:"master.gain",label:"Master Gain",category:"Master",description:"Scale the master volume"},{id:"mix",label:"Osc Mix",category:"Oscillators",description:"Crossfade between Osc 1 and Osc 2"},{id:"osc1.detune",label:"Osc 1 Detune",category:"Oscillators",description:"Offset oscillator 1 pitch in cents"},{id:"osc2.detune",label:"Osc 2 Detune",category:"Oscillators",description:"Offset oscillator 2 pitch in cents"},{id:"fm.amount",label:"FM Amount",category:"FM",description:"Modulation index for FM routing"},{id:"envelope.attack",label:"Env Attack",category:"Envelope",description:"Envelope attack time"},{id:"envelope.release",label:"Env Release",category:"Envelope",description:"Envelope release time"},{id:"macro.harmonics",label:"Macro Harmonics",category:"Macro",description:"Macro engine harmonics"},{id:"macro.timbre",label:"Macro Timbre",category:"Macro",description:"Macro engine timbre"},{id:"macro.morph",label:"Macro Morph",category:"Macro",description:"Macro engine morph"},{id:"macro.level",label:"Macro Level",category:"Macro",description:"Macro engine output level"},{id:"lfo1.rateHz",label:"LFO 1 Rate",category:"LFO",description:"LFO1 rate in Hz"},{id:"lfo1.amount",label:"LFO 1 Amount",category:"LFO",description:"LFO1 depth"},{id:"lfo2.rateHz",label:"LFO 2 Rate",category:"LFO",description:"LFO2 rate in Hz"},{id:"lfo2.amount",label:"LFO 2 Amount",category:"LFO",description:"LFO2 depth"}],Ou=Object.fromEntries(ki.map(r=>[r.id,r.label]));function uh(){const r=ne(y=>y.engine),l=ne(y=>y.patch.expression)??I.expression,u=Ou[l.x]??"X Axis",d=Ou[l.y]??"Y Axis",f=Q.useRef(r),[h,x]=Q.useState(!1),[m,v]=Q.useState(null),g=Q.useRef(!1),w=Q.useRef(null),k=Q.useRef(null);Q.useEffect(()=>{f.current=r},[r]);const M=Q.useCallback(y=>{g.current=y,x(y),y||(k.current=null,w.current!=null&&(cancelAnimationFrame(w.current),w.current=null),f.current?.clearExpression2D(),v(null))},[]);return Q.useEffect(()=>{const y=N=>{N.key==="CapsLock"?M(N.getModifierState("CapsLock")):!N.getModifierState("CapsLock")&&g.current&&M(!1)},j=()=>M(!1);return window.addEventListener("keydown",y),window.addEventListener("keyup",y),window.addEventListener("blur",j),()=>{window.removeEventListener("keydown",y),window.removeEventListener("keyup",y),window.removeEventListener("blur",j)}},[M]),Q.useEffect(()=>{const y=()=>{if(w.current=null,!g.current)return;const R=k.current;R&&(k.current=null,f.current?.setExpression2D(R.x,R.y),v(R))},j=()=>{w.current==null&&(w.current=requestAnimationFrame(y))},N=R=>{if(!f.current)return;const X=R.getModifierState?.("CapsLock")??g.current;if(X!==g.current&&M(X),!X||!["mouse","touch","pen"].includes(R.pointerType))return;const J=Math.min(1,Math.max(0,R.clientX/window.innerWidth)),V=Math.min(1,Math.max(0,1-R.clientY/window.innerHeight));k.current={x:J,y:V},j()},_=()=>M(!1);return window.addEventListener("pointermove",N,{passive:!0}),window.addEventListener("pointerdown",N,{passive:!0}),window.addEventListener("pointerup",N,{passive:!0}),window.addEventListener("pointercancel",_),window.addEventListener("mouseleave",_),()=>{window.removeEventListener("pointermove",N),window.removeEventListener("pointerdown",N),window.removeEventListener("pointerup",N),window.removeEventListener("pointercancel",_),window.removeEventListener("mouseleave",_),w.current!=null&&(cancelAnimationFrame(w.current),w.current=null)}},[M]),r?i.jsxs("div",{className:`expression-overlay${h?" active":""}`,"aria-hidden":"true",children:[i.jsx("div",{className:"expression-label",children:"CapsLock XY Expression"}),h?i.jsxs("div",{className:"expression-status",children:["Active · ",u," ",((m?.x??.5)*100).toFixed(0),"% · ",d," ",((m?.y??.5)*100).toFixed(0),"%"]}):i.jsxs("div",{className:"expression-status",children:["Engage CapsLock and move on the trackpad to modulate ",u," / ",d]})]}):null}const Ru="application/x-websynth-panel";function Iu(r,a,l){if(!r.includes(a))return r;const u=r.filter(f=>f!==a),d=Math.max(0,Math.min(l,u.length));return[...u.slice(0,d),a,...u.slice(d)]}function dh({panels:r,order:a,onOrderChange:l,onRequestHelp:u}){const[d,f]=Q.useState(null),[h,x]=Q.useState(null),[m,v]=Q.useState(!1),g=Q.useMemo(()=>new Map(r.map(E=>[E.id,E])),[r]),w=Q.useMemo(()=>r.map(E=>E.id),[r]),k=Q.useMemo(()=>{const E=(a.length?a:w).filter($=>g.has($)),A=new Set(E),z=r.filter($=>!A.has($.id)).map($=>$.id);return[...E,...z]},[a,w,g,r]),M=E=>A=>{A.dataTransfer.effectAllowed="move";try{A.dataTransfer.setData(Ru,E)}catch{A.dataTransfer.setData("text/plain",E)}f(E),x(null),v(!1)},y=()=>{f(null),x(null),v(!1)},j=E=>{let A="";try{A=E.dataTransfer.getData(Ru)}catch{A=E.dataTransfer.getData("text/plain")}return A||d},N=(E,A)=>z=>{if(z.preventDefault(),z.stopPropagation(),!d)return;const $=z.currentTarget.getBoundingClientRect(),pe=z.clientY<$.top+$.height/2;x({id:E,position:pe?"before":"after"}),v(!1)},_=(E,A)=>z=>{z.preventDefault(),z.stopPropagation();const $=j(z);if(!$)return;const pe=z.currentTarget.getBoundingClientRect(),he=z.clientY<pe.top+pe.height/2?A:A+1,te=Iu(k,$,he);l(te),x(null),v(!1)},R=E=>A=>{A.stopPropagation(),h?.id===E&&x(null)},X=E=>{d&&(E.preventDefault(),x(null),v(!0))},J=E=>{E.preventDefault();const A=j(E);if(!A)return;const z=Iu(k,A,k.length);l(z),x(null),v(!1)},V=E=>A=>{A.preventDefault(),A.stopPropagation(),u?.(E)};return i.jsx("div",{className:`dashboard-grid${m?" drop-end":""}`,onDragOver:X,onDrop:J,children:k.map((E,A)=>{const z=g.get(E);if(!z)return null;const $=z.span??1,pe=d===E,Ce=h?.id===E&&h.position==="before",he=h?.id===E&&h.position==="after",te=["panel","dashboard-panel",pe?"dragging":"",Ce?"drop-before":"",he?"drop-after":""].filter(Boolean).join(" ");return i.jsx("section",{className:te,style:{gridColumn:$>1?`span ${$}`:void 0},onDragOver:N(z.id),onDrop:_(z.id,A),onDragLeave:R(z.id),children:i.jsxs("div",{className:"panel-body",children:[i.jsxs("div",{className:"panel-header",children:[i.jsx("h3",{className:"panel-title",children:z.title}),i.jsxs("div",{className:"panel-actions",children:[u?i.jsx("button",{type:"button",className:"panel-help-button",onClick:V(z.id),"aria-label":`Show help for ${z.title}`,children:"?"}):null,i.jsx("span",{className:"panel-drag-hint","aria-hidden":"true",draggable:!0,onDragStart:M(z.id),onDragEnd:y,children:"⋮⋮"})]})]}),z.render()]})},z.id)})})}const fh=()=>JSON.parse(JSON.stringify(I)),Ze=r=>(r.effects||(r.effects=JSON.parse(JSON.stringify(I.effects))),r.effects),ph=r=>r.endsWith("/")?r:`${r}/`,hh=ph("./"),Ke=(r,a,l,u,d={})=>{const f=fh();u(f);const h=d.tags??[],x=d.image??`${hh}presets/${r}.png`;return{id:r,name:a,description:l,tags:h,image:x,patch:f}},mh={id:"essentials",name:"Essentials",description:"Foundation tones that show the core oscillators, filter, and envelopes.",presets:[Ke("init","Init Saw","Clean slate patch: saw + square with neutral envelope.",()=>{},{tags:["init"]}),Ke("warm-pad","Warm Pad","Gently detuned analog pad with slow attack and soft filter motion.",r=>{r.engineMode="classic",r.osc1.mode="analog",r.osc1.wave="triangle",r.osc1.detune=-4,r.osc1.detuneFine=-2,r.osc1.octave=0,r.osc2.mode="analog",r.osc2.wave="sawtooth",r.osc2.detune=5,r.osc2.detuneFine=1,r.osc2.octave=0,r.mix=.42,r.sub.enabled=!0,r.sub.wave="sine",r.sub.octave=1,r.sub.level=.35,r.fm.enabled=!1,r.ring.enabled=!1,r.filter.type="lowpass",r.filter.cutoff=880,r.filter.q=.85,r.envelope.attack=.6,r.envelope.decay=.85,r.envelope.sustain=.78,r.envelope.release=1.9,r.lfo1={...r.lfo1??I.lfo1,enabled:!0,wave:"sine",dest:"filter",rateHz:.18,amount:.38},r.lfo2={...r.lfo2??I.lfo2,enabled:!1,wave:"sine",dest:"pitch",rateHz:.4,amount:.1};const a=Ze(r);a.delay={enabled:!1,time:.32,feedback:.28,mix:.18},a.reverb={enabled:!0,size:.72,decay:.85,mix:.33},r.master.gain=.22},{tags:["pad","analog"]}),Ke("bright-pluck","Bright Pluck","Snappy analog pluck with a touch of FM and tempo-friendly delay.",r=>{r.engineMode="classic",r.osc1.mode="analog",r.osc1.wave="square",r.osc1.detune=2,r.osc1.detuneFine=0,r.osc1.octave=0,r.osc2.mode="analog",r.osc2.wave="sawtooth",r.osc2.detune=-6,r.osc2.detuneFine=0,r.osc2.octave=0,r.mix=.5,r.fm.enabled=!0,r.fm.ratio=1.25,r.fm.amount=90,r.sub.enabled=!1,r.ring.enabled=!1,r.filter.type="lowpass",r.filter.cutoff=1500,r.filter.q=.95,r.envelope.attack=.008,r.envelope.decay=.18,r.envelope.sustain=.12,r.envelope.release=.22,r.lfo1={...r.lfo1??I.lfo1,enabled:!1,wave:"triangle",dest:"pitch",rateHz:5.5,amount:.06},r.lfo2={...r.lfo2??I.lfo2,enabled:!1,wave:"sine",dest:"amp",rateHz:.6,amount:0};const a=Ze(r);a.delay={enabled:!0,time:.26,feedback:.32,mix:.24},a.reverb={enabled:!1,size:.4,decay:.4,mix:.18},r.master.gain=.23},{tags:["lead","pluck"]})]},vh={id:"basslines",name:"Basslines",description:"Low-end starters that demonstrate sub layering, resonance, and FM growl.",presets:[Ke("sub-driver","Sub Driver","Focused sub bass with a sine layer and tight envelope.",r=>{r.engineMode="classic",r.osc1.mode="analog",r.osc1.wave="sawtooth",r.osc1.octave=-1,r.osc1.detune=-2,r.osc1.detuneFine=0,r.osc2.mode="analog",r.osc2.wave="square",r.osc2.octave=-1,r.osc2.detune=3,r.osc2.detuneFine=0,r.mix=.25,r.sub.enabled=!0,r.sub.wave="sine",r.sub.octave=1,r.sub.level=.7,r.fm.enabled=!1,r.ring.enabled=!1,r.filter.type="lowpass",r.filter.cutoff=220,r.filter.q=1.2,r.envelope.attack=.01,r.envelope.decay=.2,r.envelope.sustain=.75,r.envelope.release=.32,r.lfo1={...r.lfo1??I.lfo1,enabled:!0,wave:"sine",dest:"pitch",rateHz:.28,amount:.05},r.lfo2={...r.lfo2??I.lfo2,enabled:!1,wave:"sine",dest:"filter",rateHz:.6,amount:0};const a=Ze(r);a.delay={enabled:!1,time:.2,feedback:.2,mix:.1},a.reverb={enabled:!1,size:.3,decay:.2,mix:.1},r.master.gain=.28},{tags:["bass"]}),Ke("acid-line","Acid Line","Classic resonant saw bass ready for sequences and filter tweaks.",r=>{r.engineMode="classic",r.osc1.mode="analog",r.osc1.wave="sawtooth",r.osc1.octave=-1,r.osc1.detune=0,r.osc1.detuneFine=0,r.osc2.mode="analog",r.osc2.wave="sawtooth",r.osc2.octave=0,r.osc2.detune=7,r.osc2.detuneFine=0,r.mix=.55,r.sub.enabled=!1,r.fm.enabled=!1,r.ring.enabled=!1,r.filter.type="lowpass",r.filter.cutoff=520,r.filter.q=8.5,r.envelope.attack=.01,r.envelope.decay=.25,r.envelope.sustain=.3,r.envelope.release=.18,r.lfo1={...r.lfo1??I.lfo1,enabled:!0,wave:"triangle",dest:"filter",rateHz:6,amount:.14},r.lfo2={...r.lfo2??I.lfo2,enabled:!1,wave:"sine",dest:"pitch",rateHz:3.5,amount:.04};const a=Ze(r);a.delay={enabled:!0,time:.18,feedback:.22,mix:.18},a.reverb={enabled:!1,size:.35,decay:.25,mix:.12},r.master.gain=.25},{tags:["bass","resonant"]}),Ke("fm-growl","FM Growl","Two-operator FM for gritty bass leads with animated mids.",r=>{r.engineMode="classic",r.osc1.mode="analog",r.osc1.wave="sawtooth",r.osc1.octave=0,r.osc1.detune=0,r.osc1.detuneFine=0,r.osc2.mode="analog",r.osc2.wave="square",r.osc2.octave=0,r.osc2.detune=0,r.osc2.detuneFine=0,r.mix=.4,r.fm.enabled=!0,r.fm.ratio=2,r.fm.amount=180,r.sub.enabled=!1,r.ring.enabled=!1,r.filter.type="bandpass",r.filter.cutoff=540,r.filter.q=2.8,r.envelope.attack=.012,r.envelope.decay=.22,r.envelope.sustain=.4,r.envelope.release=.3,r.lfo1={...r.lfo1??I.lfo1,enabled:!0,wave:"triangle",dest:"filter",rateHz:1.2,amount:.25},r.lfo2={...r.lfo2??I.lfo2,enabled:!1,wave:"sine",dest:"pitch",rateHz:3,amount:.05};const a=Ze(r);a.delay={enabled:!1,time:.2,feedback:.2,mix:.1},a.reverb={enabled:!1,size:.4,decay:.25,mix:.12},r.master.gain=.24},{tags:["bass","fm"]})]},gh={id:"macro",name:"Macro Voices",description:"Presets that lean on the macro engine for hybrid keys, pads, and textures.",presets:[Ke("glass-keys","Glass Keys","Macro pluck blended with a triangle support for bell-like keys.",r=>{r.engineMode="macro",r.osc1.mode="macro",r.osc1.macro={...r.osc1.macro??I.osc1.macro,model:"pluck",harmonics:.45,timbre:.6,morph:.35,level:.9},r.osc2.mode="analog",r.osc2.wave="triangle",r.osc2.detune=-2,r.osc2.detuneFine=0,r.osc2.octave=0,r.mix=.35,r.filter.type="lowpass",r.filter.cutoff=1800,r.filter.q=.7,r.envelope.attack=.02,r.envelope.decay=.25,r.envelope.sustain=.6,r.envelope.release=.55,r.lfo1={...r.lfo1??I.lfo1,enabled:!0,wave:"sine",dest:"pitch",rateHz:5,amount:.04},r.lfo2={...r.lfo2??I.lfo2,enabled:!1,wave:"sine",dest:"amp",rateHz:.4,amount:0};const a=Ze(r);a.delay={enabled:!0,time:.3,feedback:.25,mix:.22},a.reverb={enabled:!0,size:.55,decay:.6,mix:.28},r.master.gain=.21},{tags:["macro","keys"]}),Ke("supersaw-pad","Supersaw Pad","Wide, macro-driven supersaw with evolving filter movement.",r=>{r.engineMode="macro",r.osc1.mode="macro",r.osc1.macro={...r.osc1.macro??I.osc1.macro,model:"supersaw",harmonics:.68,timbre:.5,morph:.52,level:1},r.osc2.mode="macro",r.osc2.macro={...r.osc2.macro??I.osc2.macro,model:"va",harmonics:.4,timbre:.5,morph:.5,level:.5},r.mix=.5,r.filter.type="lowpass",r.filter.cutoff=720,r.filter.q=.8,r.envelope.attack=.5,r.envelope.decay=.9,r.envelope.sustain=.82,r.envelope.release=2.4,r.lfo1={...r.lfo1??I.lfo1,enabled:!0,wave:"sine",dest:"filter",rateHz:.12,amount:.5},r.lfo2={...r.lfo2??I.lfo2,enabled:!1,wave:"sine",dest:"pitch",rateHz:.4,amount:0};const a=Ze(r);a.delay={enabled:!0,time:.36,feedback:.32,mix:.22},a.reverb={enabled:!0,size:.82,decay:1.2,mix:.4},r.master.gain=.2},{tags:["macro","pad"]}),Ke("harmonic-motion","Harmonic Motion","Evolving harmonic macro texture with slow motion and shimmer.",r=>{r.engineMode="macro",r.osc1.mode="macro",r.osc1.macro={...r.osc1.macro??I.osc1.macro,model:"harmonic",harmonics:.55,timbre:.68,morph:.45,level:1},r.osc2.mode="macro",r.osc2.macro={...r.osc2.macro??I.osc2.macro,model:"fm2op",harmonics:.4,timbre:.6,morph:.35,level:.6},r.mix=.6,r.filter.type="bandpass",r.filter.cutoff=680,r.filter.q=1.6,r.envelope.attack=1.2,r.envelope.decay=1.1,r.envelope.sustain=.65,r.envelope.release=3.2,r.lfo1={...r.lfo1??I.lfo1,enabled:!0,wave:"sine",dest:"filter",rateHz:.1,amount:.55},r.lfo2={...r.lfo2??I.lfo2,enabled:!0,wave:"noise",dest:"pitch",rateHz:1.2,amount:.08};const a=Ze(r);a.delay={enabled:!0,time:.5,feedback:.4,mix:.28},a.reverb={enabled:!0,size:.9,decay:1.5,mix:.45},r.master.gain=.18},{tags:["macro","texture"]}),Ke("dirichlet-glow","Dirichlet Glow","New Dirichlet pulse macro blended with a VA pad for lyrical keys.",r=>{r.engineMode="macro",r.osc1.mode="macro",r.osc1.macro={...r.osc1.macro??I.osc1.macro,model:"dirichlet",harmonics:.78,timbre:.42,morph:.6,level:1},r.osc2.mode="macro",r.osc2.macro={...r.osc2.macro??I.osc2.macro,model:"va",harmonics:.5,timbre:.4,morph:.38,level:.58},r.mix=.55,r.filter.type="bandpass",r.filter.cutoff=1350,r.filter.q=1.2,r.envelope.attack=.06,r.envelope.decay=.4,r.envelope.sustain=.62,r.envelope.release=.95,r.lfo1={...r.lfo1??I.lfo1,enabled:!0,wave:"sine",dest:"filter",rateHz:.65,amount:.36},r.lfo2={...r.lfo2??I.lfo2,enabled:!0,wave:"triangle",dest:"amp",rateHz:3.2,amount:.08};const a=Ze(r);a.delay={enabled:!0,time:.32,feedback:.26,mix:.24},a.reverb={enabled:!0,size:.68,decay:.9,mix:.33},r.master.gain=.2},{tags:["macro","dirichlet","keys"]}),Ke("vowel-wash","Vowel Wash","Phase-aligned formant engine for choir-like swells and evolving vowels.",r=>{r.engineMode="macro",r.osc1.mode="macro",r.osc1.macro={...r.osc1.macro??I.osc1.macro,model:"formant",harmonics:.52,timbre:.58,morph:.72,level:1},r.osc2.mode="macro",r.osc2.macro={...r.osc2.macro??I.osc2.macro,model:"harmonic",harmonics:.34,timbre:.66,morph:.5,level:.5},r.mix=.48,r.filter.type="lowpass",r.filter.cutoff=820,r.filter.q=.9,r.envelope.attack=.8,r.envelope.decay=1.1,r.envelope.sustain=.82,r.envelope.release=2.8,r.lfo1={...r.lfo1??I.lfo1,enabled:!0,wave:"sine",dest:"filter",rateHz:.18,amount:.48},r.lfo2={...r.lfo2??I.lfo2,enabled:!0,wave:"sine",dest:"pitch",rateHz:.12,amount:.05};const a=Ze(r);a.delay={enabled:!0,time:.48,feedback:.38,mix:.26},a.reverb={enabled:!0,size:.9,decay:1.8,mix:.42},r.master.gain=.18},{tags:["macro","formant","pad"]})]},yh={id:"motion",name:"Motion & FX",description:"Rhythmic and ambient presets highlighting LFO routing, noise modulation, and space.",presets:[Ke("noisy-motion","Noisy Motion","Analog layers with the new noise LFO pushing the filter for organic movement.",r=>{r.engineMode="classic",r.osc1.mode="analog",r.osc1.wave="sawtooth",r.osc1.detune=-7,r.osc1.detuneFine=-2,r.osc1.octave=0,r.osc2.mode="analog",r.osc2.wave="triangle",r.osc2.detune=6,r.osc2.detuneFine=2,r.osc2.octave=0,r.mix=.48,r.filter.type="bandpass",r.filter.cutoff=950,r.filter.q=1.4,r.envelope.attack=.12,r.envelope.decay=.6,r.envelope.sustain=.55,r.envelope.release=.8,r.lfo1={...r.lfo1??I.lfo1,enabled:!0,wave:"noise",dest:"filter",rateHz:3.2,amount:.24},r.lfo2={...r.lfo2??I.lfo2,enabled:!0,wave:"sine",dest:"amp",rateHz:.55,amount:.35};const a=Ze(r);a.delay={enabled:!0,time:.4,feedback:.42,mix:.26},a.reverb={enabled:!0,size:.75,decay:1.1,mix:.36},r.master.gain=.21},{tags:["motion","noise"]}),Ke("pulsar-gate","Pulsar Gate","Square-wave LFO chops the amp while a slow triangle sweeps the filter.",r=>{r.engineMode="classic",r.osc1.mode="analog",r.osc1.wave="sawtooth",r.osc1.detune=-3,r.osc1.detuneFine=0,r.osc2.mode="analog",r.osc2.wave="square",r.osc2.detune=3,r.osc2.detuneFine=0,r.mix=.5,r.filter.type="lowpass",r.filter.cutoff=1400,r.filter.q=.9,r.envelope.attack=.03,r.envelope.decay=.4,r.envelope.sustain=.6,r.envelope.release=.6,r.lfo1={...r.lfo1??I.lfo1,enabled:!0,wave:"square",dest:"amp",rateHz:6,amount:.7},r.lfo2={...r.lfo2??I.lfo2,enabled:!0,wave:"triangle",dest:"filter",rateHz:.25,amount:.4};const a=Ze(r);a.delay={enabled:!0,time:.33,feedback:.35,mix:.24},a.reverb={enabled:!0,size:.6,decay:.7,mix:.28},r.master.gain=.22,r.arp={...r.arp??I.arp,enabled:!0,gate:.45,bpmSync:!0,bpm:120,division:"1/8",mode:"updown",octaves:1,latch:!1}},{tags:["motion","arp"]}),Ke("space-drone","Space Drone","Long-release drone with ring modulation and cavernous ambience.",r=>{r.engineMode="classic",r.osc1.mode="analog",r.osc1.wave="triangle",r.osc1.detune=-6,r.osc1.detuneFine=-3,r.osc2.mode="analog",r.osc2.wave="sine",r.osc2.detune=6,r.osc2.detuneFine=3,r.mix=.5,r.sub.enabled=!0,r.sub.wave="sine",r.sub.octave=2,r.sub.level=.4,r.ring.enabled=!0,r.ring.amount=.6,r.filter.type="bandpass",r.filter.cutoff=420,r.filter.q=2.2,r.envelope.attack=1.5,r.envelope.decay=1.2,r.envelope.sustain=.65,r.envelope.release=4.5,r.lfo1={...r.lfo1??I.lfo1,enabled:!0,wave:"sine",dest:"filter",rateHz:.08,amount:.45},r.lfo2={...r.lfo2??I.lfo2,enabled:!0,wave:"noise",dest:"pitch",rateHz:1.5,amount:.08};const a=Ze(r);a.delay={enabled:!0,time:.6,feedback:.48,mix:.3},a.reverb={enabled:!0,size:.95,decay:2.4,mix:.55},r.master.gain=.18},{tags:["drone","fx"]})]},xh={id:"keys-leads",name:"Keys & Leads",description:"Playable patches that highlight melodic work—keys, brass, and expressive leads.",presets:[Ke("dream-keys","Dream Keys","Soft keys with gentle vibrato and a shimmering tail.",r=>{r.engineMode="classic",r.osc1.mode="analog",r.osc1.wave="triangle",r.osc1.detune=-3,r.osc1.detuneFine=-1,r.osc2.mode="analog",r.osc2.wave="sine",r.osc2.detune=4,r.osc2.detuneFine=1,r.mix=.46,r.filter.type="lowpass",r.filter.cutoff=1450,r.filter.q=.75,r.envelope.attack=.05,r.envelope.decay=.4,r.envelope.sustain=.65,r.envelope.release=.9,r.lfo1={...r.lfo1??I.lfo1,enabled:!0,wave:"sine",dest:"pitch",rateHz:5.8,amount:.08},r.lfo2={...r.lfo2??I.lfo2,enabled:!1,wave:"sine",dest:"amp",rateHz:.5,amount:0};const a=Ze(r);a.delay={enabled:!0,time:.28,feedback:.22,mix:.2},a.reverb={enabled:!0,size:.6,decay:.85,mix:.3},r.master.gain=.23},{tags:["keys","vibrato"]}),Ke("poly-brass","Poly Brass","Brassy synth stack with macro morphing and expressive filter.",r=>{r.engineMode="macro",r.osc1.mode="macro",r.osc1.macro={...r.osc1.macro??I.osc1.macro,model:"va",harmonics:.72,timbre:.48,morph:.62,level:1},r.osc2.mode="analog",r.osc2.wave="sawtooth",r.osc2.detune=-8,r.osc2.detuneFine=-1,r.mix=.58,r.filter.type="lowpass",r.filter.cutoff=980,r.filter.q=1.05,r.envelope.attack=.03,r.envelope.decay=.36,r.envelope.sustain=.58,r.envelope.release=.44,r.lfo1={...r.lfo1??I.lfo1,enabled:!0,wave:"triangle",dest:"filter",rateHz:.45,amount:.32};const a=Ze(r);a.delay={enabled:!1,time:.3,feedback:.2,mix:.1},a.reverb={enabled:!0,size:.5,decay:.65,mix:.24},r.master.gain=.24},{tags:["macro","brass"]}),Ke("shimmer-lead","Shimmer Lead","Cutting lead with harmonics shimmer and subtle glide.",r=>{r.engineMode="classic",r.osc1.mode="analog",r.osc1.wave="sawtooth",r.osc1.detune=7,r.osc1.detuneFine=1,r.osc2.mode="macro",r.osc2.macro={...r.osc2.macro??I.osc2.macro,model:"harmonic",harmonics:.58,timbre:.62,morph:.4,level:.7},r.mix=.48,r.filter.type="bandpass",r.filter.cutoff=2100,r.filter.q=1.1,r.envelope.attack=.01,r.envelope.decay=.22,r.envelope.sustain=.45,r.envelope.release=.28,r.lfo1={...r.lfo1??I.lfo1,enabled:!0,wave:"sine",dest:"pitch",rateHz:6.5,amount:.12},r.lfo2={...r.lfo2??I.lfo2,enabled:!0,wave:"noise",dest:"filter",rateHz:2.8,amount:.18};const a=Ze(r);a.delay={enabled:!0,time:.24,feedback:.27,mix:.2},a.reverb={enabled:!0,size:.48,decay:.6,mix:.22},r.master.gain=.23},{tags:["lead"]})]},wh={id:"percussion-fx",name:"Percussion & FX",description:"Hits, plucks, and sound design starters for rhythm tracks and atmospheres.",presets:[Ke("fm-bell","FM Bell","Metallic bell with quick shimmer and lingering tail.",r=>{r.engineMode="classic",r.osc1.mode="analog",r.osc1.wave="sine",r.osc1.octave=1,r.osc2.mode="analog",r.osc2.wave="sine",r.osc2.octave=1,r.fm.enabled=!0,r.fm.ratio=3,r.fm.amount=210,r.mix=.5,r.filter.type="lowpass",r.filter.cutoff=1700,r.filter.q=1.4,r.envelope.attack=.002,r.envelope.decay=.42,r.envelope.sustain=0,r.envelope.release=1.2,r.lfo1={...r.lfo1??I.lfo1,enabled:!1,wave:"sine",dest:"pitch",rateHz:6,amount:0};const a=Ze(r);a.delay={enabled:!1,time:.22,feedback:.25,mix:.18},a.reverb={enabled:!0,size:.7,decay:1.4,mix:.4},r.master.gain=.2},{tags:["percussion","fm"]}),Ke("noise-hit","Noise Hit","Short noise burst shaped with looping sampler trim—ideal for snares or whooshes.",r=>{r.engineMode="classic",r.osc1.mode="analog",r.osc1.wave="noise",r.osc2.mode="analog",r.osc2.wave="sine",r.osc2.detune=-12,r.osc2.octave=-1,r.mix=.32,r.filter.type="bandpass",r.filter.cutoff=1800,r.filter.q=5,r.envelope.attack=.001,r.envelope.decay=.28,r.envelope.sustain=0,r.envelope.release=.18,r.lfo1={...r.lfo1??I.lfo1,enabled:!0,wave:"noise",dest:"filter",rateHz:8,amount:.2};const a=Ze(r);a.delay={enabled:!1,time:.12,feedback:.1,mix:.08},a.reverb={enabled:!0,size:.55,decay:.6,mix:.28},r.master.gain=.22},{tags:["percussion","noise"]}),Ke("chiptune-click","Chiptune Click","Retro 8-bit percussive blip with sequencer-ready envelope.",r=>{r.engineMode="classic",r.osc1.mode="analog",r.osc1.wave="square",r.osc1.octave=1,r.osc2.mode="analog",r.osc2.wave="square",r.osc2.detune=7,r.osc2.octave=1,r.mix=.45,r.filter.type="highpass",r.filter.cutoff=600,r.filter.q=.7,r.envelope.attack=.001,r.envelope.decay=.12,r.envelope.sustain=0,r.envelope.release=.08,r.lfo1={...r.lfo1??I.lfo1,enabled:!1,wave:"square",dest:"pitch",rateHz:12,amount:0};const a=Ze(r);a.delay={enabled:!1,time:.08,feedback:.1,mix:.05},a.reverb={enabled:!1,size:.3,decay:.3,mix:.08},r.master.gain=.2},{tags:["percussion","retro"]})]},ji=[mh,vh,gh,yh,xh,wh],Mi=ji.flatMap(r=>r.presets.map(a=>({...a,groupId:r.id}))),mo=Object.fromEntries(Mi.map(r=>[r.id,r])),Au=Object.fromEntries(Mi.map(r=>[r.id,r.patch]));Mi.map(r=>r.id);const vi="init";function Sh(){const r=ne(M=>M.updatePatch),a=ne(M=>M.exportPatch),l=ne(M=>M.importPatch),u=ne(M=>M.saveUserPreset),d=ne(M=>M.userPresets),f=Q.useRef(null),[h,x]=Q.useState(vi),m=()=>{const M=a(),y=new Blob([M],{type:"application/json"}),j=URL.createObjectURL(y),N=document.createElement("a");N.href=j,N.download="patch.json",N.click(),URL.revokeObjectURL(j)},v=M=>{const y=M.target.files?.[0];if(!y)return;const j=new FileReader;j.onload=()=>{l(String(j.result))},j.readAsText(y)},g=Q.useMemo(()=>mo[h],[h]),w=Q.useMemo(()=>d.find(M=>M.id===h),[h,d]),k=M=>{const y=M.target.value;x(y),M.target.blur();const j=Au[y];if(j){r(j);return}const N=d.find(_=>_.id===y);if(N){const _=typeof structuredClone=="function"?structuredClone(N.patch):JSON.parse(JSON.stringify(N.patch));r(_)}};return i.jsxs("div",{className:"row",style:{justifyContent:"space-between"},children:[i.jsxs("div",{className:"row",style:{gap:8},children:[i.jsxs("select",{value:h,onChange:k,children:[ji.map(M=>i.jsx("optgroup",{label:M.name,children:M.presets.map(y=>i.jsx("option",{value:y.id,title:y.description,children:y.name},y.id))},M.id)),d.length>0&&i.jsx("optgroup",{label:"Custom Presets",children:d.map(M=>i.jsx("option",{value:M.id,title:M.description,children:M.name},M.id))})]}),i.jsx("button",{onClick:()=>f.current?.click(),children:"Import"}),i.jsx("input",{ref:f,type:"file",accept:"application/json",style:{display:"none"},onChange:v}),i.jsx("button",{onClick:m,children:"Export"}),i.jsx("button",{onClick:()=>{const M=window.prompt("Name your preset");if(!M)return;const y=window.prompt("Description (optional)"),j=u(M,y??void 0);j&&x(j)},children:"Save Preset"}),i.jsx("button",{onClick:()=>{x(vi),r(Au[vi])},children:"Reset"}),i.jsx("button",{title:"Clears local patches to recover from incompatible versions",onClick:()=>{localStorage.removeItem("websynth-patch"),location.reload()},children:"Clear Local"})]}),i.jsxs("div",{className:"preset-panel-meta",children:[i.jsx("div",{className:"label",children:"Presets & Patch IO"}),(g||w)&&i.jsxs("div",{className:"preset-description",children:[i.jsx("p",{children:g?g.description:w?.description}),g?.tags&&g.tags.length>0&&i.jsx("div",{className:"preset-tags",children:g.tags.map(M=>i.jsx("span",{className:"preset-tag",children:M},M))})]})]})]})}function kh(){const a=ne(h=>h.patch.expression)??I.expression,l=ne(h=>h.updatePatch),u=Q.useMemo(()=>{const h=new Map;for(const x of ki){const m=h.get(x.category)??[];m.push(x),h.set(x.category,m)}return Array.from(h.entries())},[]),d=h=>x=>{const m=x.target.value,v=h==="x"?{x:m,y:a.y}:{x:a.x,y:m};l({expression:v})},f=h=>{const x=a?.[h];return ki.find(v=>v.id===x)?.description??"Select a destination to be controlled by the XY surface."};return i.jsxs("div",{className:"expression-panel",children:[i.jsxs("div",{className:"expression-row",children:[i.jsxs("label",{children:[i.jsx("span",{className:"label",children:"X Axis Target"}),i.jsx("select",{value:a?.x??I.expression.x,onChange:d("x"),children:u.map(([h,x])=>i.jsx("optgroup",{label:h,children:x.map(m=>i.jsx("option",{value:m.id,children:m.label},m.id))},h))})]}),i.jsx("p",{className:"hint-text",children:f("x")})]}),i.jsxs("div",{className:"expression-row",children:[i.jsxs("label",{children:[i.jsx("span",{className:"label",children:"Y Axis Target"}),i.jsx("select",{value:a?.y??I.expression.y,onChange:d("y"),children:u.map(([h,x])=>i.jsx("optgroup",{label:h,children:x.map(m=>i.jsx("option",{value:m.id,children:m.label},m.id))},h))})]}),i.jsx("p",{className:"hint-text",children:f("y")})]})]})}function gi({open:r,onClose:a,children:l,title:u="Settings",closeLabel:d="Close settings"}){return Q.useEffect(()=>{if(!r)return;const f=h=>{h.key==="Escape"&&a()};return window.addEventListener("keydown",f),()=>window.removeEventListener("keydown",f)},[r,a]),r?i.jsxs("div",{className:"modal-overlay",role:"dialog","aria-modal":"true",children:[i.jsx("div",{className:"modal-backdrop",onClick:a}),i.jsxs("div",{className:"modal",children:[i.jsxs("header",{className:"modal-header",children:[i.jsx("h3",{className:"modal-title",children:u}),i.jsx("button",{className:"modal-close",onClick:a,"aria-label":d,children:"×"})]}),i.jsx("div",{className:"modal-body",children:l})]})]}):null}const Hu=16,vo=[{id:"kick",label:"Kick",midi:36,patch:{osc1:{wave:"sine",detune:-24},osc2:{wave:"sine",detune:0},mix:0,envelope:{attack:.001,decay:.18,sustain:0,release:.08},filter:{type:"lowpass",cutoff:380,q:.8},master:{gain:.35}}},{id:"snare",label:"Snare",midi:38,patch:{osc1:{wave:"noise",detune:0},osc2:{wave:"triangle",detune:12},mix:.55,envelope:{attack:.001,decay:.22,sustain:0,release:.12},filter:{type:"bandpass",cutoff:1800,q:2.8},master:{gain:.28}}},{id:"hat",label:"Hat",midi:42,patch:{osc1:{wave:"noise",detune:0},osc2:{wave:"triangle",detune:24},mix:.7,envelope:{attack:.001,decay:.08,sustain:0,release:.05},filter:{type:"highpass",cutoff:5e3,q:.9},master:{gain:.22}}}];function jh(){const r={};for(const a of vo)r[a.id]=Array.from({length:Hu},()=>!1);return r.kick[0]=!0,r.kick[8]=!0,r.snare[4]=!0,r.snare[12]=!0,r.hat=r.hat.map((a,l)=>l%2===0),r}function Mh(){const r=ne(y=>y.transport.tempo),a=ne(y=>y.transport.playing),l=ne(y=>y.transport.tick),u=ne(y=>y.setTempo),d=ne(y=>y.setTransportPlaying),[f,h]=Q.useState(()=>jh()),[x,m]=Q.useState(0),v=Q.useRef({}),g=Q.useRef(f);Q.useEffect(()=>{g.current=f},[f]);const w=async y=>{let j=v.current[y];j||(j=new xi,v.current[y]=j),await j.resume();const N=vo.find(_=>_.id===y)?.patch;return N&&j.applyPatch({...I,...N}),j},k=async y=>{const j=g.current,N=vo.filter(_=>j[_.id]?.[y]);for(const _ of N)(await w(_.id)).previewNote(_.midi,180)};Q.useEffect(()=>{if(!a){m(0);return}const y=l%Hu;m(y),k(y)},[l,a]),Q.useEffect(()=>()=>{for(const y of Object.values(v.current))try{y.audioContext.close()}catch{}v.current={}},[]);const M=(y,j)=>{h(N=>{const _={...N,[y]:[...N[y]]};return _[y][j]=!_[y][j],_})};return i.jsxs("div",{className:"drum-machine",children:[i.jsxs("div",{className:"drum-controls",children:[i.jsx("button",{className:"play-button",onClick:()=>d(!a),children:a?"Stop":"Play"}),i.jsx(Te,{label:"Tempo",min:60,max:180,step:1,value:r,onChange:y=>u(y)})]}),i.jsx("div",{className:"drum-grid",children:vo.map(y=>i.jsxs("div",{className:"drum-row",children:[i.jsx("div",{className:"drum-label",children:y.label}),i.jsx("div",{className:"drum-steps",children:f[y.id]?.map((j,N)=>{const _=a&&x===N;return i.jsx("button",{className:`drum-step${j?" active":""}${_?" current":""}`,onClick:()=>M(y.id,N)},N)})})]},y.id))})]})}const bh=4;function Eh(){const r=ne(f=>f.transport.tempo),a=ne(f=>f.transport.playing),l=ne(f=>f.bumpTransportTick),u=ne(f=>f.patch),d=ne(f=>f.updatePatch);return Q.useEffect(()=>{if(!a)return;const f=6e4/r/bh,h=window.setInterval(()=>l(),f);return()=>window.clearInterval(h)},[a,r,l]),Q.useEffect(()=>{const f=u.sequencer??I.sequencer;f?.enabled&&f.playing!==a&&d({sequencer:{...f,playing:a}})},[a,u.sequencer,d]),Q.useEffect(()=>{const f=u.sequencer??I.sequencer;f?.enabled&&f.bpm!==r&&d({sequencer:{...f,bpm:r}});const h=u.arp??I.arp;h?.enabled&&(h.bpm!==r||!h.bpmSync)&&d({arp:{...h,bpm:r,bpmSync:!0}})},[r,u.sequencer,u.arp,d]),null}const Fu=144,Ch=128;function Nh(r){return Array.from(r.inputs.values()).map(a=>({id:a.id,name:a.name??"Unknown input",manufacturer:a.manufacturer??null}))}let Yr=null;function Vu(){return Yr||(typeof navigator>"u"||typeof navigator.requestMIDIAccess!="function"?Promise.reject(new Error("Web MIDI API is not supported in this environment")):(Yr=navigator.requestMIDIAccess({sysex:!1}).finally(()=>{Yr=null}),Yr))}function Ph(){const r=ne(g=>g.engine),a=ne(g=>g.midi),l=ne(g=>g.setMidiSupported),u=ne(g=>g.setMidiStatus),d=ne(g=>g.setMidiInputs),f=ne(g=>g.setMidiSelectedInput),h=ne(g=>g.setMidiActiveNotes),x=Q.useRef(null),m=Q.useRef(null),v=Q.useRef(new Set);return Q.useEffect(()=>{if(!a.enabled){const w=Array.from(v.current);w.length&&r&&w.forEach(M=>r.noteOff(M)),v.current.clear(),h([]);const k=a.supported===!1?"unsupported":"idle";a.status!==k&&u(k),d([]),x.current&&(x.current.onstatechange=null);return}if(typeof navigator>"u"||typeof navigator.requestMIDIAccess!="function"){l(!1),u("unsupported");return}let g=!1;return l(!0),u("requesting"),Vu().then(w=>{if(g)return;x.current=w;const k=()=>{const M=Nh(w);d(M);const{selectedInputId:y}=ne.getState().midi;M.length===0&&(v.current.clear(),h([])),M.length>0?M.some(N=>N.id===y)||f(M[0]?.id??null):y&&f(null)};k(),w.onstatechange=()=>k(),u("ready")}).catch(w=>{if(g)return;const k=w instanceof Error?w.message:"Failed to access MIDI devices";u("error",k)}),()=>{g=!0,x.current&&(x.current.onstatechange=null),x.current=null}},[r,a.enabled,h,d,f,u,l]),Q.useEffect(()=>{if(!a.enabled){m.current&&(m.current.onmidimessage=null,m.current=null);return}const g=x.current;if(!g)return;const w=a.selectedInputId,k=w?Array.from(g.inputs.values()).find(y=>y.id===w):null;if(m.current&&m.current!==k){m.current.onmidimessage=null,m.current=null;const y=Array.from(v.current);y.length&&r&&y.forEach(j=>r.noteOff(j)),v.current.clear(),h([])}if(!k)return;const M=y=>{const j=y.data;if(!j||j.length<2)return;const N=j[0],_=j[1],R=j[2]??0,X=N&240,J=_;if(X===Fu&&R>0){const V=Math.max(0,Math.min(1,R/127));r&&r.noteOn(J,V),v.current.add(J),h(Array.from(v.current));return}(X===Ch||X===Fu&&R===0)&&(r&&r.noteOff(J),v.current.delete(J),h(Array.from(v.current)))};return k.onmidimessage=M,m.current=k,()=>{k.onmidimessage===M&&(k.onmidimessage=null);const y=Array.from(v.current);y.length&&r&&y.forEach(j=>r.noteOff(j)),v.current.clear(),h([])}},[r,a.enabled,a.selectedInputId,h]),null}const Th={idle:"Not connected",requesting:"Awaiting browser permission...",ready:"Connected",error:"Connection error",unsupported:"Not supported"};function _h(){const r=ne(m=>m.midi),a=ne(m=>m.setMidiEnabled),l=ne(m=>m.setMidiSelectedInput),u=ne(m=>m.setMidiStatus),d=ne(m=>m.setMidiSupported),f=Q.useMemo(()=>{const m=Th[r.status]??"Unknown";return r.status==="error"&&r.lastError?`${m}: ${r.lastError}`:r.status==="ready"&&r.inputs.length===0?"Connected - no inputs detected":m},[r.inputs.length,r.lastError,r.status]),h=r.supported===!1,x=Q.useCallback(m=>{if(!m.target.checked){a(!1);return}u("requesting"),a(!0),Vu().then(()=>{d(!0)}).catch(g=>{const w=g instanceof Error?g.message:"Failed to access MIDI devices";if(g instanceof Error&&/not supported/i.test(g.message)){d(!1),u("unsupported"),a(!1);return}d(!0),u("error",w)})},[a,u,d]);return i.jsxs("div",{className:"settings-card",children:[i.jsxs("div",{className:"settings-row",children:[i.jsx("label",{className:"settings-label",htmlFor:"midi-enabled",children:"Enable MIDI input"}),i.jsx("input",{id:"midi-enabled",type:"checkbox",checked:r.enabled,onChange:x,disabled:h})]}),i.jsxs("div",{className:"settings-row",children:[i.jsx("span",{className:"settings-label",children:"Status"}),i.jsx("span",{className:"settings-value","data-status":r.status,children:f})]}),r.status==="unsupported"?i.jsx("p",{className:"settings-help",children:"This browser does not expose the Web MIDI API. Try Chrome or Edge on desktop."}):null,i.jsxs("div",{className:"settings-row",children:[i.jsx("label",{className:"settings-label",htmlFor:"midi-input",children:"MIDI input device"}),i.jsxs("select",{id:"midi-input",value:r.selectedInputId??"",onChange:m=>{const v=m.target.value;l(v.length?v:null)},disabled:!r.enabled||r.inputs.length===0,children:[r.inputs.length===0?i.jsx("option",{value:"",children:"No inputs detected"}):null,r.inputs.map(m=>i.jsxs("option",{value:m.id,children:[m.name,m.manufacturer?` (${m.manufacturer})`:""]},m.id))]})]}),r.enabled&&r.inputs.length===0?i.jsx("p",{className:"settings-help",children:"Plug in a controller or check browser permissions."}):null]})}function Lh({href:r="https://github.com/szabadkai/synth-demo"}){return i.jsxs("a",{className:"github-corner",href:r,"aria-label":"View WebSynth Studio on GitHub",target:"_blank",rel:"noreferrer noopener",children:[i.jsx("span",{className:"sr-only",children:"View the project repository on GitHub"}),i.jsx("svg",{viewBox:"0 0 24 24","aria-hidden":"true",focusable:"false",children:i.jsx("path",{d:"M12 0a12 12 0 0 0-3.79 23.4c.6.11.82-.26.82-.58 0-.29-.01-1.05-.02-2.05-3.34.73-4.04-1.61-4.04-1.61-.55-1.4-1.35-1.78-1.35-1.78-1.11-.76.08-.75.08-.75 1.22.09 1.87 1.26 1.87 1.26 1.09 1.86 2.86 1.32 3.56 1 .11-.79.43-1.32.78-1.62-2.66-.3-5.47-1.33-5.47-5.9 0-1.3.47-2.37 1.24-3.21-.12-.3-.54-1.51.12-3.15 0 0 1-.32 3.3 1.23a11.5 11.5 0 0 1 6 0c2.3-1.55 3.3-1.23 3.3-1.23.66 1.64.24 2.85.12 3.15.77.84 1.24 1.9 1.24 3.21 0 4.58-2.82 5.6-5.5 5.9.44.39.83 1.16.83 2.34 0 1.69-.02 3.05-.02 3.47 0 .32.22.69.83.57A12 12 0 0 0 12 0Z"})})]})}const Oh=[{title:"Power On + Audio Check",points:["Click Power On (or press any key) to resume the audio engine – browsers block sound until you interact.","Hold a note on the on-screen keyboard or your computer keys (A/W/S…) to confirm audio output.","Watch the Audio Ready badge so you know the synth engine is live and responsive."]},{title:"Dashboard Basics",points:["Each panel can be dragged by the ⋮⋮ handle to personalise your layout.","Use the Oscilloscope panel to visualise how the engines, filter, and envelope tweaks shape the signal.","Dive into the Engine panel (ENG1/ENG2), plus Filter, Envelope, and Effects modules to sculpt tone, dynamics, and ambience."]},{title:"Modulation Playground",points:["Assign LFOs to pitch, filter, or effect targets for evolving textures – adjust rate, shape, sync, and depth.","Flip on the Arpeggiator to latch held notes, experiment with patterns, octave ranges, and tempo sync.","Program riffs in the Sequencer, toggle steps live, and shape groove with direction and swing."]},{title:"Rhythm Layer",points:["Open the Drum Machine to sequence kick, snare, and hat voices using the shared global transport.","Hit Play/Stop in the Drum Machine (or space bar in the Sequencer) to drive every tempo-aware module.","Adjust BPM from either panel – the Transport keeps LFO sync, sequencer rate, and arps locked in."]},{title:"Expressive Performance",points:["Engage CapsLock to activate the 2D expression surface; glide a trackpad, mouse, or pen for live modulation.","Check the overlay label to see which parameters the X/Y axes control and their real-time values.","Customise X/Y destinations under Settings → Expression to map filter sweeps, macro blends, and more."]},{title:"Patch Workflow",points:["Browse the top-bar Preset menu or Settings → Patches to explore curated starting points.","Export your patch as JSON to share, import saved patches, or reset to the init patch at any time.","Use Clear Local if you ever need to wipe cached patches after upgrading the app."]},{title:"Hardware MIDI",points:["Toggle Enable MIDI input in Settings → MIDI to request browser permission for your controller.","Select a detected device and play – incoming notes route straight into the synth voice engine.","Status hints show permission prompts, errors, or a friendly ready state so you know what to expect."]},{title:"Next Steps",points:["Layer Sequencer, Arpeggiator, Drum Machine, and expression surface for full arrangements.","Save favourite patches into src/patches/ to share with your team or future sessions.","Before shipping changes, run npm run lint, npm run typecheck, npm test, and npm run build to keep QA tight."]}];function Rh({onFinish:r}){return i.jsxs("div",{className:"onboarding-guide",children:[i.jsx("p",{className:"onboarding-intro",children:"New to WebSynth Studio? Work through the highlights below, tweaking the live app as you go. Each section points you to the panels and controls that define the instrument."}),i.jsx("ol",{className:"onboarding-list",children:Oh.map(a=>i.jsxs("li",{className:"onboarding-section",children:[i.jsx("h4",{children:a.title}),i.jsx("ul",{children:a.points.map(l=>i.jsx("li",{children:l},l))})]},a.title))}),i.jsx("button",{type:"button",className:"onboarding-cta",onClick:()=>{r?.()},children:"Let's go"})]})}const Ih="https://buymeacoffee.com/szabadkai",Ah="https://cdn.buymeacoffee.com/buttons/v2/default-yellow.png",yi="buy-coffee-collapsed";function Fh(){const[r,a]=Q.useState(!1);return Q.useEffect(()=>{try{window.localStorage.getItem(yi)==="1"&&a(!0)}catch{}},[]),Q.useEffect(()=>{try{r?window.localStorage.setItem(yi,"1"):window.localStorage.removeItem(yi)}catch{}},[r]),r?i.jsx("div",{className:"buy-coffee collapsed",children:i.jsx("button",{type:"button",className:"buy-coffee-icon","aria-label":"Show Buy Me a Coffee support button",onClick:()=>a(!1),children:i.jsx("span",{"aria-hidden":"true",children:"☕"})})}):i.jsxs("div",{className:"buy-coffee",children:[i.jsxs("a",{className:"buy-coffee-link",href:Ih,target:"_blank",rel:"noreferrer noopener","aria-label":"Support WebSynth Studio via Buy Me a Coffee",children:[i.jsx("span",{className:"sr-only",children:"Support WebSynth Studio on Buy Me a Coffee"}),i.jsx("img",{src:Ah,alt:"",loading:"lazy",width:220,height:62})]}),i.jsx("button",{type:"button",className:"buy-coffee-dismiss","aria-label":"Hide Buy Me a Coffee support button",onClick:()=>a(!0),children:i.jsx("span",{"aria-hidden":"true",children:"×"})})]})}const zh=[{label:"1024",value:1024,description:"Fastest response, lowest resolution"},{label:"2048",value:2048,description:"Balanced speed and detail"},{label:"4096",value:4096,description:"Default detail"},{label:"8192",value:8192,description:"Highest resolution, slowest refresh"}];function Dh(){const r=ne(l=>l.oscilloscope.fftSize),a=ne(l=>l.setOscilloscopeFftSize);return i.jsxs("div",{className:"settings-group",children:[i.jsx("h5",{className:"settings-subheading",children:"Oscilloscope"}),i.jsxs("div",{className:"settings-row",children:[i.jsx("span",{className:"label",children:"FFT Size"}),i.jsx("div",{className:"fft-options",children:zh.map(l=>{const u=r===l.value;return i.jsxs("button",{type:"button",className:`fft-option${u?" active":""}`,"aria-pressed":u,onClick:()=>a(l.value),children:[i.jsx("span",{className:"fft-option__label",children:l.label}),i.jsx("span",{className:"fft-option__hint",children:l.description})]},l.value)})})]})]})}function qh(){const r=ne(y=>y.updatePatch),a=ne(y=>y.userPresets),[l,u]=qe.useState(null),[d,f]=qe.useState(!1),h=qe.useRef(null),x=qe.useRef(null),m=l?mo[l]:null,v=l?a.find(y=>y.id===l):void 0,g=m?{id:m.id,name:m.name,description:m.description,image:m.image}:v?{id:v.id,name:v.name,description:v.description,image:void 0}:null,w=qe.useCallback(()=>{f(!1),h.current?.blur()},[]),k=qe.useCallback(y=>{u(y),w();const j=mo[y];if(j){r(j.patch);return}const N=a.find(_=>_.id===y);if(N){const _=typeof structuredClone=="function"?structuredClone(N.patch):JSON.parse(JSON.stringify(N.patch));r(_)}},[w,r,a]);qe.useEffect(()=>{if(!d)return;const y=N=>{!h.current?.contains(N.target)&&!x.current?.contains(N.target)&&w()},j=N=>{N.key==="Escape"&&(N.preventDefault(),w())};return document.addEventListener("pointerdown",y),document.addEventListener("keydown",j),()=>{document.removeEventListener("pointerdown",y),document.removeEventListener("keydown",j)}},[d,w]);const M=()=>{f(y=>!y),d&&w()};return qe.useEffect(()=>{l&&(mo[l]||a.some(y=>y.id===l)||u(null))},[l,a]),i.jsxs("div",{className:"preset-selector","data-open":d?"true":"false",children:[i.jsxs("button",{type:"button",ref:h,className:"preset-selector-trigger",onClick:M,"aria-haspopup":"listbox","aria-expanded":d,children:[g?i.jsxs("span",{className:"preset-selector-label",children:[i.jsx("span",{className:"preset-selector-thumb",style:g.image?{backgroundImage:`url(${g.image})`}:void 0}),i.jsx("span",{children:g.name})]}):i.jsx("span",{className:"preset-selector-placeholder",children:"Presets"}),i.jsx("span",{className:"preset-selector-caret","aria-hidden":"true",children:"▾"})]}),d&&i.jsxs("div",{className:"preset-selector-popover",ref:x,role:"listbox","aria-label":"Preset library",children:[ji.map(y=>i.jsxs("div",{className:"preset-selector-group",children:[i.jsx("div",{className:"preset-selector-group-title",children:y.name}),i.jsx("div",{className:"preset-selector-options",children:y.presets.map(j=>i.jsx("button",{type:"button",role:"option","aria-selected":j.id===l,className:"preset-option",style:{backgroundImage:`url(${j.image})`},onClick:()=>k(j.id),children:i.jsxs("div",{className:"preset-option-overlay",children:[i.jsx("div",{className:"preset-option-name",children:j.name}),i.jsx("div",{className:"preset-option-description",children:j.description})]})},j.id))})]},y.id)),a.length>0&&i.jsxs("div",{className:"preset-selector-group",children:[i.jsx("div",{className:"preset-selector-group-title",children:"Custom Presets"}),i.jsx("div",{className:"preset-selector-options",children:a.map(y=>i.jsx("button",{type:"button",role:"option","aria-selected":y.id===l,className:"preset-option",onClick:()=>k(y.id),children:i.jsxs("div",{className:"preset-option-overlay",children:[i.jsx("div",{className:"preset-option-name",children:y.name}),i.jsx("div",{className:"preset-option-description",children:y.description})]})},y.id))})]})]})]})}const Bh=[{value:"lfo1",label:"LFO 1 (Audio)"},{value:"lfo2",label:"LFO 2 (Audio)"},{value:"exprX",label:"Expression X (CapsLock X)"},{value:"exprY",label:"Expression Y (CapsLock Y)"},{value:"seqStep",label:"Sequencer Step"},{value:"velocity",label:"Note Velocity"},{value:"gate",label:"Note Gate"}],zu=[{value:"filter.cutoff",label:"Filter Cutoff",description:"Modulate the primary filter frequency"},{value:"filter.q",label:"Filter Resonance",description:"Modulate filter resonance (Q)"},{value:"master.gain",label:"Master Gain",description:"Trim the overall output level"},{value:"macro.harmonics",label:"Macro Harmonics",description:"Shape the macro engine harmonic content"},{value:"macro.timbre",label:"Macro Timbre",description:"Tilt the macro tone or brightness"},{value:"macro.morph",label:"Macro Morph",description:"Sweep the macro engine model position"},{value:"macro.level",label:"Macro Level",description:"Adjust macro oscillator output level"},{value:"fm.amount",label:"FM Amount",description:"Scale frequency modulation depth"},{value:"mix",label:"Osc Mix",description:"Crossfade between oscillator 1 and 2"},{value:"envelope.attack",label:"Env Attack",description:"Modulate the envelope attack time"},{value:"envelope.release",label:"Env Release",description:"Modulate the envelope release time"}],Uh=r=>`${r>=0?"+":""}${(r*100).toFixed(0)}%`;function Hh(){const r=ne(m=>m.patch.modMatrix??[]),a=ne(m=>m.addModRoute),l=ne(m=>m.updateModRoute),u=ne(m=>m.removeModRoute),d=(m,v)=>{l(m.id,{source:v})},f=(m,v)=>{l(m.id,{target:v})},h=(m,v)=>{l(m.id,{amount:v})},x=(m,v)=>{l(m.id,{enabled:v})};return i.jsxs("div",{className:"mod-matrix-panel",children:[i.jsxs("div",{className:"mod-matrix-header",children:[i.jsx("button",{type:"button",onClick:a,className:"mod-matrix-add",children:"+ Add Route"}),i.jsxs("span",{className:"mod-matrix-count",children:[r.length," routings"]})]}),r.length===0?i.jsx("p",{className:"hint-text",style:{marginTop:8},children:"Add routes to patch LFOs into filter or master parameters. More sources will arrive in future revisions."}):i.jsx("div",{className:"mod-matrix-list",children:r.map(m=>i.jsxs("div",{className:`mod-matrix-row${m.enabled?"":" disabled"}`,children:[i.jsx("div",{className:"mod-matrix-col",children:i.jsxs("label",{children:[i.jsx("div",{className:"label",children:"Source"}),i.jsx("select",{value:m.source,onChange:v=>d(m,v.target.value),children:Bh.map(v=>i.jsx("option",{value:v.value,children:v.label},v.value))})]})}),i.jsxs("div",{className:"mod-matrix-col",children:[i.jsxs("label",{children:[i.jsx("div",{className:"label",children:"Target"}),i.jsx("select",{value:m.target,onChange:v=>f(m,v.target.value),children:zu.map(v=>i.jsx("option",{value:v.value,children:v.label},v.value))})]}),i.jsx("span",{className:"mod-matrix-hint",children:zu.find(v=>v.value===m.target)?.description??""})]}),i.jsxs("div",{className:"mod-matrix-col amount",children:[i.jsxs("label",{children:[i.jsx("div",{className:"label",children:"Amount"}),i.jsx("input",{type:"range",min:-1,max:1,step:.01,value:m.amount,onChange:v=>h(m,Number(v.target.value))})]}),i.jsx("div",{className:"mod-matrix-amount",children:Uh(m.amount)})]}),i.jsxs("div",{className:"mod-matrix-actions",children:[i.jsxs("label",{className:"mod-matrix-toggle",children:[i.jsx("input",{type:"checkbox",checked:m.enabled,onChange:v=>x(m,v.target.checked)}),i.jsx("span",{children:"Enabled"})]}),i.jsx("button",{type:"button",className:"mod-matrix-remove",onClick:()=>u(m.id),"aria-label":"Remove route",children:"✕"})]})]},m.id))})]})}const Du="websynth-guide-seen",Vh=["oscilloscope","oscillator","effects","lfos","arp","sequencer","modmatrix","drum","keyboard"];function Wh(r){return Vh.includes(r)}function $h(){const r=ne(_=>_.engine),a=ne(_=>_.setEngine),l=ne(_=>_.patch),[u,d]=Q.useState(!1),[f,h]=Q.useState(!1),[x,m]=Q.useState(null);Q.useEffect(()=>{try{localStorage.getItem(Du)||h(!0)}catch{}},[]),Q.useEffect(()=>{const _=async()=>{if(!ne.getState().engine){const R=new xi;await R.resume(),R.applyPatch(l),a(R)}window.removeEventListener("pointerdown",_),window.removeEventListener("keydown",_)};return window.addEventListener("pointerdown",_),window.addEventListener("keydown",_),()=>{window.removeEventListener("pointerdown",_),window.removeEventListener("keydown",_)}},[l,a]);const v=async()=>{if(!r){const _=new xi;await _.resume(),_.applyPatch(l),a(_)}},g=[{id:"oscilloscope",title:"Oscilloscope",span:2,render:()=>i.jsxs("div",{className:"oscilloscope-stack",children:[i.jsx(oh,{}),i.jsxs("div",{className:"oscilloscope-row",children:[i.jsx(Jp,{}),i.jsx(Zp,{})]})]})},{id:"oscillator",title:"Oscillator",span:2,render:()=>i.jsx(Yp,{})},{id:"effects",title:"Effects",span:2,render:()=>i.jsx(lh,{})},{id:"lfos",title:"LFOs",span:2,render:()=>i.jsx(ih,{})},{id:"modmatrix",title:"Mod Matrix",span:2,render:()=>i.jsx(Hh,{})},{id:"arp",title:"Arpeggiator",span:2,render:()=>i.jsx(ah,{})},{id:"sequencer",title:"Sequencer",span:2,render:()=>i.jsx(ch,{})},{id:"drum",title:"Drum Machine",span:2,render:()=>i.jsx(Mh,{})},{id:"keyboard",title:"Keyboard",span:2,render:()=>i.jsx(sh,{})}],w=ne(_=>_.layoutOrder),k=ne(_=>_.setLayoutOrder),M=ne(_=>_.resetPatch),y=Q.useMemo(()=>({oscilloscope:{title:"Oscilloscope & Signal Shaping",body:i.jsxs("div",{className:"module-help",children:[i.jsx("p",{children:"This column stacks the live scope with the filter and envelope controls so you can see and hear how each tweak reshapes the voice in real time."}),i.jsx("h5",{children:"Oscilloscope"}),i.jsxs("ul",{children:[i.jsxs("li",{children:[i.jsx("strong",{children:"Live waveform"})," shows the post-filter signal—watch for clipping, phase inversion, or DC offset."]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Visual feedback"})," makes it easy to dial envelope curves or modulation depth by eye."]})]}),i.jsx("h5",{children:"Filter"}),i.jsxs("ul",{children:[i.jsxs("li",{children:[i.jsx("strong",{children:"Filter Type"}),": switch between low-pass, high-pass, band-pass, or notch responses."]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Cutoff"}),": set the corner frequency (40–8 kHz)."]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Resonance"}),": emphasise frequencies around the cutoff for squelchy tones or formants."]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Master"}),": trim the synth output to prevent overload after heavy resonance or drive."]})]}),i.jsx("h5",{children:"Envelope"}),i.jsxs("ul",{children:[i.jsxs("li",{children:[i.jsx("strong",{children:"Attack/Decay"}),": tune how quickly the note ramps up and falls back."]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Sustain"}),": set the plateau level while a key is held."]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Release"}),": control how long the tail rings once the note stops."]})]}),i.jsx("h5",{children:"Workflow Tips"}),i.jsxs("ul",{children:[i.jsx("li",{children:"Start with moderate sustain and adjust cutoff until the oscilloscope shows a balanced waveform."}),i.jsx("li",{children:"Use short attacks with high resonance for plucky stabs, or longer releases for pads."})]})]})},oscillator:{title:"ENG Voice Engine",body:i.jsxs("div",{className:"module-help",children:[i.jsx("p",{children:"The engine panel builds the raw tone. Switch between the classic dual-engine stack (ENG1/ENG2) and the macro voice engine."}),i.jsx("h5",{children:"Classic Mode"}),i.jsxs("ul",{children:[i.jsxs("li",{children:[i.jsx("strong",{children:"Mode"}),": choose Classic to expose ENG1 and ENG2 controls; Macro flips to the multi-model engine."]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Wave"}),": pick saw, square, triangle, sine, or noise per engine."]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Detune/Fine"}),": detune ENG1 in cents for chorus movement; fine tune provides subtle offsets."]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Mix"}),": blend ENG1 against ENG2 to balance the tone."]}),i.jsxs("li",{children:[i.jsx("strong",{children:"FM toggle"}),": enable frequency modulation, then set ",i.jsx("strong",{children:"Ratio"})," for the modulator harmonic and ",i.jsx("strong",{children:"Amount"})," for depth."]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Ring toggle"}),": engage ring modulation and scale its ",i.jsx("strong",{children:"Amount"})," for metallic textures."]})]}),i.jsx("h5",{children:"Macro Mode"}),i.jsxs("ul",{children:[i.jsxs("li",{children:[i.jsx("strong",{children:"Model"}),": jump between macro-oscillator flavours (VA, wavefold, pluck, FM 2-Op, etc.)."]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Harmonics/Timbre/Morph"}),": scan each model’s parameter set—great for morphing wavetables or shaping plucks."]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Level"}),": trim the macro engine output when layering with other voices."]})]}),i.jsx("h5",{children:"Sound Design Tips"}),i.jsxs("ul",{children:[i.jsx("li",{children:"Stack slight detune plus a touch of ring modulation for wide analog pads."}),i.jsx("li",{children:"Macro models respond well to LFO or expression assignments—map CapsLock X/Y to Morph or Timbre for live movement."})]})]})},effects:{title:"Effects Rack",body:i.jsxs("div",{className:"module-help",children:[i.jsx("p",{children:"Delay and reverb live here so you can finish a patch without leaving the synth view."}),i.jsx("h5",{children:"Delay"}),i.jsxs("ul",{children:[i.jsxs("li",{children:[i.jsx("strong",{children:"Enabled"}),": toggle the bucket-brigade style delay."]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Time"}),": set delay time in seconds (0–1.5s). Syncs nicely with tempo divisions."]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Feedback"}),": control repeats; keep under ~0.7 for stable feedback."]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Mix"}),": blend the wet signal back with the dry synth."]})]}),i.jsx("h5",{children:"Reverb"}),i.jsxs("ul",{children:[i.jsxs("li",{children:[i.jsx("strong",{children:"Enabled"}),": load the convolution reverb stage."]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Size"}),": pick the impulse “room” length."]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Decay"}),": shape how long the tail sustains."]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Mix"}),": balance ambience without washing out the dry signal."]})]}),i.jsx("h5",{children:"Tips"}),i.jsxs("ul",{children:[i.jsx("li",{children:"Short delay times with low mix create slapback for bass and plucks."}),i.jsx("li",{children:"Cut delay feedback when engaging heavy reverb to avoid muddiness."})]})]})},lfos:{title:"LFO Modulators",body:i.jsxs("div",{className:"module-help",children:[i.jsx("p",{children:"Two low-frequency oscillators inject motion into almost any destination in the patch."}),i.jsx("h5",{children:"LFO Controls"}),i.jsxs("ul",{children:[i.jsxs("li",{children:[i.jsx("strong",{children:"Enabled"}),": arm the modulation path for each LFO."]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Wave"}),": choose sine, triangle, square, saw, or noise for the modulation shape."]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Dest"}),": route to pitch, filter, or amp—tie depth to macros or expression for more routings."]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Rate"}),": set frequency in Hz (0.01–20); syncs with tempo when combined with the transport."]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Amount"}),": scale modulation depth; automate this with the Sequencer or expression surface for evolving sounds."]})]}),i.jsx("h5",{children:"Tips"}),i.jsxs("ul",{children:[i.jsx("li",{children:"Use LFO1 for slow filter sweeps and LFO2 for faster vibrato or tremolo."}),i.jsx("li",{children:"Disable the checkbox to park an LFO without losing its configuration."})]})]})},modmatrix:{title:"Mod Matrix",body:i.jsxs("div",{className:"module-help",children:[i.jsx("p",{children:"Layer additional motion by routing the LFOs into filter or master parameters."}),i.jsx("h5",{children:"Routing"}),i.jsxs("ul",{children:[i.jsxs("li",{children:[i.jsx("strong",{children:"Source"}),": pick which LFO feeds the route—depth follows that LFO’s shape."]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Target"}),": choose filter cutoff, resonance, or master gain as the modulation destination."]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Amount"}),": dial positive values to boost, negative to invert; the percentage shows the exact depth."]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Enabled"}),": toggle a route on/off without deleting it."]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Sequencer Step"}),": the Sequencer source mirrors the current step velocity for rhythmic modulation."]})]}),i.jsx("h5",{children:"Tips"}),i.jsxs("ul",{children:[i.jsx("li",{children:"Stack multiple routes per LFO to move cutoff and resonance together."}),i.jsx("li",{children:"Use opposing amounts to push resonance down while cutoff rises for smooth sweeps."})]})]})},arp:{title:"Arpeggiator",body:i.jsxs("div",{className:"module-help",children:[i.jsx("p",{children:"Turn held chords into rhythmic runs that follow the global transport."}),i.jsx("h5",{children:"Playback"}),i.jsxs("ul",{children:[i.jsxs("li",{children:[i.jsx("strong",{children:"Enabled"}),": start capturing held notes."]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Latch"}),": keep notes running after you release the keys."]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Clear"}),": flush the current latched chord without toggling the arp off."]})]}),i.jsx("h5",{children:"Timing"}),i.jsxs("ul",{children:[i.jsxs("li",{children:[i.jsx("strong",{children:"Mode"}),": set traversal (up, down, up/down, random, as played)."]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Octaves"}),": extend the pattern across 1–4 octaves."]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Chord"}),": fold power chords, triads, or sevenths into each step."]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Division"}),": choose rhythmic value (1/4–1/16T)."]}),i.jsxs("li",{children:[i.jsx("strong",{children:"BPM"}),": the slider writes to the global tempo so drums and sequencer stay in sync."]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Gate/Swing"}),": tighten note length and groove feel."]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Repeats/Length"}),": loop steps multiple times or clamp the pattern length."]})]}),i.jsx("h5",{children:"Tips"}),i.jsxs("ul",{children:[i.jsx("li",{children:"Combine Latch with the Sequencer for counterpoint—that way the arp handles chords while the sequencer drives lead lines."}),i.jsx("li",{children:"Use the expression surface to modulate filter cutoff while the arp runs for dynamic sweeps."})]})]})},sequencer:{title:"Step Sequencer",body:i.jsxs("div",{className:"module-help",children:[i.jsx("p",{children:"Program note offsets and modulation lanes across up to 16 steps—perfect for basslines or evolving textures."}),i.jsx("h5",{children:"Transport & Timing"}),i.jsxs("ul",{children:[i.jsxs("li",{children:[i.jsx("strong",{children:"Play"}),": toggles the shared transport; the button mirrors the space-bar shortcut."]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Enabled"}),": arm the sequencer without nuking your pattern."]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Tempo"}),": linked to the global BPM so drums and arp line up."]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Division"}),": set step rate (quarter to triplet sixteenths)."]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Length"}),": choose how many steps play before looping."]})]}),i.jsx("h5",{children:"Shape the Pattern"}),i.jsxs("ul",{children:[i.jsxs("li",{children:[i.jsx("strong",{children:"Gate"}),": change note length; great for staccato acid lines."]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Swing"}),": add shuffle (disabled for triplets and quarter notes)."]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Root"}),": slide the entire sequence up or down in pitch."]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Edit Notes (Keyboard)"}),": enable to type notes with A/W/S…; +/- nudges semitones, Z/X shifts the root octave."]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Step grid"}),": click to toggle notes, ",i.jsx("strong",{children:"Alt+click"})," raises semitone offset, right-click lowers it."]})]}),i.jsx("h5",{children:"Visual Feedback"}),i.jsxs("ul",{children:[i.jsx("li",{children:"The highlighted cell shows the playhead; cursor outlines follow keyboard edit focus."}),i.jsx("li",{children:"Offsets in the cells (+/- values) represent semitone shifts relative to Root."})]})]})},drum:{title:"Drum Machine",body:i.jsxs("div",{className:"module-help",children:[i.jsx("p",{children:"Create percussive backbeats that share tempo and transport with the synth voice."}),i.jsx("h5",{children:"Transport"}),i.jsxs("ul",{children:[i.jsxs("li",{children:[i.jsx("strong",{children:"Play/Stop"}),": drives the global clock, so sequencer and arp follow the same BPM."]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Tempo"}),": change BPM with the slider—applies everywhere."]})]}),i.jsx("h5",{children:"Programming"}),i.jsxs("ul",{children:[i.jsxs("li",{children:[i.jsx("strong",{children:"Step buttons"}),": click to toggle hits for kick, snare, and hat; glowing steps are active."]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Current step highlight"}),": a brighter cell shows the beat currently firing."]}),i.jsx("li",{children:"Each instrument has its own SynthEngine voice with curated patches for punchy drums."})]}),i.jsx("h5",{children:"Tips"}),i.jsxs("ul",{children:[i.jsx("li",{children:"Start with the default 4-on-the-floor kick and build snare/hat syncopation around it."}),i.jsx("li",{children:"Layer sequencer basslines with hats on offbeats for instant groove."})]})]})},keyboard:{title:"Keyboard & Performance",body:i.jsxs("div",{className:"module-help",children:[i.jsx("p",{children:"Play and monitor incoming notes from both the computer keyboard and external MIDI controllers."}),i.jsx("h5",{children:"Computer Keys"}),i.jsxs("ul",{children:[i.jsxs("li",{children:[i.jsx("strong",{children:"Mapping"}),": A/W/S/D/F/G… map to white and black keys; apostrophe reaches two octaves up."]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Z / X"}),": shift the octave indicator down or up in 12-semitone jumps."]}),i.jsx("li",{children:"Held keys appear highlighted so you always know what is sustaining."})]}),i.jsx("h5",{children:"Pointer & Touch"}),i.jsxs("ul",{children:[i.jsx("li",{children:"Click or drag for glissando; multi-touch (trackpad/tablet) keeps parallel notes held."}),i.jsx("li",{children:"Black keys float above the whites for accurate gliss transitions."})]}),i.jsx("h5",{children:"MIDI Integration"}),i.jsxs("ul",{children:[i.jsx("li",{children:"Notes triggered from external hardware light up alongside local keys—great for debugging MIDI routing."}),i.jsx("li",{children:"The octave badge shows the base MIDI note and offset so you can align hardware controllers quickly."})]})]})}}),[]),j=x?y[x]:null,N=()=>{try{localStorage.setItem(Du,"1")}catch{}h(!1)};return i.jsxs("div",{className:"app",children:[i.jsx(Lh,{}),i.jsx(Fh,{}),i.jsx(Ph,{}),i.jsxs("header",{className:"header",children:[i.jsx("h2",{children:"WebSynth Studio"}),i.jsxs("div",{className:"row",children:[i.jsx(qh,{}),i.jsx("button",{onClick:v,children:r?"Audio Ready":"Power On"}),i.jsx("button",{onClick:()=>{M()},children:"Reset Patch"}),i.jsx("button",{onClick:()=>{h(!0)},children:"Help"}),i.jsx("button",{onClick:()=>d(!0),children:"Settings"})]})]}),i.jsx("main",{children:i.jsx(dh,{panels:g,order:w,onOrderChange:k,onRequestHelp:_=>{Wh(_)&&m(_)}})}),i.jsx(uh,{}),i.jsx(gi,{open:x!=null,onClose:()=>m(null),title:j?.title??"Module Help",closeLabel:"Close module help",children:j?.body??i.jsx("p",{children:"Help content coming soon."})}),i.jsx(gi,{open:f,onClose:N,title:"Onboarding Guide",closeLabel:"Close help overlay",children:i.jsx(Rh,{onFinish:N})}),i.jsxs(gi,{open:u,onClose:()=>d(!1),children:[i.jsxs("section",{className:"settings-section",children:[i.jsx("h4",{className:"settings-heading",children:"Patches"}),i.jsx(Sh,{})]}),i.jsxs("section",{className:"settings-section",children:[i.jsx("h4",{className:"settings-heading",children:"Expression"}),i.jsx(kh,{})]}),i.jsxs("section",{className:"settings-section",children:[i.jsx("h4",{className:"settings-heading",children:"Visualization"}),i.jsx(Dh,{})]}),i.jsxs("section",{className:"settings-section",children:[i.jsx("h4",{className:"settings-heading",children:"MIDI"}),i.jsx(_h,{})]})]}),i.jsx(Eh,{})]})}const Gh=Xf.createRoot(document.getElementById("root"));Gh.render(i.jsx($h,{}));
